Using TensorFlow backend
Epoch 1/1000
137/137 - 6s - loss: 2.7473 - NDCG@10: 0.5432 - r1: 0.3371 - r5: 0.6500 - r10: 0.7760 - p5: 0.1300 - p10: 0.0776 - f1: 0.1442 - val_loss: 1.9178 - val_NDCG@10: 0.7286 - val_r1: 0.5723 - val_r5: 0.8149 - val_r10: 0.8862 - val_p5: 0.1630 - val_p10: 0.0886 - val_f1: 0.1940 - lr: 9.9901e-05 - e_time: 5.2826 - 6s/epoch - 41ms/step
Epoch 2/1000
137/137 - 2s - loss: 1.8000 - NDCG@10: 0.7233 - r1: 0.5515 - r5: 0.8219 - r10: 0.8974 - p5: 0.1644 - p10: 0.0897 - f1: 0.1821 - val_loss: 1.3624 - val_NDCG@10: 0.8148 - val_r1: 0.6855 - val_r5: 0.8921 - val_r10: 0.9408 - val_p5: 0.1784 - val_p10: 0.0941 - val_f1: 0.2120 - lr: 9.9802e-05 - e_time: 1.6113 - 2s/epoch - 13ms/step
Epoch 3/1000
137/137 - 2s - loss: 1.5124 - NDCG@10: 0.7724 - r1: 0.6144 - r5: 0.8662 - r10: 0.9287 - p5: 0.1732 - p10: 0.0929 - f1: 0.2130 - val_loss: 1.1710 - val_NDCG@10: 0.8426 - val_r1: 0.7209 - val_r5: 0.9147 - val_r10: 0.9581 - val_p5: 0.1829 - val_p10: 0.0958 - val_f1: 0.2927 - lr: 9.9703e-05 - e_time: 1.6138 - 2s/epoch - 13ms/step
Epoch 4/1000
137/137 - 2s - loss: 1.3521 - NDCG@10: 0.7980 - r1: 0.6490 - r5: 0.8891 - r10: 0.9423 - p5: 0.1778 - p10: 0.0942 - f1: 0.2683 - val_loss: 1.0556 - val_NDCG@10: 0.8591 - val_r1: 0.7427 - val_r5: 0.9294 - val_r10: 0.9670 - val_p5: 0.1859 - val_p10: 0.0967 - val_f1: 0.3916 - lr: 9.9604e-05 - e_time: 1.6060 - 2s/epoch - 13ms/step
Epoch 5/1000
137/137 - 2s - loss: 1.2513 - NDCG@10: 0.8151 - r1: 0.6712 - r5: 0.9026 - r10: 0.9524 - p5: 0.1805 - p10: 0.0952 - f1: 0.3351 - val_loss: 0.9782 - val_NDCG@10: 0.8666 - val_r1: 0.7510 - val_r5: 0.9382 - val_r10: 0.9718 - val_p5: 0.1876 - val_p10: 0.0972 - val_f1: 0.4430 - lr: 9.9505e-05 - e_time: 1.6070 - 2s/epoch - 13ms/step
Epoch 6/1000
137/137 - 2s - loss: 1.1873 - NDCG@10: 0.8250 - r1: 0.6844 - r5: 0.9125 - r10: 0.9572 - p5: 0.1825 - p10: 0.0957 - f1: 0.3632 - val_loss: 0.9325 - val_NDCG@10: 0.8732 - val_r1: 0.7600 - val_r5: 0.9443 - val_r10: 0.9748 - val_p5: 0.1889 - val_p10: 0.0975 - val_f1: 0.4748 - lr: 9.9406e-05 - e_time: 1.6216 - 2s/epoch - 13ms/step
Epoch 7/1000
137/137 - 2s - loss: 1.1340 - NDCG@10: 0.8332 - r1: 0.6953 - r5: 0.9189 - r10: 0.9613 - p5: 0.1838 - p10: 0.0961 - f1: 0.3829 - val_loss: 0.9010 - val_NDCG@10: 0.8774 - val_r1: 0.7659 - val_r5: 0.9481 - val_r10: 0.9772 - val_p5: 0.1896 - val_p10: 0.0977 - val_f1: 0.4959 - lr: 9.9307e-05 - e_time: 1.6218 - 2s/epoch - 14ms/step
Epoch 8/1000
137/137 - 2s - loss: 1.1050 - NDCG@10: 0.8381 - r1: 0.7011 - r5: 0.9236 - r10: 0.9644 - p5: 0.1847 - p10: 0.0964 - f1: 0.4055 - val_loss: 0.8736 - val_NDCG@10: 0.8803 - val_r1: 0.7689 - val_r5: 0.9497 - val_r10: 0.9784 - val_p5: 0.1899 - val_p10: 0.0978 - val_f1: 0.5097 - lr: 9.9208e-05 - e_time: 1.5863 - 2s/epoch - 13ms/step
Epoch 9/1000
137/137 - 2s - loss: 1.0699 - NDCG@10: 0.8432 - r1: 0.7084 - r5: 0.9284 - r10: 0.9670 - p5: 0.1857 - p10: 0.0967 - f1: 0.4074 - val_loss: 0.8647 - val_NDCG@10: 0.8805 - val_r1: 0.7717 - val_r5: 0.9499 - val_r10: 0.9774 - val_p5: 0.1900 - val_p10: 0.0977 - val_f1: 0.4991 - lr: 9.9109e-05 - e_time: 1.6211 - 2s/epoch - 13ms/step
Epoch 10/1000
137/137 - 2s - loss: 1.0486 - NDCG@10: 0.8471 - r1: 0.7149 - r5: 0.9310 - r10: 0.9681 - p5: 0.1862 - p10: 0.0968 - f1: 0.4181 - val_loss: 0.8507 - val_NDCG@10: 0.8831 - val_r1: 0.7741 - val_r5: 0.9507 - val_r10: 0.9795 - val_p5: 0.1901 - val_p10: 0.0980 - val_f1: 0.5344 - lr: 9.9010e-05 - e_time: 1.6209 - 2s/epoch - 13ms/step
Epoch 11/1000
137/137 - 2s - loss: 1.0292 - NDCG@10: 0.8497 - r1: 0.7187 - r5: 0.9328 - r10: 0.9693 - p5: 0.1866 - p10: 0.0969 - f1: 0.4366 - val_loss: 0.8373 - val_NDCG@10: 0.8853 - val_r1: 0.7789 - val_r5: 0.9522 - val_r10: 0.9791 - val_p5: 0.1904 - val_p10: 0.0979 - val_f1: 0.5373 - lr: 9.8911e-05 - e_time: 1.6214 - 2s/epoch - 14ms/step
Epoch 12/1000
137/137 - 2s - loss: 1.0175 - NDCG@10: 0.8505 - r1: 0.7191 - r5: 0.9334 - r10: 0.9705 - p5: 0.1867 - p10: 0.0971 - f1: 0.4217 - val_loss: 0.8276 - val_NDCG@10: 0.8862 - val_r1: 0.7804 - val_r5: 0.9517 - val_r10: 0.9794 - val_p5: 0.1903 - val_p10: 0.0979 - val_f1: 0.5471 - lr: 9.8812e-05 - e_time: 1.5935 - 2s/epoch - 13ms/step
Epoch 13/1000
137/137 - 2s - loss: 1.0060 - NDCG@10: 0.8534 - r1: 0.7236 - r5: 0.9346 - r10: 0.9721 - p5: 0.1869 - p10: 0.0972 - f1: 0.4365 - val_loss: 0.8185 - val_NDCG@10: 0.8877 - val_r1: 0.7818 - val_r5: 0.9544 - val_r10: 0.9799 - val_p5: 0.1909 - val_p10: 0.0980 - val_f1: 0.5573 - lr: 9.8713e-05 - e_time: 1.6197 - 2s/epoch - 14ms/step
Epoch 14/1000
137/137 - 2s - loss: 0.9878 - NDCG@10: 0.8559 - r1: 0.7280 - r5: 0.9372 - r10: 0.9723 - p5: 0.1874 - p10: 0.0972 - f1: 0.4390 - val_loss: 0.8143 - val_NDCG@10: 0.8876 - val_r1: 0.7821 - val_r5: 0.9539 - val_r10: 0.9799 - val_p5: 0.1908 - val_p10: 0.0980 - val_f1: 0.5395 - lr: 9.8614e-05 - e_time: 1.6121 - 2s/epoch - 15ms/step
Epoch 15/1000
137/137 - 2s - loss: 0.9781 - NDCG@10: 0.8570 - r1: 0.7283 - r5: 0.9383 - r10: 0.9731 - p5: 0.1877 - p10: 0.0973 - f1: 0.4499 - val_loss: 0.8140 - val_NDCG@10: 0.8868 - val_r1: 0.7803 - val_r5: 0.9529 - val_r10: 0.9795 - val_p5: 0.1906 - val_p10: 0.0980 - val_f1: 0.5739 - lr: 9.8515e-05 - e_time: 1.5962 - 2s/epoch - 13ms/step
Epoch 16/1000
137/137 - 2s - loss: 0.9717 - NDCG@10: 0.8583 - r1: 0.7300 - r5: 0.9395 - r10: 0.9736 - p5: 0.1879 - p10: 0.0974 - f1: 0.4627 - val_loss: 0.8072 - val_NDCG@10: 0.8883 - val_r1: 0.7841 - val_r5: 0.9554 - val_r10: 0.9793 - val_p5: 0.1911 - val_p10: 0.0979 - val_f1: 0.5703 - lr: 9.8416e-05 - e_time: 1.5993 - 2s/epoch - 13ms/step
Epoch 17/1000
137/137 - 2s - loss: 0.9638 - NDCG@10: 0.8590 - r1: 0.7308 - r5: 0.9409 - r10: 0.9746 - p5: 0.1882 - p10: 0.0975 - f1: 0.4531 - val_loss: 0.8051 - val_NDCG@10: 0.8885 - val_r1: 0.7848 - val_r5: 0.9532 - val_r10: 0.9801 - val_p5: 0.1906 - val_p10: 0.0980 - val_f1: 0.5658 - lr: 9.8317e-05 - e_time: 1.6079 - 2s/epoch - 13ms/step
Epoch 18/1000
137/137 - 2s - loss: 0.9592 - NDCG@10: 0.8600 - r1: 0.7320 - r5: 0.9416 - r10: 0.9756 - p5: 0.1883 - p10: 0.0976 - f1: 0.4559 - val_loss: 0.8039 - val_NDCG@10: 0.8888 - val_r1: 0.7841 - val_r5: 0.9554 - val_r10: 0.9808 - val_p5: 0.1911 - val_p10: 0.0981 - val_f1: 0.5619 - lr: 9.8218e-05 - e_time: 1.6375 - 2s/epoch - 15ms/step
Epoch 19/1000
137/137 - 2s - loss: 0.9449 - NDCG@10: 0.8616 - r1: 0.7348 - r5: 0.9426 - r10: 0.9760 - p5: 0.1885 - p10: 0.0976 - f1: 0.4538 - val_loss: 0.7962 - val_NDCG@10: 0.8899 - val_r1: 0.7859 - val_r5: 0.9573 - val_r10: 0.9808 - val_p5: 0.1915 - val_p10: 0.0981 - val_f1: 0.5681 - lr: 9.8119e-05 - e_time: 1.6171 - 2s/epoch - 13ms/step
Epoch 20/1000
137/137 - 2s - loss: 0.9386 - NDCG@10: 0.8633 - r1: 0.7368 - r5: 0.9442 - r10: 0.9771 - p5: 0.1888 - p10: 0.0977 - f1: 0.4635 - val_loss: 0.8001 - val_NDCG@10: 0.8891 - val_r1: 0.7840 - val_r5: 0.9563 - val_r10: 0.9809 - val_p5: 0.1913 - val_p10: 0.0981 - val_f1: 0.5426 - lr: 9.8020e-05 - e_time: 1.6046 - 2s/epoch - 12ms/step
Epoch 21/1000
137/137 - 2s - loss: 0.9354 - NDCG@10: 0.8638 - r1: 0.7383 - r5: 0.9445 - r10: 0.9765 - p5: 0.1889 - p10: 0.0976 - f1: 0.4504 - val_loss: 0.7954 - val_NDCG@10: 0.8898 - val_r1: 0.7864 - val_r5: 0.9552 - val_r10: 0.9810 - val_p5: 0.1910 - val_p10: 0.0981 - val_f1: 0.5547 - lr: 9.7921e-05 - e_time: 1.5916 - 2s/epoch - 13ms/step
Epoch 22/1000
137/137 - 2s - loss: 0.9297 - NDCG@10: 0.8633 - r1: 0.7357 - r5: 0.9456 - r10: 0.9771 - p5: 0.1891 - p10: 0.0977 - f1: 0.4587 - val_loss: 0.7971 - val_NDCG@10: 0.8889 - val_r1: 0.7842 - val_r5: 0.9551 - val_r10: 0.9806 - val_p5: 0.1910 - val_p10: 0.0981 - val_f1: 0.5783 - lr: 9.7822e-05 - e_time: 1.6035 - 2s/epoch - 12ms/step
Epoch 23/1000
137/137 - 2s - loss: 0.9232 - NDCG@10: 0.8658 - r1: 0.7400 - r5: 0.9470 - r10: 0.9781 - p5: 0.1894 - p10: 0.0978 - f1: 0.4613 - val_loss: 0.7964 - val_NDCG@10: 0.8892 - val_r1: 0.7854 - val_r5: 0.9542 - val_r10: 0.9799 - val_p5: 0.1908 - val_p10: 0.0980 - val_f1: 0.5694 - lr: 9.7723e-05 - e_time: 1.6197 - 2s/epoch - 12ms/step
Epoch 24/1000
137/137 - 2s - loss: 0.9118 - NDCG@10: 0.8664 - r1: 0.7408 - r5: 0.9464 - r10: 0.9788 - p5: 0.1893 - p10: 0.0979 - f1: 0.4590 - val_loss: 0.7880 - val_NDCG@10: 0.8918 - val_r1: 0.7902 - val_r5: 0.9546 - val_r10: 0.9816 - val_p5: 0.1909 - val_p10: 0.0982 - val_f1: 0.5810 - lr: 9.7624e-05 - e_time: 1.6170 - 2s/epoch - 14ms/step
Epoch 25/1000
137/137 - 2s - loss: 0.9134 - NDCG@10: 0.8671 - r1: 0.7418 - r5: 0.9475 - r10: 0.9791 - p5: 0.1895 - p10: 0.0979 - f1: 0.4713 - val_loss: 0.7928 - val_NDCG@10: 0.8899 - val_r1: 0.7875 - val_r5: 0.9554 - val_r10: 0.9799 - val_p5: 0.1911 - val_p10: 0.0980 - val_f1: 0.5805 - lr: 9.7525e-05 - e_time: 1.6163 - 2s/epoch - 12ms/step
Epoch 26/1000
137/137 - 2s - loss: 0.9053 - NDCG@10: 0.8680 - r1: 0.7443 - r5: 0.9470 - r10: 0.9788 - p5: 0.1894 - p10: 0.0979 - f1: 0.4689 - val_loss: 0.7975 - val_NDCG@10: 0.8897 - val_r1: 0.7866 - val_r5: 0.9544 - val_r10: 0.9806 - val_p5: 0.1909 - val_p10: 0.0981 - val_f1: 0.5682 - lr: 9.7426e-05 - e_time: 1.6218 - 2s/epoch - 12ms/step
Epoch 27/1000
137/137 - 2s - loss: 0.9028 - NDCG@10: 0.8681 - r1: 0.7436 - r5: 0.9477 - r10: 0.9787 - p5: 0.1895 - p10: 0.0979 - f1: 0.4580 - val_loss: 0.7860 - val_NDCG@10: 0.8917 - val_r1: 0.7892 - val_r5: 0.9558 - val_r10: 0.9812 - val_p5: 0.1912 - val_p10: 0.0981 - val_f1: 0.5556 - lr: 9.7327e-05 - e_time: 1.6299 - 2s/epoch - 13ms/step
Epoch 28/1000
137/137 - 2s - loss: 0.8965 - NDCG@10: 0.8693 - r1: 0.7463 - r5: 0.9480 - r10: 0.9793 - p5: 0.1896 - p10: 0.0979 - f1: 0.4581 - val_loss: 0.7840 - val_NDCG@10: 0.8918 - val_r1: 0.7911 - val_r5: 0.9555 - val_r10: 0.9802 - val_p5: 0.1911 - val_p10: 0.0980 - val_f1: 0.5624 - lr: 9.7228e-05 - e_time: 1.6308 - 2s/epoch - 14ms/step
Epoch 29/1000
137/137 - 2s - loss: 0.8916 - NDCG@10: 0.8696 - r1: 0.7450 - r5: 0.9489 - r10: 0.9804 - p5: 0.1898 - p10: 0.0980 - f1: 0.4695 - val_loss: 0.7892 - val_NDCG@10: 0.8895 - val_r1: 0.7852 - val_r5: 0.9544 - val_r10: 0.9804 - val_p5: 0.1909 - val_p10: 0.0980 - val_f1: 0.5749 - lr: 9.7129e-05 - e_time: 1.5932 - 2s/epoch - 12ms/step
Epoch 30/1000
137/137 - 2s - loss: 0.8856 - NDCG@10: 0.8711 - r1: 0.7486 - r5: 0.9497 - r10: 0.9803 - p5: 0.1899 - p10: 0.0980 - f1: 0.4786 - val_loss: 0.7880 - val_NDCG@10: 0.8910 - val_r1: 0.7881 - val_r5: 0.9556 - val_r10: 0.9815 - val_p5: 0.1911 - val_p10: 0.0982 - val_f1: 0.5825 - lr: 9.7030e-05 - e_time: 1.6226 - 2s/epoch - 12ms/step
Epoch 31/1000
137/137 - 2s - loss: 0.8831 - NDCG@10: 0.8717 - r1: 0.7496 - r5: 0.9505 - r10: 0.9806 - p5: 0.1901 - p10: 0.0981 - f1: 0.4681 - val_loss: 0.7947 - val_NDCG@10: 0.8906 - val_r1: 0.7878 - val_r5: 0.9550 - val_r10: 0.9806 - val_p5: 0.1910 - val_p10: 0.0981 - val_f1: 0.5800 - lr: 9.6931e-05 - e_time: 1.6052 - 2s/epoch - 12ms/step
Epoch 32/1000
137/137 - 2s - loss: 0.8804 - NDCG@10: 0.8716 - r1: 0.7483 - r5: 0.9508 - r10: 0.9811 - p5: 0.1902 - p10: 0.0981 - f1: 0.4686 - val_loss: 0.7908 - val_NDCG@10: 0.8913 - val_r1: 0.7892 - val_r5: 0.9547 - val_r10: 0.9810 - val_p5: 0.1909 - val_p10: 0.0981 - val_f1: 0.5776 - lr: 9.6832e-05 - e_time: 1.6122 - 2s/epoch - 12ms/step
Epoch 33/1000
137/137 - 2s - loss: 0.8721 - NDCG@10: 0.8721 - r1: 0.7494 - r5: 0.9512 - r10: 0.9810 - p5: 0.1902 - p10: 0.0981 - f1: 0.4778 - val_loss: 0.7891 - val_NDCG@10: 0.8909 - val_r1: 0.7881 - val_r5: 0.9554 - val_r10: 0.9810 - val_p5: 0.1911 - val_p10: 0.0981 - val_f1: 0.5695 - lr: 9.6733e-05 - e_time: 1.6226 - 2s/epoch - 12ms/step
Epoch 34/1000
137/137 - 2s - loss: 0.8748 - NDCG@10: 0.8711 - r1: 0.7476 - r5: 0.9507 - r10: 0.9805 - p5: 0.1901 - p10: 0.0980 - f1: 0.4766 - val_loss: 0.7889 - val_NDCG@10: 0.8913 - val_r1: 0.7894 - val_r5: 0.9548 - val_r10: 0.9804 - val_p5: 0.1910 - val_p10: 0.0980 - val_f1: 0.5744 - lr: 9.6634e-05 - e_time: 1.6097 - 2s/epoch - 12ms/step
Epoch 35/1000
137/137 - 2s - loss: 0.8671 - NDCG@10: 0.8739 - r1: 0.7520 - r5: 0.9525 - r10: 0.9820 - p5: 0.1905 - p10: 0.0982 - f1: 0.4711 - val_loss: 0.7848 - val_NDCG@10: 0.8919 - val_r1: 0.7896 - val_r5: 0.9555 - val_r10: 0.9822 - val_p5: 0.1911 - val_p10: 0.0982 - val_f1: 0.5809 - lr: 9.6535e-05 - e_time: 1.6105 - 2s/epoch - 12ms/step
Epoch 36/1000
137/137 - 2s - loss: 0.8592 - NDCG@10: 0.8745 - r1: 0.7523 - r5: 0.9527 - r10: 0.9824 - p5: 0.1905 - p10: 0.0982 - f1: 0.4786 - val_loss: 0.7902 - val_NDCG@10: 0.8916 - val_r1: 0.7905 - val_r5: 0.9544 - val_r10: 0.9808 - val_p5: 0.1909 - val_p10: 0.0981 - val_f1: 0.5926 - lr: 9.6436e-05 - e_time: 1.6097 - 2s/epoch - 12ms/step
Epoch 37/1000
137/137 - 2s - loss: 0.8598 - NDCG@10: 0.8741 - r1: 0.7527 - r5: 0.9523 - r10: 0.9817 - p5: 0.1905 - p10: 0.0982 - f1: 0.4722 - val_loss: 0.7877 - val_NDCG@10: 0.8920 - val_r1: 0.7918 - val_r5: 0.9538 - val_r10: 0.9808 - val_p5: 0.1908 - val_p10: 0.0981 - val_f1: 0.5879 - lr: 9.6337e-05 - e_time: 1.6207 - 2s/epoch - 12ms/step
Epoch 38/1000
137/137 - 2s - loss: 0.8550 - NDCG@10: 0.8739 - r1: 0.7509 - r5: 0.9532 - r10: 0.9827 - p5: 0.1906 - p10: 0.0983 - f1: 0.4840 - val_loss: 0.7897 - val_NDCG@10: 0.8911 - val_r1: 0.7894 - val_r5: 0.9532 - val_r10: 0.9806 - val_p5: 0.1907 - val_p10: 0.0981 - val_f1: 0.6128 - lr: 9.6238e-05 - e_time: 1.6181 - 2s/epoch - 12ms/step
Epoch 38: early stopping
[92m[INFO] Loading best model...[0m
