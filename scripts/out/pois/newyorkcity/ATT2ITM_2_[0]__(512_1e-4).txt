Using TensorFlow backend
Epoch 1/1000
196/196 - 7s - loss: 2.9124 - NDCG@10: 0.5126 - r1: 0.3162 - r5: 0.6112 - r10: 0.7314 - p5: 0.1222 - p10: 0.0731 - f1: 0.1119 - val_loss: 1.9200 - val_NDCG@10: 0.7249 - val_r1: 0.5631 - val_r5: 0.8200 - val_r10: 0.8795 - val_p5: 0.1640 - val_p10: 0.0879 - val_f1: 0.1596 - lr: 9.9901e-05 - e_time: 6.2568 - 7s/epoch - 33ms/step
Epoch 2/1000
196/196 - 3s - loss: 1.8814 - NDCG@10: 0.7080 - r1: 0.5260 - r5: 0.8147 - r10: 0.8862 - p5: 0.1629 - p10: 0.0886 - f1: 0.1477 - val_loss: 1.4152 - val_NDCG@10: 0.8052 - val_r1: 0.6636 - val_r5: 0.8910 - val_r10: 0.9375 - val_p5: 0.1782 - val_p10: 0.0938 - val_f1: 0.1927 - lr: 9.9802e-05 - e_time: 2.4001 - 3s/epoch - 14ms/step
Epoch 3/1000
196/196 - 3s - loss: 1.5813 - NDCG@10: 0.7589 - r1: 0.5913 - r5: 0.8595 - r10: 0.9197 - p5: 0.1719 - p10: 0.0920 - f1: 0.2085 - val_loss: 1.2165 - val_NDCG@10: 0.8335 - val_r1: 0.6981 - val_r5: 0.9173 - val_r10: 0.9568 - val_p5: 0.1835 - val_p10: 0.0957 - val_f1: 0.3270 - lr: 9.9703e-05 - e_time: 2.4021 - 3s/epoch - 14ms/step
Epoch 4/1000
196/196 - 3s - loss: 1.4221 - NDCG@10: 0.7850 - r1: 0.6245 - r5: 0.8831 - r10: 0.9368 - p5: 0.1766 - p10: 0.0937 - f1: 0.2906 - val_loss: 1.1144 - val_NDCG@10: 0.8456 - val_r1: 0.7134 - val_r5: 0.9291 - val_r10: 0.9643 - val_p5: 0.1858 - val_p10: 0.0964 - val_f1: 0.3770 - lr: 9.9604e-05 - e_time: 2.3777 - 3s/epoch - 13ms/step
Epoch 5/1000
196/196 - 3s - loss: 1.3353 - NDCG@10: 0.7993 - r1: 0.6430 - r5: 0.8955 - r10: 0.9456 - p5: 0.1791 - p10: 0.0946 - f1: 0.3341 - val_loss: 1.0442 - val_NDCG@10: 0.8571 - val_r1: 0.7293 - val_r5: 0.9380 - val_r10: 0.9703 - val_p5: 0.1876 - val_p10: 0.0970 - val_f1: 0.4270 - lr: 9.9505e-05 - e_time: 2.3475 - 3s/epoch - 13ms/step
Epoch 6/1000
196/196 - 3s - loss: 1.2712 - NDCG@10: 0.8102 - r1: 0.6571 - r5: 0.9057 - r10: 0.9518 - p5: 0.1811 - p10: 0.0952 - f1: 0.3563 - val_loss: 1.0035 - val_NDCG@10: 0.8623 - val_r1: 0.7377 - val_r5: 0.9411 - val_r10: 0.9723 - val_p5: 0.1882 - val_p10: 0.0972 - val_f1: 0.4617 - lr: 9.9406e-05 - e_time: 2.3797 - 3s/epoch - 14ms/step
Epoch 7/1000
196/196 - 3s - loss: 1.2265 - NDCG@10: 0.8176 - r1: 0.6679 - r5: 0.9107 - r10: 0.9552 - p5: 0.1821 - p10: 0.0955 - f1: 0.3693 - val_loss: 0.9726 - val_NDCG@10: 0.8672 - val_r1: 0.7452 - val_r5: 0.9444 - val_r10: 0.9739 - val_p5: 0.1889 - val_p10: 0.0974 - val_f1: 0.4902 - lr: 9.9307e-05 - e_time: 2.3486 - 3s/epoch - 13ms/step
Epoch 8/1000
196/196 - 3s - loss: 1.1978 - NDCG@10: 0.8223 - r1: 0.6748 - r5: 0.9141 - r10: 0.9574 - p5: 0.1828 - p10: 0.0957 - f1: 0.3848 - val_loss: 0.9521 - val_NDCG@10: 0.8709 - val_r1: 0.7521 - val_r5: 0.9464 - val_r10: 0.9754 - val_p5: 0.1893 - val_p10: 0.0975 - val_f1: 0.5020 - lr: 9.9208e-05 - e_time: 2.4149 - 3s/epoch - 14ms/step
Epoch 9/1000
196/196 - 3s - loss: 1.1715 - NDCG@10: 0.8269 - r1: 0.6806 - r5: 0.9190 - r10: 0.9603 - p5: 0.1838 - p10: 0.0960 - f1: 0.3866 - val_loss: 0.9389 - val_NDCG@10: 0.8715 - val_r1: 0.7514 - val_r5: 0.9482 - val_r10: 0.9768 - val_p5: 0.1896 - val_p10: 0.0977 - val_f1: 0.5151 - lr: 9.9109e-05 - e_time: 2.4159 - 3s/epoch - 14ms/step
Epoch 10/1000
196/196 - 3s - loss: 1.1498 - NDCG@10: 0.8298 - r1: 0.6842 - r5: 0.9221 - r10: 0.9626 - p5: 0.1844 - p10: 0.0963 - f1: 0.3887 - val_loss: 0.9242 - val_NDCG@10: 0.8735 - val_r1: 0.7551 - val_r5: 0.9499 - val_r10: 0.9764 - val_p5: 0.1900 - val_p10: 0.0976 - val_f1: 0.5069 - lr: 9.9010e-05 - e_time: 2.3732 - 3s/epoch - 13ms/step
Epoch 11/1000
196/196 - 3s - loss: 1.1301 - NDCG@10: 0.8329 - r1: 0.6888 - r5: 0.9241 - r10: 0.9636 - p5: 0.1848 - p10: 0.0964 - f1: 0.3897 - val_loss: 0.9193 - val_NDCG@10: 0.8739 - val_r1: 0.7554 - val_r5: 0.9513 - val_r10: 0.9771 - val_p5: 0.1903 - val_p10: 0.0977 - val_f1: 0.4683 - lr: 9.8911e-05 - e_time: 2.3726 - 3s/epoch - 14ms/step
Epoch 12/1000
196/196 - 3s - loss: 1.1141 - NDCG@10: 0.8363 - r1: 0.6940 - r5: 0.9257 - r10: 0.9653 - p5: 0.1851 - p10: 0.0965 - f1: 0.3909 - val_loss: 0.9123 - val_NDCG@10: 0.8761 - val_r1: 0.7592 - val_r5: 0.9513 - val_r10: 0.9778 - val_p5: 0.1903 - val_p10: 0.0978 - val_f1: 0.5079 - lr: 9.8812e-05 - e_time: 2.3594 - 3s/epoch - 13ms/step
Epoch 13/1000
196/196 - 3s - loss: 1.1023 - NDCG@10: 0.8374 - r1: 0.6956 - r5: 0.9269 - r10: 0.9655 - p5: 0.1854 - p10: 0.0966 - f1: 0.4061 - val_loss: 0.9030 - val_NDCG@10: 0.8764 - val_r1: 0.7594 - val_r5: 0.9521 - val_r10: 0.9780 - val_p5: 0.1904 - val_p10: 0.0978 - val_f1: 0.5510 - lr: 9.8713e-05 - e_time: 2.3831 - 3s/epoch - 14ms/step
Epoch 14/1000
196/196 - 3s - loss: 1.0899 - NDCG@10: 0.8388 - r1: 0.6967 - r5: 0.9277 - r10: 0.9671 - p5: 0.1855 - p10: 0.0967 - f1: 0.4098 - val_loss: 0.8997 - val_NDCG@10: 0.8762 - val_r1: 0.7582 - val_r5: 0.9522 - val_r10: 0.9778 - val_p5: 0.1904 - val_p10: 0.0978 - val_f1: 0.5079 - lr: 9.8614e-05 - e_time: 2.4094 - 3s/epoch - 14ms/step
Epoch 15/1000
196/196 - 3s - loss: 1.0844 - NDCG@10: 0.8402 - r1: 0.6985 - r5: 0.9296 - r10: 0.9680 - p5: 0.1859 - p10: 0.0968 - f1: 0.4083 - val_loss: 0.8926 - val_NDCG@10: 0.8780 - val_r1: 0.7635 - val_r5: 0.9521 - val_r10: 0.9779 - val_p5: 0.1904 - val_p10: 0.0978 - val_f1: 0.5579 - lr: 9.8515e-05 - e_time: 2.4272 - 3s/epoch - 14ms/step
Epoch 16/1000
196/196 - 2s - loss: 1.0698 - NDCG@10: 0.8428 - r1: 0.7025 - r5: 0.9318 - r10: 0.9688 - p5: 0.1863 - p10: 0.0969 - f1: 0.4223 - val_loss: 0.8946 - val_NDCG@10: 0.8762 - val_r1: 0.7579 - val_r5: 0.9521 - val_r10: 0.9782 - val_p5: 0.1904 - val_p10: 0.0978 - val_f1: 0.5590 - lr: 9.8416e-05 - e_time: 2.4204 - 2s/epoch - 12ms/step
Epoch 17/1000
196/196 - 3s - loss: 1.0627 - NDCG@10: 0.8433 - r1: 0.7031 - r5: 0.9322 - r10: 0.9693 - p5: 0.1864 - p10: 0.0969 - f1: 0.4156 - val_loss: 0.8828 - val_NDCG@10: 0.8790 - val_r1: 0.7642 - val_r5: 0.9529 - val_r10: 0.9783 - val_p5: 0.1906 - val_p10: 0.0978 - val_f1: 0.5470 - lr: 9.8317e-05 - e_time: 2.4091 - 3s/epoch - 14ms/step
Epoch 18/1000
196/196 - 2s - loss: 1.0505 - NDCG@10: 0.8452 - r1: 0.7058 - r5: 0.9343 - r10: 0.9699 - p5: 0.1869 - p10: 0.0970 - f1: 0.4196 - val_loss: 0.8874 - val_NDCG@10: 0.8767 - val_r1: 0.7591 - val_r5: 0.9521 - val_r10: 0.9778 - val_p5: 0.1904 - val_p10: 0.0978 - val_f1: 0.5561 - lr: 9.8218e-05 - e_time: 2.3973 - 2s/epoch - 12ms/step
Epoch 19/1000
196/196 - 3s - loss: 1.0449 - NDCG@10: 0.8464 - r1: 0.7075 - r5: 0.9351 - r10: 0.9704 - p5: 0.1870 - p10: 0.0970 - f1: 0.4238 - val_loss: 0.8798 - val_NDCG@10: 0.8782 - val_r1: 0.7625 - val_r5: 0.9530 - val_r10: 0.9782 - val_p5: 0.1906 - val_p10: 0.0978 - val_f1: 0.5533 - lr: 9.8119e-05 - e_time: 2.4075 - 3s/epoch - 14ms/step
Epoch 20/1000
196/196 - 2s - loss: 1.0426 - NDCG@10: 0.8465 - r1: 0.7068 - r5: 0.9360 - r10: 0.9712 - p5: 0.1872 - p10: 0.0971 - f1: 0.4321 - val_loss: 0.8863 - val_NDCG@10: 0.8777 - val_r1: 0.7608 - val_r5: 0.9528 - val_r10: 0.9786 - val_p5: 0.1906 - val_p10: 0.0979 - val_f1: 0.5355 - lr: 9.8020e-05 - e_time: 2.3668 - 2s/epoch - 12ms/step
Epoch 21/1000
196/196 - 2s - loss: 1.0243 - NDCG@10: 0.8491 - r1: 0.7102 - r5: 0.9378 - r10: 0.9729 - p5: 0.1876 - p10: 0.0973 - f1: 0.4134 - val_loss: 0.8804 - val_NDCG@10: 0.8776 - val_r1: 0.7593 - val_r5: 0.9522 - val_r10: 0.9791 - val_p5: 0.1904 - val_p10: 0.0979 - val_f1: 0.5451 - lr: 9.7921e-05 - e_time: 2.3980 - 2s/epoch - 12ms/step
Epoch 22/1000
196/196 - 2s - loss: 1.0208 - NDCG@10: 0.8497 - r1: 0.7116 - r5: 0.9378 - r10: 0.9724 - p5: 0.1876 - p10: 0.0972 - f1: 0.4198 - val_loss: 0.8810 - val_NDCG@10: 0.8768 - val_r1: 0.7588 - val_r5: 0.9525 - val_r10: 0.9779 - val_p5: 0.1905 - val_p10: 0.0978 - val_f1: 0.5313 - lr: 9.7822e-05 - e_time: 2.3555 - 2s/epoch - 12ms/step
Epoch 23/1000
196/196 - 3s - loss: 1.0139 - NDCG@10: 0.8507 - r1: 0.7135 - r5: 0.9381 - r10: 0.9734 - p5: 0.1876 - p10: 0.0973 - f1: 0.4260 - val_loss: 0.8722 - val_NDCG@10: 0.8791 - val_r1: 0.7633 - val_r5: 0.9532 - val_r10: 0.9785 - val_p5: 0.1906 - val_p10: 0.0978 - val_f1: 0.5427 - lr: 9.7723e-05 - e_time: 2.3675 - 3s/epoch - 14ms/step
Epoch 24/1000
196/196 - 2s - loss: 1.0122 - NDCG@10: 0.8516 - r1: 0.7151 - r5: 0.9385 - r10: 0.9732 - p5: 0.1877 - p10: 0.0973 - f1: 0.4378 - val_loss: 0.8767 - val_NDCG@10: 0.8785 - val_r1: 0.7630 - val_r5: 0.9508 - val_r10: 0.9781 - val_p5: 0.1902 - val_p10: 0.0978 - val_f1: 0.5720 - lr: 9.7624e-05 - e_time: 2.3743 - 2s/epoch - 12ms/step
Epoch 25/1000
196/196 - 2s - loss: 1.0023 - NDCG@10: 0.8521 - r1: 0.7148 - r5: 0.9395 - r10: 0.9740 - p5: 0.1879 - p10: 0.0974 - f1: 0.4273 - val_loss: 0.8776 - val_NDCG@10: 0.8778 - val_r1: 0.7604 - val_r5: 0.9518 - val_r10: 0.9785 - val_p5: 0.1904 - val_p10: 0.0979 - val_f1: 0.5487 - lr: 9.7525e-05 - e_time: 2.3845 - 2s/epoch - 12ms/step
Epoch 26/1000
196/196 - 2s - loss: 0.9978 - NDCG@10: 0.8528 - r1: 0.7157 - r5: 0.9408 - r10: 0.9740 - p5: 0.1881 - p10: 0.0974 - f1: 0.4267 - val_loss: 0.8734 - val_NDCG@10: 0.8789 - val_r1: 0.7632 - val_r5: 0.9539 - val_r10: 0.9786 - val_p5: 0.1908 - val_p10: 0.0979 - val_f1: 0.5555 - lr: 9.7426e-05 - e_time: 2.4017 - 2s/epoch - 12ms/step
Epoch 27/1000
196/196 - 2s - loss: 0.9956 - NDCG@10: 0.8531 - r1: 0.7169 - r5: 0.9405 - r10: 0.9739 - p5: 0.1881 - p10: 0.0974 - f1: 0.4376 - val_loss: 0.8772 - val_NDCG@10: 0.8786 - val_r1: 0.7623 - val_r5: 0.9524 - val_r10: 0.9789 - val_p5: 0.1905 - val_p10: 0.0979 - val_f1: 0.5336 - lr: 9.7327e-05 - e_time: 2.3651 - 2s/epoch - 12ms/step
Epoch 28/1000
196/196 - 2s - loss: 0.9896 - NDCG@10: 0.8540 - r1: 0.7178 - r5: 0.9414 - r10: 0.9745 - p5: 0.1883 - p10: 0.0975 - f1: 0.4362 - val_loss: 0.8728 - val_NDCG@10: 0.8788 - val_r1: 0.7633 - val_r5: 0.9524 - val_r10: 0.9785 - val_p5: 0.1905 - val_p10: 0.0978 - val_f1: 0.5434 - lr: 9.7228e-05 - e_time: 2.4036 - 2s/epoch - 12ms/step
Epoch 29/1000
196/196 - 3s - loss: 0.9864 - NDCG@10: 0.8547 - r1: 0.7187 - r5: 0.9415 - r10: 0.9751 - p5: 0.1883 - p10: 0.0975 - f1: 0.4373 - val_loss: 0.8717 - val_NDCG@10: 0.8787 - val_r1: 0.7635 - val_r5: 0.9523 - val_r10: 0.9783 - val_p5: 0.1905 - val_p10: 0.0978 - val_f1: 0.5604 - lr: 9.7129e-05 - e_time: 2.3523 - 3s/epoch - 13ms/step
Epoch 30/1000
196/196 - 3s - loss: 0.9784 - NDCG@10: 0.8561 - r1: 0.7215 - r5: 0.9424 - r10: 0.9753 - p5: 0.1885 - p10: 0.0975 - f1: 0.4327 - val_loss: 0.8683 - val_NDCG@10: 0.8795 - val_r1: 0.7644 - val_r5: 0.9534 - val_r10: 0.9789 - val_p5: 0.1907 - val_p10: 0.0979 - val_f1: 0.5505 - lr: 9.7030e-05 - e_time: 2.4023 - 3s/epoch - 14ms/step
Epoch 31/1000
196/196 - 2s - loss: 0.9755 - NDCG@10: 0.8559 - r1: 0.7196 - r5: 0.9436 - r10: 0.9757 - p5: 0.1887 - p10: 0.0976 - f1: 0.4343 - val_loss: 0.8735 - val_NDCG@10: 0.8794 - val_r1: 0.7655 - val_r5: 0.9512 - val_r10: 0.9784 - val_p5: 0.1902 - val_p10: 0.0978 - val_f1: 0.5234 - lr: 9.6931e-05 - e_time: 2.4256 - 2s/epoch - 12ms/step
Epoch 32/1000
196/196 - 2s - loss: 0.9737 - NDCG@10: 0.8569 - r1: 0.7219 - r5: 0.9439 - r10: 0.9760 - p5: 0.1888 - p10: 0.0976 - f1: 0.4385 - val_loss: 0.8756 - val_NDCG@10: 0.8787 - val_r1: 0.7639 - val_r5: 0.9511 - val_r10: 0.9779 - val_p5: 0.1902 - val_p10: 0.0978 - val_f1: 0.5557 - lr: 9.6832e-05 - e_time: 2.3602 - 2s/epoch - 12ms/step
Epoch 33/1000
196/196 - 2s - loss: 0.9626 - NDCG@10: 0.8580 - r1: 0.7233 - r5: 0.9442 - r10: 0.9763 - p5: 0.1888 - p10: 0.0976 - f1: 0.4375 - val_loss: 0.8735 - val_NDCG@10: 0.8795 - val_r1: 0.7655 - val_r5: 0.9518 - val_r10: 0.9785 - val_p5: 0.1904 - val_p10: 0.0978 - val_f1: 0.5524 - lr: 9.6733e-05 - e_time: 2.3870 - 2s/epoch - 12ms/step
Epoch 34/1000
196/196 - 2s - loss: 0.9586 - NDCG@10: 0.8581 - r1: 0.7237 - r5: 0.9445 - r10: 0.9763 - p5: 0.1889 - p10: 0.0976 - f1: 0.4351 - val_loss: 0.8789 - val_NDCG@10: 0.8786 - val_r1: 0.7633 - val_r5: 0.9515 - val_r10: 0.9786 - val_p5: 0.1903 - val_p10: 0.0979 - val_f1: 0.5389 - lr: 9.6634e-05 - e_time: 2.3817 - 2s/epoch - 12ms/step
Epoch 35/1000
196/196 - 2s - loss: 0.9597 - NDCG@10: 0.8583 - r1: 0.7237 - r5: 0.9448 - r10: 0.9768 - p5: 0.1890 - p10: 0.0977 - f1: 0.4356 - val_loss: 0.8784 - val_NDCG@10: 0.8781 - val_r1: 0.7639 - val_r5: 0.9508 - val_r10: 0.9773 - val_p5: 0.1902 - val_p10: 0.0977 - val_f1: 0.5589 - lr: 9.6535e-05 - e_time: 2.3737 - 2s/epoch - 12ms/step
Epoch 36/1000
196/196 - 2s - loss: 0.9570 - NDCG@10: 0.8592 - r1: 0.7251 - r5: 0.9451 - r10: 0.9774 - p5: 0.1890 - p10: 0.0977 - f1: 0.4330 - val_loss: 0.8689 - val_NDCG@10: 0.8798 - val_r1: 0.7665 - val_r5: 0.9512 - val_r10: 0.9780 - val_p5: 0.1902 - val_p10: 0.0978 - val_f1: 0.5658 - lr: 9.6436e-05 - e_time: 2.4031 - 2s/epoch - 12ms/step
Epoch 37/1000
196/196 - 2s - loss: 0.9472 - NDCG@10: 0.8609 - r1: 0.7279 - r5: 0.9466 - r10: 0.9779 - p5: 0.1893 - p10: 0.0978 - f1: 0.4351 - val_loss: 0.8747 - val_NDCG@10: 0.8786 - val_r1: 0.7635 - val_r5: 0.9512 - val_r10: 0.9781 - val_p5: 0.1902 - val_p10: 0.0978 - val_f1: 0.5444 - lr: 9.6337e-05 - e_time: 2.3785 - 2s/epoch - 12ms/step
Epoch 38/1000
196/196 - 2s - loss: 0.9433 - NDCG@10: 0.8604 - r1: 0.7262 - r5: 0.9470 - r10: 0.9779 - p5: 0.1894 - p10: 0.0978 - f1: 0.4382 - val_loss: 0.8750 - val_NDCG@10: 0.8792 - val_r1: 0.7660 - val_r5: 0.9510 - val_r10: 0.9774 - val_p5: 0.1902 - val_p10: 0.0977 - val_f1: 0.5733 - lr: 9.6238e-05 - e_time: 2.3451 - 2s/epoch - 12ms/step
Epoch 39/1000
196/196 - 2s - loss: 0.9433 - NDCG@10: 0.8611 - r1: 0.7282 - r5: 0.9467 - r10: 0.9780 - p5: 0.1894 - p10: 0.0978 - f1: 0.4454 - val_loss: 0.8684 - val_NDCG@10: 0.8791 - val_r1: 0.7651 - val_r5: 0.9519 - val_r10: 0.9771 - val_p5: 0.1904 - val_p10: 0.0977 - val_f1: 0.5412 - lr: 9.6139e-05 - e_time: 2.4187 - 2s/epoch - 12ms/step
Epoch 40/1000
196/196 - 2s - loss: 0.9428 - NDCG@10: 0.8610 - r1: 0.7269 - r5: 0.9474 - r10: 0.9784 - p5: 0.1895 - p10: 0.0978 - f1: 0.4429 - val_loss: 0.8788 - val_NDCG@10: 0.8776 - val_r1: 0.7616 - val_r5: 0.9517 - val_r10: 0.9778 - val_p5: 0.1903 - val_p10: 0.0978 - val_f1: 0.5576 - lr: 9.6040e-05 - e_time: 2.3991 - 2s/epoch - 12ms/step
Epoch 40: early stopping
[92m[INFO] Loading best model...[0m
