Using TensorFlow backend
Epoch 1/1000
745/745 - 44s - loss: 5.5437 - NDCG@10: 0.2098 - r1: 0.1268 - r5: 0.2464 - r10: 0.3109 - p5: 0.0493 - p10: 0.0311 - f1: 0.0063 - val_loss: 4.6471 - val_NDCG@10: 0.3459 - val_r1: 0.2297 - val_r5: 0.4005 - val_r10: 0.4829 - val_p5: 0.0801 - val_p10: 0.0483 - val_f1: 0.0094 - lr: 4.9951e-04 - e_time: 43.6324 - 44s/epoch - 59ms/step
Epoch 2/1000
745/745 - 41s - loss: 4.5762 - NDCG@10: 0.3325 - r1: 0.2177 - r5: 0.3871 - r10: 0.4667 - p5: 0.0774 - p10: 0.0467 - f1: 0.0108 - val_loss: 4.4802 - val_NDCG@10: 0.3716 - val_r1: 0.2544 - val_r5: 0.4291 - val_r10: 0.5079 - val_p5: 0.0858 - val_p10: 0.0508 - val_f1: 0.0116 - lr: 4.9901e-04 - e_time: 39.9770 - 41s/epoch - 55ms/step
Epoch 3/1000
745/745 - 41s - loss: 4.2863 - NDCG@10: 0.3729 - r1: 0.2528 - r5: 0.4316 - r10: 0.5117 - p5: 0.0863 - p10: 0.0512 - f1: 0.0124 - val_loss: 4.3938 - val_NDCG@10: 0.3836 - val_r1: 0.2663 - val_r5: 0.4409 - val_r10: 0.5198 - val_p5: 0.0882 - val_p10: 0.0520 - val_f1: 0.0150 - lr: 4.9852e-04 - e_time: 39.8819 - 41s/epoch - 54ms/step
Epoch 4/1000
745/745 - 41s - loss: 4.1143 - NDCG@10: 0.3969 - r1: 0.2738 - r5: 0.4580 - r10: 0.5383 - p5: 0.0916 - p10: 0.0538 - f1: 0.0133 - val_loss: 4.1114 - val_NDCG@10: 0.4209 - val_r1: 0.3011 - val_r5: 0.4825 - val_r10: 0.5567 - val_p5: 0.0965 - val_p10: 0.0557 - val_f1: 0.0158 - lr: 4.9802e-04 - e_time: 39.9941 - 41s/epoch - 55ms/step
Epoch 5/1000
745/745 - 41s - loss: 3.9920 - NDCG@10: 0.4129 - r1: 0.2872 - r5: 0.4755 - r10: 0.5563 - p5: 0.0951 - p10: 0.0556 - f1: 0.0143 - val_loss: 4.0535 - val_NDCG@10: 0.4283 - val_r1: 0.3085 - val_r5: 0.4892 - val_r10: 0.5641 - val_p5: 0.0978 - val_p10: 0.0564 - val_f1: 0.0162 - lr: 4.9753e-04 - e_time: 39.9226 - 41s/epoch - 54ms/step
Epoch 6/1000
745/745 - 40s - loss: 3.8920 - NDCG@10: 0.4269 - r1: 0.3000 - r5: 0.4911 - r10: 0.5707 - p5: 0.0982 - p10: 0.0571 - f1: 0.0148 - val_loss: 4.0734 - val_NDCG@10: 0.4258 - val_r1: 0.3073 - val_r5: 0.4843 - val_r10: 0.5607 - val_p5: 0.0969 - val_p10: 0.0561 - val_f1: 0.0170 - lr: 4.9703e-04 - e_time: 39.9410 - 40s/epoch - 54ms/step
Epoch 7/1000
745/745 - 41s - loss: 3.8132 - NDCG@10: 0.4378 - r1: 0.3100 - r5: 0.5026 - r10: 0.5822 - p5: 0.1005 - p10: 0.0582 - f1: 0.0153 - val_loss: 4.0022 - val_NDCG@10: 0.4355 - val_r1: 0.3146 - val_r5: 0.4976 - val_r10: 0.5715 - val_p5: 0.0995 - val_p10: 0.0572 - val_f1: 0.0185 - lr: 4.9654e-04 - e_time: 39.9130 - 41s/epoch - 54ms/step
Epoch 8/1000
745/745 - 41s - loss: 3.7477 - NDCG@10: 0.4461 - r1: 0.3167 - r5: 0.5122 - r10: 0.5918 - p5: 0.1024 - p10: 0.0592 - f1: 0.0157 - val_loss: 3.9807 - val_NDCG@10: 0.4387 - val_r1: 0.3195 - val_r5: 0.4997 - val_r10: 0.5735 - val_p5: 0.0999 - val_p10: 0.0574 - val_f1: 0.0186 - lr: 4.9604e-04 - e_time: 39.8769 - 41s/epoch - 54ms/step
Epoch 9/1000
745/745 - 41s - loss: 3.6827 - NDCG@10: 0.4560 - r1: 0.3264 - r5: 0.5224 - r10: 0.6017 - p5: 0.1045 - p10: 0.0602 - f1: 0.0163 - val_loss: 3.9727 - val_NDCG@10: 0.4398 - val_r1: 0.3202 - val_r5: 0.4996 - val_r10: 0.5743 - val_p5: 0.0999 - val_p10: 0.0574 - val_f1: 0.0198 - lr: 4.9555e-04 - e_time: 39.8540 - 41s/epoch - 54ms/step
Epoch 10/1000
745/745 - 41s - loss: 3.6297 - NDCG@10: 0.4630 - r1: 0.3324 - r5: 0.5301 - r10: 0.6096 - p5: 0.1060 - p10: 0.0610 - f1: 0.0161 - val_loss: 3.9711 - val_NDCG@10: 0.4421 - val_r1: 0.3232 - val_r5: 0.5025 - val_r10: 0.5763 - val_p5: 0.1005 - val_p10: 0.0576 - val_f1: 0.0199 - lr: 4.9505e-04 - e_time: 39.8613 - 41s/epoch - 54ms/step
Epoch 11/1000
745/745 - 41s - loss: 3.5843 - NDCG@10: 0.4687 - r1: 0.3378 - r5: 0.5353 - r10: 0.6154 - p5: 0.1071 - p10: 0.0615 - f1: 0.0165 - val_loss: 3.9510 - val_NDCG@10: 0.4441 - val_r1: 0.3251 - val_r5: 0.5051 - val_r10: 0.5783 - val_p5: 0.1010 - val_p10: 0.0578 - val_f1: 0.0193 - lr: 4.9456e-04 - e_time: 39.9949 - 41s/epoch - 55ms/step
Epoch 12/1000
745/745 - 41s - loss: 3.5385 - NDCG@10: 0.4753 - r1: 0.3431 - r5: 0.5436 - r10: 0.6231 - p5: 0.1087 - p10: 0.0623 - f1: 0.0168 - val_loss: 3.7921 - val_NDCG@10: 0.4652 - val_r1: 0.3455 - val_r5: 0.5252 - val_r10: 0.5997 - val_p5: 0.1050 - val_p10: 0.0600 - val_f1: 0.0205 - lr: 4.9406e-04 - e_time: 39.8425 - 41s/epoch - 54ms/step
Epoch 13/1000
745/745 - 40s - loss: 3.4999 - NDCG@10: 0.4809 - r1: 0.3485 - r5: 0.5501 - r10: 0.6283 - p5: 0.1100 - p10: 0.0628 - f1: 0.0170 - val_loss: 3.9259 - val_NDCG@10: 0.4486 - val_r1: 0.3307 - val_r5: 0.5085 - val_r10: 0.5820 - val_p5: 0.1017 - val_p10: 0.0582 - val_f1: 0.0196 - lr: 4.9357e-04 - e_time: 39.9556 - 40s/epoch - 54ms/step
Epoch 14/1000
745/745 - 40s - loss: 3.4564 - NDCG@10: 0.4867 - r1: 0.3541 - r5: 0.5554 - r10: 0.6342 - p5: 0.1111 - p10: 0.0634 - f1: 0.0173 - val_loss: 3.9012 - val_NDCG@10: 0.4517 - val_r1: 0.3315 - val_r5: 0.5142 - val_r10: 0.5857 - val_p5: 0.1028 - val_p10: 0.0586 - val_f1: 0.0205 - lr: 4.9307e-04 - e_time: 39.8779 - 40s/epoch - 54ms/step
Epoch 15/1000
745/745 - 40s - loss: 3.4293 - NDCG@10: 0.4903 - r1: 0.3575 - r5: 0.5590 - r10: 0.6377 - p5: 0.1118 - p10: 0.0638 - f1: 0.0177 - val_loss: 3.8669 - val_NDCG@10: 0.4574 - val_r1: 0.3400 - val_r5: 0.5185 - val_r10: 0.5889 - val_p5: 0.1037 - val_p10: 0.0589 - val_f1: 0.0191 - lr: 4.9258e-04 - e_time: 39.8579 - 40s/epoch - 54ms/step
Epoch 16/1000
745/745 - 40s - loss: 3.4004 - NDCG@10: 0.4947 - r1: 0.3623 - r5: 0.5642 - r10: 0.6416 - p5: 0.1128 - p10: 0.0642 - f1: 0.0178 - val_loss: 3.8580 - val_NDCG@10: 0.4574 - val_r1: 0.3401 - val_r5: 0.5166 - val_r10: 0.5897 - val_p5: 0.1033 - val_p10: 0.0590 - val_f1: 0.0198 - lr: 4.9208e-04 - e_time: 39.8587 - 40s/epoch - 54ms/step
Epoch 17/1000
745/745 - 40s - loss: 3.3731 - NDCG@10: 0.4980 - r1: 0.3643 - r5: 0.5683 - r10: 0.6461 - p5: 0.1137 - p10: 0.0646 - f1: 0.0180 - val_loss: 3.8955 - val_NDCG@10: 0.4544 - val_r1: 0.3356 - val_r5: 0.5149 - val_r10: 0.5875 - val_p5: 0.1030 - val_p10: 0.0588 - val_f1: 0.0218 - lr: 4.9159e-04 - e_time: 39.9007 - 40s/epoch - 54ms/step
Epoch 18/1000
745/745 - 41s - loss: 3.3420 - NDCG@10: 0.5027 - r1: 0.3691 - r5: 0.5721 - r10: 0.6506 - p5: 0.1144 - p10: 0.0651 - f1: 0.0182 - val_loss: 3.7493 - val_NDCG@10: 0.4709 - val_r1: 0.3508 - val_r5: 0.5335 - val_r10: 0.6039 - val_p5: 0.1067 - val_p10: 0.0604 - val_f1: 0.0230 - lr: 4.9109e-04 - e_time: 39.8862 - 41s/epoch - 54ms/step
Epoch 19/1000
745/745 - 40s - loss: 3.3188 - NDCG@10: 0.5055 - r1: 0.3711 - r5: 0.5759 - r10: 0.6538 - p5: 0.1152 - p10: 0.0654 - f1: 0.0181 - val_loss: 3.8762 - val_NDCG@10: 0.4563 - val_r1: 0.3379 - val_r5: 0.5170 - val_r10: 0.5884 - val_p5: 0.1034 - val_p10: 0.0588 - val_f1: 0.0195 - lr: 4.9060e-04 - e_time: 39.8114 - 40s/epoch - 53ms/step
Epoch 20/1000
745/745 - 40s - loss: 3.2965 - NDCG@10: 0.5088 - r1: 0.3748 - r5: 0.5787 - r10: 0.6567 - p5: 0.1158 - p10: 0.0657 - f1: 0.0185 - val_loss: 3.8464 - val_NDCG@10: 0.4601 - val_r1: 0.3420 - val_r5: 0.5218 - val_r10: 0.5918 - val_p5: 0.1044 - val_p10: 0.0592 - val_f1: 0.0209 - lr: 4.9010e-04 - e_time: 39.8279 - 40s/epoch - 53ms/step
Epoch 21/1000
745/745 - 40s - loss: 3.2743 - NDCG@10: 0.5124 - r1: 0.3775 - r5: 0.5835 - r10: 0.6610 - p5: 0.1167 - p10: 0.0661 - f1: 0.0183 - val_loss: 3.7497 - val_NDCG@10: 0.4722 - val_r1: 0.3528 - val_r5: 0.5345 - val_r10: 0.6042 - val_p5: 0.1069 - val_p10: 0.0604 - val_f1: 0.0219 - lr: 4.8961e-04 - e_time: 39.9050 - 40s/epoch - 54ms/step
Epoch 22/1000
745/745 - 40s - loss: 3.2543 - NDCG@10: 0.5149 - r1: 0.3801 - r5: 0.5858 - r10: 0.6635 - p5: 0.1172 - p10: 0.0664 - f1: 0.0186 - val_loss: 3.8693 - val_NDCG@10: 0.4580 - val_r1: 0.3398 - val_r5: 0.5202 - val_r10: 0.5895 - val_p5: 0.1041 - val_p10: 0.0590 - val_f1: 0.0211 - lr: 4.8911e-04 - e_time: 39.9438 - 40s/epoch - 54ms/step
Epoch 23/1000
745/745 - 40s - loss: 3.2295 - NDCG@10: 0.5179 - r1: 0.3821 - r5: 0.5891 - r10: 0.6669 - p5: 0.1178 - p10: 0.0667 - f1: 0.0188 - val_loss: 3.9118 - val_NDCG@10: 0.4546 - val_r1: 0.3361 - val_r5: 0.5157 - val_r10: 0.5856 - val_p5: 0.1032 - val_p10: 0.0586 - val_f1: 0.0230 - lr: 4.8862e-04 - e_time: 39.9038 - 40s/epoch - 54ms/step
Epoch 24/1000
745/745 - 40s - loss: 3.2159 - NDCG@10: 0.5201 - r1: 0.3846 - r5: 0.5911 - r10: 0.6690 - p5: 0.1182 - p10: 0.0669 - f1: 0.0187 - val_loss: 3.7631 - val_NDCG@10: 0.4715 - val_r1: 0.3523 - val_r5: 0.5330 - val_r10: 0.6030 - val_p5: 0.1066 - val_p10: 0.0603 - val_f1: 0.0246 - lr: 4.8812e-04 - e_time: 39.9306 - 40s/epoch - 54ms/step
Epoch 25/1000
745/745 - 40s - loss: 3.1997 - NDCG@10: 0.5227 - r1: 0.3873 - r5: 0.5941 - r10: 0.6710 - p5: 0.1188 - p10: 0.0671 - f1: 0.0190 - val_loss: 3.8826 - val_NDCG@10: 0.4585 - val_r1: 0.3402 - val_r5: 0.5186 - val_r10: 0.5909 - val_p5: 0.1037 - val_p10: 0.0591 - val_f1: 0.0216 - lr: 4.8763e-04 - e_time: 39.8740 - 40s/epoch - 54ms/step
Epoch 26/1000
745/745 - 40s - loss: 3.1806 - NDCG@10: 0.5250 - r1: 0.3895 - r5: 0.5972 - r10: 0.6736 - p5: 0.1194 - p10: 0.0674 - f1: 0.0192 - val_loss: 3.8847 - val_NDCG@10: 0.4591 - val_r1: 0.3429 - val_r5: 0.5201 - val_r10: 0.5890 - val_p5: 0.1040 - val_p10: 0.0589 - val_f1: 0.0217 - lr: 4.8713e-04 - e_time: 39.8757 - 40s/epoch - 54ms/step
Epoch 27/1000
745/745 - 40s - loss: 3.1663 - NDCG@10: 0.5276 - r1: 0.3919 - r5: 0.5997 - r10: 0.6759 - p5: 0.1199 - p10: 0.0676 - f1: 0.0191 - val_loss: 3.8212 - val_NDCG@10: 0.4659 - val_r1: 0.3472 - val_r5: 0.5265 - val_r10: 0.5973 - val_p5: 0.1053 - val_p10: 0.0597 - val_f1: 0.0215 - lr: 4.8664e-04 - e_time: 39.8902 - 40s/epoch - 54ms/step
Epoch 28/1000
745/745 - 40s - loss: 3.1504 - NDCG@10: 0.5297 - r1: 0.3947 - r5: 0.6016 - r10: 0.6770 - p5: 0.1203 - p10: 0.0677 - f1: 0.0192 - val_loss: 3.8829 - val_NDCG@10: 0.4596 - val_r1: 0.3420 - val_r5: 0.5222 - val_r10: 0.5902 - val_p5: 0.1045 - val_p10: 0.0590 - val_f1: 0.0204 - lr: 4.8614e-04 - e_time: 39.8349 - 40s/epoch - 53ms/step
Epoch 28: early stopping
[92m[INFO] Loading best model...[0m
