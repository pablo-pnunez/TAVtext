Model: "ATT2ITM_0"
__________________________________________________________________________________________________
 Layer (type)                   Output Shape         Param #     Connected to                     
==================================================================================================
 input_1 (InputLayer)           [(None, 178)]        0           []                               
                                                                                                  
 input_2 (InputLayer)           [(None, 3415)]       0           []                               
                                                                                                  
 embedding (Embedding)          (None, 178, 384)     5538048     ['input_1[0][0]']                
                                                                                                  
 in_rsts (Embedding)            (None, 3415, 384)    1311360     ['input_2[0][0]']                
                                                                                                  
 dense (Dense)                  (None, 178, 256)     98560       ['embedding[0][0]']              
                                                                                                  
 dense_2 (Dense)                (None, 3415, 256)    98560       ['in_rsts[0][0]']                
                                                                                                  
 tf.math.not_equal (TFOpLambda)  (None, 178)         0           ['input_1[0][0]']                
                                                                                                  
 dense_1 (Dense)                (None, 178, 128)     32896       ['dense[0][0]']                  
                                                                                                  
 dense_3 (Dense)                (None, 3415, 128)    32896       ['dense_2[0][0]']                
                                                                                                  
 tf.cast (TFOpLambda)           (None, 178)          0           ['tf.math.not_equal[0][0]']      
                                                                                                  
 word_emb (Lambda)              (None, 178, 128)     0           ['dense_1[0][0]']                
                                                                                                  
 rest_emb (Lambda)              (None, 3415, 128)    0           ['dense_3[0][0]']                
                                                                                                  
 tf.expand_dims (TFOpLambda)    (None, 178, 1)       0           ['tf.cast[0][0]']                
                                                                                                  
 lambda (Lambda)                (None, 178, 3415)    0           ['word_emb[0][0]',               
                                                                  'rest_emb[0][0]']               
                                                                                                  
 tf.tile (TFOpLambda)           (None, 178, 3415)    0           ['tf.expand_dims[0][0]']         
                                                                                                  
 lambda_1 (Lambda)              (None, 178, 3415)    0           ['lambda[0][0]',                 
                                                                  'tf.tile[0][0]']                
                                                                                                  
 dotprod (Activation)           (None, 178, 3415)    0           ['lambda_1[0][0]']               
                                                                                                  
 dropout (Dropout)              (None, 178, 3415)    0           ['dotprod[0][0]']                
                                                                                                  
 sum (Lambda)                   (None, 3415)         0           ['dropout[0][0]']                
                                                                                                  
 out (Activation)               (None, 3415)         0           ['sum[0][0]']                    
                                                                                                  
==================================================================================================
Total params: 7,112,320
Trainable params: 7,112,320
Non-trainable params: 0
__________________________________________________________________________________________________
None
Epoch 1/1000
2531/2531 - 185s - loss: 6.9884 - r1: 0.0426 - r5: 0.0938 - r10: 0.1278 - p5: 0.0188 - p10: 0.0128 - val_loss: 6.1941 - val_r1: 0.0849 - val_r5: 0.1780 - val_r10: 0.2365 - val_p5: 0.0356 - val_p10: 0.0236 - lr: 9.9901e-05 - e_time: 184.4087 - 185s/epoch - 73ms/step
Epoch 2/1000
2531/2531 - 183s - loss: 5.9973 - r1: 0.0968 - r5: 0.1952 - r10: 0.2531 - p5: 0.0390 - p10: 0.0253 - val_loss: 5.7248 - val_r1: 0.1304 - val_r5: 0.2522 - val_r10: 0.3215 - val_p5: 0.0504 - val_p10: 0.0321 - lr: 9.9802e-05 - e_time: 182.3007 - 183s/epoch - 72ms/step
Epoch 3/1000
2531/2531 - 183s - loss: 5.6963 - r1: 0.1228 - r5: 0.2381 - r10: 0.3025 - p5: 0.0476 - p10: 0.0302 - val_loss: 5.5126 - val_r1: 0.1548 - val_r5: 0.2892 - val_r10: 0.3607 - val_p5: 0.0578 - val_p10: 0.0361 - lr: 9.9703e-05 - e_time: 182.2517 - 183s/epoch - 72ms/step
Epoch 4/1000
2531/2531 - 183s - loss: 5.5232 - r1: 0.1403 - r5: 0.2643 - r10: 0.3312 - p5: 0.0529 - p10: 0.0331 - val_loss: 5.3670 - val_r1: 0.1733 - val_r5: 0.3153 - val_r10: 0.3879 - val_p5: 0.0631 - val_p10: 0.0388 - lr: 9.9604e-05 - e_time: 182.2639 - 183s/epoch - 72ms/step
Epoch 5/1000
2531/2531 - 183s - loss: 5.3972 - r1: 0.1523 - r5: 0.2829 - r10: 0.3513 - p5: 0.0566 - p10: 0.0351 - val_loss: 5.2604 - val_r1: 0.1860 - val_r5: 0.3322 - val_r10: 0.4048 - val_p5: 0.0664 - val_p10: 0.0405 - lr: 9.9505e-05 - e_time: 182.2676 - 183s/epoch - 72ms/step
Epoch 6/1000
2531/2531 - 183s - loss: 5.2978 - r1: 0.1624 - r5: 0.2974 - r10: 0.3670 - p5: 0.0595 - p10: 0.0367 - val_loss: 5.2050 - val_r1: 0.1936 - val_r5: 0.3398 - val_r10: 0.4126 - val_p5: 0.0680 - val_p10: 0.0413 - lr: 9.9406e-05 - e_time: 182.3338 - 183s/epoch - 72ms/step
Epoch 7/1000
2531/2531 - 183s - loss: 5.2182 - r1: 0.1703 - r5: 0.3091 - r10: 0.3798 - p5: 0.0618 - p10: 0.0380 - val_loss: 5.1662 - val_r1: 0.1987 - val_r5: 0.3458 - val_r10: 0.4184 - val_p5: 0.0692 - val_p10: 0.0418 - lr: 9.9307e-05 - e_time: 182.2612 - 183s/epoch - 72ms/step
Epoch 8/1000
2531/2531 - 183s - loss: 5.1504 - r1: 0.1774 - r5: 0.3189 - r10: 0.3904 - p5: 0.0638 - p10: 0.0390 - val_loss: 5.1148 - val_r1: 0.2034 - val_r5: 0.3533 - val_r10: 0.4279 - val_p5: 0.0707 - val_p10: 0.0428 - lr: 9.9208e-05 - e_time: 182.3124 - 183s/epoch - 72ms/step
Epoch 9/1000
2531/2531 - 183s - loss: 5.0917 - r1: 0.1837 - r5: 0.3284 - r10: 0.4000 - p5: 0.0657 - p10: 0.0400 - val_loss: 5.0905 - val_r1: 0.2076 - val_r5: 0.3555 - val_r10: 0.4281 - val_p5: 0.0711 - val_p10: 0.0428 - lr: 9.9109e-05 - e_time: 182.2848 - 183s/epoch - 72ms/step
Epoch 10/1000
2531/2531 - 182s - loss: 5.0355 - r1: 0.1894 - r5: 0.3362 - r10: 0.4077 - p5: 0.0672 - p10: 0.0408 - val_loss: 5.0933 - val_r1: 0.2057 - val_r5: 0.3539 - val_r10: 0.4267 - val_p5: 0.0708 - val_p10: 0.0427 - lr: 9.9010e-05 - e_time: 182.3129 - 182s/epoch - 72ms/step
Epoch 11/1000
2531/2531 - 183s - loss: 4.9882 - r1: 0.1941 - r5: 0.3429 - r10: 0.4153 - p5: 0.0686 - p10: 0.0415 - val_loss: 5.0750 - val_r1: 0.2089 - val_r5: 0.3570 - val_r10: 0.4294 - val_p5: 0.0714 - val_p10: 0.0429 - lr: 9.8911e-05 - e_time: 182.2758 - 183s/epoch - 72ms/step
Epoch 12/1000
2531/2531 - 183s - loss: 4.9451 - r1: 0.1990 - r5: 0.3496 - r10: 0.4223 - p5: 0.0699 - p10: 0.0422 - val_loss: 5.0487 - val_r1: 0.2118 - val_r5: 0.3615 - val_r10: 0.4326 - val_p5: 0.0723 - val_p10: 0.0433 - lr: 9.8812e-05 - e_time: 182.2787 - 183s/epoch - 72ms/step
Epoch 13/1000
2531/2531 - 183s - loss: 4.8996 - r1: 0.2027 - r5: 0.3556 - r10: 0.4289 - p5: 0.0711 - p10: 0.0429 - val_loss: 5.0483 - val_r1: 0.2111 - val_r5: 0.3598 - val_r10: 0.4321 - val_p5: 0.0720 - val_p10: 0.0432 - lr: 9.8713e-05 - e_time: 182.2730 - 183s/epoch - 72ms/step
Epoch 14/1000
2531/2531 - 183s - loss: 4.8666 - r1: 0.2069 - r5: 0.3609 - r10: 0.4342 - p5: 0.0722 - p10: 0.0434 - val_loss: 5.0283 - val_r1: 0.2143 - val_r5: 0.3639 - val_r10: 0.4348 - val_p5: 0.0728 - val_p10: 0.0435 - lr: 9.8614e-05 - e_time: 182.3133 - 183s/epoch - 72ms/step
Epoch 15/1000
2531/2531 - 182s - loss: 4.8307 - r1: 0.2108 - r5: 0.3658 - r10: 0.4401 - p5: 0.0732 - p10: 0.0440 - val_loss: 5.0450 - val_r1: 0.2124 - val_r5: 0.3610 - val_r10: 0.4330 - val_p5: 0.0722 - val_p10: 0.0433 - lr: 9.8515e-05 - e_time: 182.2871 - 182s/epoch - 72ms/step
Epoch 16/1000
2531/2531 - 182s - loss: 4.7993 - r1: 0.2131 - r5: 0.3704 - r10: 0.4436 - p5: 0.0741 - p10: 0.0444 - val_loss: 5.0303 - val_r1: 0.2154 - val_r5: 0.3630 - val_r10: 0.4342 - val_p5: 0.0726 - val_p10: 0.0434 - lr: 9.8416e-05 - e_time: 182.2661 - 182s/epoch - 72ms/step
Epoch 17/1000
2531/2531 - 183s - loss: 4.7678 - r1: 0.2172 - r5: 0.3748 - r10: 0.4484 - p5: 0.0750 - p10: 0.0448 - val_loss: 5.0258 - val_r1: 0.2146 - val_r5: 0.3637 - val_r10: 0.4356 - val_p5: 0.0727 - val_p10: 0.0436 - lr: 9.8317e-05 - e_time: 182.2426 - 183s/epoch - 72ms/step
Epoch 18/1000
2531/2531 - 183s - loss: 4.7395 - r1: 0.2200 - r5: 0.3785 - r10: 0.4528 - p5: 0.0757 - p10: 0.0453 - val_loss: 5.0184 - val_r1: 0.2172 - val_r5: 0.3658 - val_r10: 0.4359 - val_p5: 0.0732 - val_p10: 0.0436 - lr: 9.8218e-05 - e_time: 182.2757 - 183s/epoch - 72ms/step
Epoch 19/1000
2531/2531 - 183s - loss: 4.7106 - r1: 0.2229 - r5: 0.3825 - r10: 0.4567 - p5: 0.0765 - p10: 0.0457 - val_loss: 5.0136 - val_r1: 0.2175 - val_r5: 0.3663 - val_r10: 0.4377 - val_p5: 0.0733 - val_p10: 0.0438 - lr: 9.8119e-05 - e_time: 182.3405 - 183s/epoch - 72ms/step
Epoch 20/1000
2531/2531 - 183s - loss: 4.6855 - r1: 0.2257 - r5: 0.3863 - r10: 0.4614 - p5: 0.0773 - p10: 0.0461 - val_loss: 5.0038 - val_r1: 0.2185 - val_r5: 0.3672 - val_r10: 0.4381 - val_p5: 0.0734 - val_p10: 0.0438 - lr: 9.8020e-05 - e_time: 182.2881 - 183s/epoch - 72ms/step
Epoch 21/1000
2531/2531 - 182s - loss: 4.6632 - r1: 0.2273 - r5: 0.3900 - r10: 0.4648 - p5: 0.0780 - p10: 0.0465 - val_loss: 5.0176 - val_r1: 0.2174 - val_r5: 0.3653 - val_r10: 0.4361 - val_p5: 0.0731 - val_p10: 0.0436 - lr: 9.7921e-05 - e_time: 182.3397 - 182s/epoch - 72ms/step
Epoch 22/1000
2531/2531 - 182s - loss: 4.6388 - r1: 0.2307 - r5: 0.3933 - r10: 0.4682 - p5: 0.0787 - p10: 0.0468 - val_loss: 5.0162 - val_r1: 0.2161 - val_r5: 0.3656 - val_r10: 0.4362 - val_p5: 0.0731 - val_p10: 0.0436 - lr: 9.7822e-05 - e_time: 182.2924 - 182s/epoch - 72ms/step
Epoch 23/1000
2531/2531 - 182s - loss: 4.6140 - r1: 0.2325 - r5: 0.3967 - r10: 0.4720 - p5: 0.0793 - p10: 0.0472 - val_loss: 5.0263 - val_r1: 0.2159 - val_r5: 0.3654 - val_r10: 0.4361 - val_p5: 0.0731 - val_p10: 0.0436 - lr: 9.7723e-05 - e_time: 182.2386 - 182s/epoch - 72ms/step
Epoch 24/1000
2531/2531 - 182s - loss: 4.5938 - r1: 0.2351 - r5: 0.4001 - r10: 0.4748 - p5: 0.0800 - p10: 0.0475 - val_loss: 5.0057 - val_r1: 0.2193 - val_r5: 0.3687 - val_r10: 0.4379 - val_p5: 0.0737 - val_p10: 0.0438 - lr: 9.7624e-05 - e_time: 182.2820 - 182s/epoch - 72ms/step
Epoch 25/1000
2531/2531 - 182s - loss: 4.5730 - r1: 0.2375 - r5: 0.4034 - r10: 0.4789 - p5: 0.0807 - p10: 0.0479 - val_loss: 5.0133 - val_r1: 0.2173 - val_r5: 0.3670 - val_r10: 0.4360 - val_p5: 0.0734 - val_p10: 0.0436 - lr: 9.7525e-05 - e_time: 182.2791 - 182s/epoch - 72ms/step
Epoch 26/1000
2531/2531 - 183s - loss: 4.5498 - r1: 0.2409 - r5: 0.4063 - r10: 0.4815 - p5: 0.0813 - p10: 0.0482 - val_loss: 4.9937 - val_r1: 0.2203 - val_r5: 0.3689 - val_r10: 0.4388 - val_p5: 0.0738 - val_p10: 0.0439 - lr: 9.7426e-05 - e_time: 182.2937 - 183s/epoch - 72ms/step
Epoch 27/1000
2531/2531 - 182s - loss: 4.5354 - r1: 0.2419 - r5: 0.4079 - r10: 0.4836 - p5: 0.0816 - p10: 0.0484 - val_loss: 5.0108 - val_r1: 0.2194 - val_r5: 0.3675 - val_r10: 0.4371 - val_p5: 0.0735 - val_p10: 0.0437 - lr: 9.7327e-05 - e_time: 182.4553 - 182s/epoch - 72ms/step
Epoch 28/1000
2531/2531 - 183s - loss: 4.5162 - r1: 0.2436 - r5: 0.4108 - r10: 0.4859 - p5: 0.0822 - p10: 0.0486 - val_loss: 4.9853 - val_r1: 0.2215 - val_r5: 0.3717 - val_r10: 0.4419 - val_p5: 0.0743 - val_p10: 0.0442 - lr: 9.7228e-05 - e_time: 182.4107 - 183s/epoch - 72ms/step
Epoch 29/1000
2531/2531 - 183s - loss: 4.4979 - r1: 0.2453 - r5: 0.4138 - r10: 0.4893 - p5: 0.0828 - p10: 0.0489 - val_loss: 4.9802 - val_r1: 0.2235 - val_r5: 0.3722 - val_r10: 0.4425 - val_p5: 0.0744 - val_p10: 0.0443 - lr: 9.7129e-05 - e_time: 182.3104 - 183s/epoch - 72ms/step
Epoch 30/1000
2531/2531 - 182s - loss: 4.4797 - r1: 0.2472 - r5: 0.4163 - r10: 0.4920 - p5: 0.0833 - p10: 0.0492 - val_loss: 4.9911 - val_r1: 0.2227 - val_r5: 0.3707 - val_r10: 0.4405 - val_p5: 0.0741 - val_p10: 0.0441 - lr: 9.7030e-05 - e_time: 182.2900 - 182s/epoch - 72ms/step
Epoch 31/1000
2531/2531 - 182s - loss: 4.4653 - r1: 0.2487 - r5: 0.4184 - r10: 0.4937 - p5: 0.0837 - p10: 0.0494 - val_loss: 4.9910 - val_r1: 0.2214 - val_r5: 0.3707 - val_r10: 0.4397 - val_p5: 0.0741 - val_p10: 0.0440 - lr: 9.6931e-05 - e_time: 182.3036 - 182s/epoch - 72ms/step
Epoch 32/1000
2531/2531 - 182s - loss: 4.4477 - r1: 0.2505 - r5: 0.4210 - r10: 0.4968 - p5: 0.0842 - p10: 0.0497 - val_loss: 4.9813 - val_r1: 0.2239 - val_r5: 0.3731 - val_r10: 0.4415 - val_p5: 0.0746 - val_p10: 0.0442 - lr: 9.6832e-05 - e_time: 182.3732 - 182s/epoch - 72ms/step
Epoch 33/1000
2531/2531 - 182s - loss: 4.4290 - r1: 0.2524 - r5: 0.4240 - r10: 0.4994 - p5: 0.0848 - p10: 0.0499 - val_loss: 4.9855 - val_r1: 0.2239 - val_r5: 0.3721 - val_r10: 0.4419 - val_p5: 0.0744 - val_p10: 0.0442 - lr: 9.6733e-05 - e_time: 182.3310 - 182s/epoch - 72ms/step
Epoch 34/1000
2531/2531 - 182s - loss: 4.4158 - r1: 0.2544 - r5: 0.4252 - r10: 0.5011 - p5: 0.0850 - p10: 0.0501 - val_loss: 4.9915 - val_r1: 0.2231 - val_r5: 0.3713 - val_r10: 0.4415 - val_p5: 0.0743 - val_p10: 0.0442 - lr: 9.6634e-05 - e_time: 182.3497 - 182s/epoch - 72ms/step
Epoch 35/1000
2531/2531 - 182s - loss: 4.3993 - r1: 0.2561 - r5: 0.4280 - r10: 0.5039 - p5: 0.0856 - p10: 0.0504 - val_loss: 4.9963 - val_r1: 0.2209 - val_r5: 0.3706 - val_r10: 0.4408 - val_p5: 0.0741 - val_p10: 0.0441 - lr: 9.6535e-05 - e_time: 182.3182 - 182s/epoch - 72ms/step
Epoch 36/1000
2531/2531 - 183s - loss: 4.3871 - r1: 0.2575 - r5: 0.4300 - r10: 0.5060 - p5: 0.0860 - p10: 0.0506 - val_loss: 4.9750 - val_r1: 0.2244 - val_r5: 0.3731 - val_r10: 0.4436 - val_p5: 0.0746 - val_p10: 0.0444 - lr: 9.6436e-05 - e_time: 182.2957 - 183s/epoch - 72ms/step
Epoch 37/1000
2531/2531 - 182s - loss: 4.3724 - r1: 0.2591 - r5: 0.4317 - r10: 0.5074 - p5: 0.0863 - p10: 0.0507 - val_loss: 4.9837 - val_r1: 0.2231 - val_r5: 0.3731 - val_r10: 0.4428 - val_p5: 0.0746 - val_p10: 0.0443 - lr: 9.6337e-05 - e_time: 182.2931 - 182s/epoch - 72ms/step
Epoch 38/1000
2531/2531 - 183s - loss: 4.3601 - r1: 0.2600 - r5: 0.4335 - r10: 0.5098 - p5: 0.0867 - p10: 0.0510 - val_loss: 4.9740 - val_r1: 0.2249 - val_r5: 0.3742 - val_r10: 0.4435 - val_p5: 0.0748 - val_p10: 0.0444 - lr: 9.6238e-05 - e_time: 182.3166 - 183s/epoch - 72ms/step
Epoch 39/1000
2531/2531 - 183s - loss: 4.3486 - r1: 0.2617 - r5: 0.4350 - r10: 0.5111 - p5: 0.0870 - p10: 0.0511 - val_loss: 4.9693 - val_r1: 0.2259 - val_r5: 0.3746 - val_r10: 0.4442 - val_p5: 0.0749 - val_p10: 0.0444 - lr: 9.6139e-05 - e_time: 182.3322 - 183s/epoch - 72ms/step
Epoch 40/1000
2531/2531 - 182s - loss: 4.3316 - r1: 0.2636 - r5: 0.4375 - r10: 0.5133 - p5: 0.0875 - p10: 0.0513 - val_loss: 4.9821 - val_r1: 0.2246 - val_r5: 0.3734 - val_r10: 0.4425 - val_p5: 0.0747 - val_p10: 0.0442 - lr: 9.6040e-05 - e_time: 182.4607 - 182s/epoch - 72ms/step
Epoch 41/1000
2531/2531 - 182s - loss: 4.3211 - r1: 0.2650 - r5: 0.4390 - r10: 0.5151 - p5: 0.0878 - p10: 0.0515 - val_loss: 4.9959 - val_r1: 0.2228 - val_r5: 0.3710 - val_r10: 0.4406 - val_p5: 0.0742 - val_p10: 0.0441 - lr: 9.5941e-05 - e_time: 182.4546 - 182s/epoch - 72ms/step
Epoch 42/1000
2531/2531 - 182s - loss: 4.3097 - r1: 0.2660 - r5: 0.4410 - r10: 0.5167 - p5: 0.0882 - p10: 0.0517 - val_loss: 4.9832 - val_r1: 0.2251 - val_r5: 0.3733 - val_r10: 0.4420 - val_p5: 0.0747 - val_p10: 0.0442 - lr: 9.5842e-05 - e_time: 182.4608 - 182s/epoch - 72ms/step
Epoch 43/1000
2531/2531 - 182s - loss: 4.2985 - r1: 0.2677 - r5: 0.4419 - r10: 0.5181 - p5: 0.0884 - p10: 0.0518 - val_loss: 4.9826 - val_r1: 0.2255 - val_r5: 0.3726 - val_r10: 0.4425 - val_p5: 0.0745 - val_p10: 0.0442 - lr: 9.5743e-05 - e_time: 182.4386 - 182s/epoch - 72ms/step
Epoch 44/1000
2531/2531 - 182s - loss: 4.2839 - r1: 0.2690 - r5: 0.4443 - r10: 0.5204 - p5: 0.0889 - p10: 0.0520 - val_loss: 4.9826 - val_r1: 0.2250 - val_r5: 0.3741 - val_r10: 0.4421 - val_p5: 0.0748 - val_p10: 0.0442 - lr: 9.5644e-05 - e_time: 182.4343 - 182s/epoch - 72ms/step
Epoch 45/1000
2531/2531 - 182s - loss: 4.2770 - r1: 0.2697 - r5: 0.4460 - r10: 0.5220 - p5: 0.0892 - p10: 0.0522 - val_loss: 4.9764 - val_r1: 0.2253 - val_r5: 0.3746 - val_r10: 0.4430 - val_p5: 0.0749 - val_p10: 0.0443 - lr: 9.5545e-05 - e_time: 182.3854 - 182s/epoch - 72ms/step
Epoch 46/1000
2531/2531 - 182s - loss: 4.2607 - r1: 0.2711 - r5: 0.4480 - r10: 0.5246 - p5: 0.0896 - p10: 0.0525 - val_loss: 4.9821 - val_r1: 0.2256 - val_r5: 0.3720 - val_r10: 0.4418 - val_p5: 0.0744 - val_p10: 0.0442 - lr: 9.5446e-05 - e_time: 182.4862 - 182s/epoch - 72ms/step
Epoch 47/1000
2531/2531 - 182s - loss: 4.2532 - r1: 0.2721 - r5: 0.4493 - r10: 0.5254 - p5: 0.0899 - p10: 0.0525 - val_loss: 4.9809 - val_r1: 0.2261 - val_r5: 0.3747 - val_r10: 0.4420 - val_p5: 0.0749 - val_p10: 0.0442 - lr: 9.5347e-05 - e_time: 182.4629 - 182s/epoch - 72ms/step
Epoch 48/1000
2531/2531 - 182s - loss: 4.2448 - r1: 0.2732 - r5: 0.4503 - r10: 0.5264 - p5: 0.0901 - p10: 0.0526 - val_loss: 4.9920 - val_r1: 0.2256 - val_r5: 0.3719 - val_r10: 0.4419 - val_p5: 0.0744 - val_p10: 0.0442 - lr: 9.5248e-05 - e_time: 182.3668 - 182s/epoch - 72ms/step
Epoch 49/1000
2531/2531 - 182s - loss: 4.2325 - r1: 0.2749 - r5: 0.4520 - r10: 0.5278 - p5: 0.0904 - p10: 0.0528 - val_loss: 4.9984 - val_r1: 0.2250 - val_r5: 0.3716 - val_r10: 0.4407 - val_p5: 0.0743 - val_p10: 0.0441 - lr: 9.5149e-05 - e_time: 182.3596 - 182s/epoch - 72ms/step
Epoch 50/1000
2531/2531 - 182s - loss: 4.2244 - r1: 0.2759 - r5: 0.4533 - r10: 0.5294 - p5: 0.0907 - p10: 0.0529 - val_loss: 4.9906 - val_r1: 0.2256 - val_r5: 0.3723 - val_r10: 0.4424 - val_p5: 0.0745 - val_p10: 0.0442 - lr: 9.5050e-05 - e_time: 182.4005 - 182s/epoch - 72ms/step
Epoch 51/1000
2531/2531 - 182s - loss: 4.2147 - r1: 0.2773 - r5: 0.4550 - r10: 0.5310 - p5: 0.0910 - p10: 0.0531 - val_loss: 4.9980 - val_r1: 0.2255 - val_r5: 0.3712 - val_r10: 0.4408 - val_p5: 0.0742 - val_p10: 0.0441 - lr: 9.4951e-05 - e_time: 182.4148 - 182s/epoch - 72ms/step
Epoch 52/1000
2531/2531 - 182s - loss: 4.2016 - r1: 0.2782 - r5: 0.4568 - r10: 0.5327 - p5: 0.0914 - p10: 0.0533 - val_loss: 5.0094 - val_r1: 0.2248 - val_r5: 0.3696 - val_r10: 0.4397 - val_p5: 0.0739 - val_p10: 0.0440 - lr: 9.4852e-05 - e_time: 182.3933 - 182s/epoch - 72ms/step
Epoch 53/1000
2531/2531 - 182s - loss: 4.1940 - r1: 0.2785 - r5: 0.4574 - r10: 0.5336 - p5: 0.0915 - p10: 0.0534 - val_loss: 4.9937 - val_r1: 0.2256 - val_r5: 0.3721 - val_r10: 0.4418 - val_p5: 0.0744 - val_p10: 0.0442 - lr: 9.4753e-05 - e_time: 182.3916 - 182s/epoch - 72ms/step
Epoch 54/1000
2531/2531 - 182s - loss: 4.1862 - r1: 0.2806 - r5: 0.4586 - r10: 0.5351 - p5: 0.0917 - p10: 0.0535 - val_loss: 5.0026 - val_r1: 0.2242 - val_r5: 0.3722 - val_r10: 0.4406 - val_p5: 0.0744 - val_p10: 0.0441 - lr: 9.4654e-05 - e_time: 182.4758 - 182s/epoch - 72ms/step
Epoch 55/1000
2531/2531 - 182s - loss: 4.1774 - r1: 0.2812 - r5: 0.4602 - r10: 0.5363 - p5: 0.0920 - p10: 0.0536 - val_loss: 4.9959 - val_r1: 0.2266 - val_r5: 0.3725 - val_r10: 0.4401 - val_p5: 0.0745 - val_p10: 0.0440 - lr: 9.4555e-05 - e_time: 182.4979 - 182s/epoch - 72ms/step
Epoch 56/1000
2531/2531 - 182s - loss: 4.1711 - r1: 0.2816 - r5: 0.4608 - r10: 0.5373 - p5: 0.0922 - p10: 0.0537 - val_loss: 5.0087 - val_r1: 0.2257 - val_r5: 0.3711 - val_r10: 0.4385 - val_p5: 0.0742 - val_p10: 0.0438 - lr: 9.4456e-05 - e_time: 182.4693 - 182s/epoch - 72ms/step
Epoch 57/1000
2531/2531 - 183s - loss: 4.1622 - r1: 0.2828 - r5: 0.4629 - r10: 0.5390 - p5: 0.0926 - p10: 0.0539 - val_loss: 5.0102 - val_r1: 0.2255 - val_r5: 0.3716 - val_r10: 0.4403 - val_p5: 0.0743 - val_p10: 0.0440 - lr: 9.4357e-05 - e_time: 182.7568 - 183s/epoch - 72ms/step
Epoch 58/1000
2531/2531 - 183s - loss: 4.1546 - r1: 0.2841 - r5: 0.4628 - r10: 0.5391 - p5: 0.0926 - p10: 0.0539 - val_loss: 5.0108 - val_r1: 0.2252 - val_r5: 0.3708 - val_r10: 0.4405 - val_p5: 0.0742 - val_p10: 0.0441 - lr: 9.4258e-05 - e_time: 182.7144 - 183s/epoch - 72ms/step
Epoch 59/1000
2531/2531 - 183s - loss: 4.1481 - r1: 0.2843 - r5: 0.4645 - r10: 0.5404 - p5: 0.0929 - p10: 0.0540 - val_loss: 5.0135 - val_r1: 0.2266 - val_r5: 0.3716 - val_r10: 0.4398 - val_p5: 0.0743 - val_p10: 0.0440 - lr: 9.4159e-05 - e_time: 182.8405 - 183s/epoch - 72ms/step
Epoch 60/1000
2531/2531 - 183s - loss: 4.1413 - r1: 0.2856 - r5: 0.4652 - r10: 0.5409 - p5: 0.0930 - p10: 0.0541 - val_loss: 5.0057 - val_r1: 0.2265 - val_r5: 0.3728 - val_r10: 0.4413 - val_p5: 0.0746 - val_p10: 0.0441 - lr: 9.4060e-05 - e_time: 182.7236 - 183s/epoch - 72ms/step
Epoch 61/1000
2531/2531 - 183s - loss: 4.1327 - r1: 0.2863 - r5: 0.4666 - r10: 0.5428 - p5: 0.0933 - p10: 0.0543 - val_loss: 5.0246 - val_r1: 0.2251 - val_r5: 0.3695 - val_r10: 0.4377 - val_p5: 0.0739 - val_p10: 0.0438 - lr: 9.3961e-05 - e_time: 182.7462 - 183s/epoch - 72ms/step
Epoch 62/1000
2531/2531 - 183s - loss: 4.1274 - r1: 0.2863 - r5: 0.4681 - r10: 0.5438 - p5: 0.0936 - p10: 0.0544 - val_loss: 5.0264 - val_r1: 0.2249 - val_r5: 0.3692 - val_r10: 0.4385 - val_p5: 0.0738 - val_p10: 0.0439 - lr: 9.3862e-05 - e_time: 182.8345 - 183s/epoch - 72ms/step
Epoch 63/1000
2531/2531 - 183s - loss: 4.1195 - r1: 0.2876 - r5: 0.4683 - r10: 0.5447 - p5: 0.0937 - p10: 0.0545 - val_loss: 5.0136 - val_r1: 0.2273 - val_r5: 0.3711 - val_r10: 0.4390 - val_p5: 0.0742 - val_p10: 0.0439 - lr: 9.3763e-05 - e_time: 182.7454 - 183s/epoch - 72ms/step
Epoch 64/1000
2531/2531 - 183s - loss: 4.1108 - r1: 0.2893 - r5: 0.4696 - r10: 0.5459 - p5: 0.0939 - p10: 0.0546 - val_loss: 5.0078 - val_r1: 0.2263 - val_r5: 0.3727 - val_r10: 0.4396 - val_p5: 0.0745 - val_p10: 0.0440 - lr: 9.3664e-05 - e_time: 182.7492 - 183s/epoch - 72ms/step
Epoch 65/1000
2531/2531 - 183s - loss: 4.1041 - r1: 0.2897 - r5: 0.4707 - r10: 0.5468 - p5: 0.0941 - p10: 0.0547 - val_loss: 5.0096 - val_r1: 0.2267 - val_r5: 0.3711 - val_r10: 0.4395 - val_p5: 0.0742 - val_p10: 0.0439 - lr: 9.3565e-05 - e_time: 182.8149 - 183s/epoch - 72ms/step
Epoch 66/1000
2531/2531 - 183s - loss: 4.0997 - r1: 0.2902 - r5: 0.4716 - r10: 0.5478 - p5: 0.0943 - p10: 0.0548 - val_loss: 5.0062 - val_r1: 0.2263 - val_r5: 0.3715 - val_r10: 0.4398 - val_p5: 0.0743 - val_p10: 0.0440 - lr: 9.3466e-05 - e_time: 182.6805 - 183s/epoch - 72ms/step
Epoch 67/1000
2531/2531 - 183s - loss: 4.0921 - r1: 0.2908 - r5: 0.4724 - r10: 0.5484 - p5: 0.0945 - p10: 0.0548 - val_loss: 5.0159 - val_r1: 0.2269 - val_r5: 0.3719 - val_r10: 0.4397 - val_p5: 0.0744 - val_p10: 0.0440 - lr: 9.3367e-05 - e_time: 182.6934 - 183s/epoch - 72ms/step
Epoch 68/1000
2531/2531 - 183s - loss: 4.0895 - r1: 0.2908 - r5: 0.4726 - r10: 0.5490 - p5: 0.0945 - p10: 0.0549 - val_loss: 5.0304 - val_r1: 0.2240 - val_r5: 0.3701 - val_r10: 0.4383 - val_p5: 0.0740 - val_p10: 0.0438 - lr: 9.3268e-05 - e_time: 182.7677 - 183s/epoch - 72ms/step
Epoch 69/1000
2531/2531 - 183s - loss: 4.0780 - r1: 0.2921 - r5: 0.4744 - r10: 0.5506 - p5: 0.0949 - p10: 0.0551 - val_loss: 5.0232 - val_r1: 0.2257 - val_r5: 0.3715 - val_r10: 0.4383 - val_p5: 0.0743 - val_p10: 0.0438 - lr: 9.3169e-05 - e_time: 182.6597 - 183s/epoch - 72ms/step
Epoch 70/1000
2531/2531 - 183s - loss: 4.0725 - r1: 0.2930 - r5: 0.4757 - r10: 0.5511 - p5: 0.0951 - p10: 0.0551 - val_loss: 5.0096 - val_r1: 0.2274 - val_r5: 0.3728 - val_r10: 0.4398 - val_p5: 0.0746 - val_p10: 0.0440 - lr: 9.3070e-05 - e_time: 182.7691 - 183s/epoch - 72ms/step
Epoch 71/1000
2531/2531 - 183s - loss: 4.0676 - r1: 0.2939 - r5: 0.4765 - r10: 0.5525 - p5: 0.0953 - p10: 0.0552 - val_loss: 5.0375 - val_r1: 0.2248 - val_r5: 0.3692 - val_r10: 0.4373 - val_p5: 0.0738 - val_p10: 0.0437 - lr: 9.2971e-05 - e_time: 182.7249 - 183s/epoch - 72ms/step
Epoch 72/1000
2531/2531 - 183s - loss: 4.0620 - r1: 0.2945 - r5: 0.4768 - r10: 0.5528 - p5: 0.0954 - p10: 0.0553 - val_loss: 5.0299 - val_r1: 0.2247 - val_r5: 0.3704 - val_r10: 0.4383 - val_p5: 0.0741 - val_p10: 0.0438 - lr: 9.2872e-05 - e_time: 182.7424 - 183s/epoch - 72ms/step
Epoch 73/1000
2531/2531 - 183s - loss: 4.0578 - r1: 0.2953 - r5: 0.4775 - r10: 0.5533 - p5: 0.0955 - p10: 0.0553 - val_loss: 5.0362 - val_r1: 0.2241 - val_r5: 0.3692 - val_r10: 0.4368 - val_p5: 0.0738 - val_p10: 0.0437 - lr: 9.2773e-05 - e_time: 182.6853 - 183s/epoch - 72ms/step
Epoch 74/1000
2531/2531 - 183s - loss: 4.0533 - r1: 0.2959 - r5: 0.4785 - r10: 0.5543 - p5: 0.0957 - p10: 0.0554 - val_loss: 5.0230 - val_r1: 0.2266 - val_r5: 0.3717 - val_r10: 0.4392 - val_p5: 0.0743 - val_p10: 0.0439 - lr: 9.2674e-05 - e_time: 182.7538 - 183s/epoch - 72ms/step
Epoch 75/1000
2531/2531 - 183s - loss: 4.0440 - r1: 0.2964 - r5: 0.4795 - r10: 0.5555 - p5: 0.0959 - p10: 0.0556 - val_loss: 5.0166 - val_r1: 0.2277 - val_r5: 0.3718 - val_r10: 0.4397 - val_p5: 0.0744 - val_p10: 0.0440 - lr: 9.2575e-05 - e_time: 182.7271 - 183s/epoch - 72ms/step
Epoch 76/1000
2531/2531 - 183s - loss: 4.0426 - r1: 0.2962 - r5: 0.4792 - r10: 0.5556 - p5: 0.0958 - p10: 0.0556 - val_loss: 5.0350 - val_r1: 0.2252 - val_r5: 0.3693 - val_r10: 0.4371 - val_p5: 0.0739 - val_p10: 0.0437 - lr: 9.2476e-05 - e_time: 182.7380 - 183s/epoch - 72ms/step
Epoch 77/1000
2531/2531 - 183s - loss: 4.0353 - r1: 0.2977 - r5: 0.4809 - r10: 0.5571 - p5: 0.0962 - p10: 0.0557 - val_loss: 5.0325 - val_r1: 0.2249 - val_r5: 0.3709 - val_r10: 0.4389 - val_p5: 0.0742 - val_p10: 0.0439 - lr: 9.2377e-05 - e_time: 182.7883 - 183s/epoch - 72ms/step
Epoch 78/1000
2531/2531 - 183s - loss: 4.0281 - r1: 0.2985 - r5: 0.4817 - r10: 0.5582 - p5: 0.0963 - p10: 0.0558 - val_loss: 5.0219 - val_r1: 0.2264 - val_r5: 0.3712 - val_r10: 0.4396 - val_p5: 0.0742 - val_p10: 0.0440 - lr: 9.2278e-05 - e_time: 182.7249 - 183s/epoch - 72ms/step
Epoch 79/1000
2531/2531 - 183s - loss: 4.0235 - r1: 0.2986 - r5: 0.4825 - r10: 0.5587 - p5: 0.0965 - p10: 0.0559 - val_loss: 5.0075 - val_r1: 0.2279 - val_r5: 0.3735 - val_r10: 0.4409 - val_p5: 0.0747 - val_p10: 0.0441 - lr: 9.2179e-05 - e_time: 182.7765 - 183s/epoch - 72ms/step
Epoch 80/1000
2531/2531 - 183s - loss: 4.0177 - r1: 0.3001 - r5: 0.4832 - r10: 0.5591 - p5: 0.0966 - p10: 0.0559 - val_loss: 5.0227 - val_r1: 0.2264 - val_r5: 0.3714 - val_r10: 0.4402 - val_p5: 0.0743 - val_p10: 0.0440 - lr: 9.2080e-05 - e_time: 182.7615 - 183s/epoch - 72ms/step
Epoch 81/1000
2531/2531 - 183s - loss: 4.0137 - r1: 0.2997 - r5: 0.4836 - r10: 0.5595 - p5: 0.0967 - p10: 0.0559 - val_loss: 5.0190 - val_r1: 0.2272 - val_r5: 0.3717 - val_r10: 0.4406 - val_p5: 0.0743 - val_p10: 0.0441 - lr: 9.1981e-05 - e_time: 182.7995 - 183s/epoch - 72ms/step
Epoch 82/1000
2531/2531 - 183s - loss: 4.0085 - r1: 0.3010 - r5: 0.4842 - r10: 0.5606 - p5: 0.0968 - p10: 0.0561 - val_loss: 5.0209 - val_r1: 0.2278 - val_r5: 0.3716 - val_r10: 0.4408 - val_p5: 0.0743 - val_p10: 0.0441 - lr: 9.1882e-05 - e_time: 182.6095 - 183s/epoch - 72ms/step
Epoch 83/1000
2531/2531 - 183s - loss: 4.0040 - r1: 0.3009 - r5: 0.4852 - r10: 0.5619 - p5: 0.0970 - p10: 0.0562 - val_loss: 5.0153 - val_r1: 0.2268 - val_r5: 0.3728 - val_r10: 0.4406 - val_p5: 0.0746 - val_p10: 0.0441 - lr: 9.1783e-05 - e_time: 182.7415 - 183s/epoch - 72ms/step
Epoch 84/1000
2531/2531 - 183s - loss: 3.9986 - r1: 0.3022 - r5: 0.4859 - r10: 0.5623 - p5: 0.0972 - p10: 0.0562 - val_loss: 5.0127 - val_r1: 0.2277 - val_r5: 0.3726 - val_r10: 0.4415 - val_p5: 0.0745 - val_p10: 0.0442 - lr: 9.1684e-05 - e_time: 182.7778 - 183s/epoch - 72ms/step
Epoch 85/1000
2531/2531 - 183s - loss: 3.9961 - r1: 0.3023 - r5: 0.4857 - r10: 0.5619 - p5: 0.0971 - p10: 0.0562 - val_loss: 5.0218 - val_r1: 0.2265 - val_r5: 0.3722 - val_r10: 0.4401 - val_p5: 0.0744 - val_p10: 0.0440 - lr: 9.1585e-05 - e_time: 182.7168 - 183s/epoch - 72ms/step
Epoch 86/1000
2531/2531 - 183s - loss: 3.9910 - r1: 0.3029 - r5: 0.4872 - r10: 0.5632 - p5: 0.0974 - p10: 0.0563 - val_loss: 5.0297 - val_r1: 0.2257 - val_r5: 0.3711 - val_r10: 0.4380 - val_p5: 0.0742 - val_p10: 0.0438 - lr: 9.1486e-05 - e_time: 182.7325 - 183s/epoch - 72ms/step
Epoch 87/1000
2531/2531 - 183s - loss: 3.9880 - r1: 0.3032 - r5: 0.4879 - r10: 0.5635 - p5: 0.0976 - p10: 0.0563 - val_loss: 5.0338 - val_r1: 0.2254 - val_r5: 0.3709 - val_r10: 0.4387 - val_p5: 0.0742 - val_p10: 0.0439 - lr: 9.1387e-05 - e_time: 182.7091 - 183s/epoch - 72ms/step
Epoch 88/1000
2531/2531 - 183s - loss: 3.9826 - r1: 0.3041 - r5: 0.4888 - r10: 0.5650 - p5: 0.0978 - p10: 0.0565 - val_loss: 5.0248 - val_r1: 0.2266 - val_r5: 0.3713 - val_r10: 0.4382 - val_p5: 0.0743 - val_p10: 0.0438 - lr: 9.1288e-05 - e_time: 182.6905 - 183s/epoch - 72ms/step
Epoch 89/1000
2531/2531 - 183s - loss: 3.9778 - r1: 0.3045 - r5: 0.4895 - r10: 0.5651 - p5: 0.0979 - p10: 0.0565 - val_loss: 5.0267 - val_r1: 0.2263 - val_r5: 0.3713 - val_r10: 0.4394 - val_p5: 0.0743 - val_p10: 0.0439 - lr: 9.1189e-05 - e_time: 182.8331 - 183s/epoch - 72ms/step
Epoch 89: early stopping
[92m[INFO] Loading best model...[0m
