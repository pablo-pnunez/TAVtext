Model: "ATT2ITM_0"
__________________________________________________________________________________________________
 Layer (type)                   Output Shape         Param #     Connected to                     
==================================================================================================
 input_1 (InputLayer)           [(None, 178)]        0           []                               
                                                                                                  
 input_2 (InputLayer)           [(None, 3415)]       0           []                               
                                                                                                  
 embedding (Embedding)          (None, 178, 384)     5538048     ['input_1[0][0]']                
                                                                                                  
 in_rsts (Embedding)            (None, 3415, 384)    1311360     ['input_2[0][0]']                
                                                                                                  
 dense (Dense)                  (None, 178, 256)     98560       ['embedding[0][0]']              
                                                                                                  
 dense_2 (Dense)                (None, 3415, 256)    98560       ['in_rsts[0][0]']                
                                                                                                  
 tf.math.not_equal (TFOpLambda)  (None, 178)         0           ['input_1[0][0]']                
                                                                                                  
 dense_1 (Dense)                (None, 178, 128)     32896       ['dense[0][0]']                  
                                                                                                  
 dense_3 (Dense)                (None, 3415, 128)    32896       ['dense_2[0][0]']                
                                                                                                  
 tf.cast (TFOpLambda)           (None, 178)          0           ['tf.math.not_equal[0][0]']      
                                                                                                  
 word_emb (Lambda)              (None, 178, 128)     0           ['dense_1[0][0]']                
                                                                                                  
 rest_emb (Lambda)              (None, 3415, 128)    0           ['dense_3[0][0]']                
                                                                                                  
 tf.expand_dims (TFOpLambda)    (None, 178, 1)       0           ['tf.cast[0][0]']                
                                                                                                  
 lambda (Lambda)                (None, 178, 3415)    0           ['word_emb[0][0]',               
                                                                  'rest_emb[0][0]']               
                                                                                                  
 tf.tile (TFOpLambda)           (None, 178, 3415)    0           ['tf.expand_dims[0][0]']         
                                                                                                  
 lambda_1 (Lambda)              (None, 178, 3415)    0           ['lambda[0][0]',                 
                                                                  'tf.tile[0][0]']                
                                                                                                  
 dotprod (Activation)           (None, 178, 3415)    0           ['lambda_1[0][0]']               
                                                                                                  
 dropout (Dropout)              (None, 178, 3415)    0           ['dotprod[0][0]']                
                                                                                                  
 sum (Lambda)                   (None, 3415)         0           ['dropout[0][0]']                
                                                                                                  
 out (Activation)               (None, 3415)         0           ['sum[0][0]']                    
                                                                                                  
==================================================================================================
Total params: 7,112,320
Trainable params: 7,112,320
Non-trainable params: 0
__________________________________________________________________________________________________
None
Epoch 1/1000
1266/1266 - 154s - loss: 6.4232 - r1: 0.0775 - r5: 0.1586 - r10: 0.2068 - p5: 0.0317 - p10: 0.0207 - val_loss: 6.3619 - val_r1: 0.0730 - val_r5: 0.1613 - val_r10: 0.2182 - val_p5: 0.0323 - val_p10: 0.0218 - lr: 4.9951e-04 - 154s/epoch - 122ms/step
Epoch 2/1000
1266/1266 - 151s - loss: 5.5905 - r1: 0.1373 - r5: 0.2600 - r10: 0.3260 - p5: 0.0520 - p10: 0.0326 - val_loss: 7.8644 - val_r1: 0.0414 - val_r5: 0.0945 - val_r10: 0.1308 - val_p5: 0.0189 - val_p10: 0.0131 - lr: 4.9901e-04 - 151s/epoch - 119ms/step
Epoch 3/1000
1266/1266 - 151s - loss: 5.3321 - r1: 0.1615 - r5: 0.2958 - r10: 0.3651 - p5: 0.0592 - p10: 0.0365 - val_loss: 7.1167 - val_r1: 0.0724 - val_r5: 0.1467 - val_r10: 0.1916 - val_p5: 0.0293 - val_p10: 0.0192 - lr: 4.9852e-04 - 151s/epoch - 119ms/step
Epoch 4/1000
1266/1266 - 151s - loss: 5.1700 - r1: 0.1767 - r5: 0.3185 - r10: 0.3892 - p5: 0.0637 - p10: 0.0389 - val_loss: 7.0976 - val_r1: 0.0704 - val_r5: 0.1481 - val_r10: 0.1968 - val_p5: 0.0296 - val_p10: 0.0197 - lr: 4.9802e-04 - 151s/epoch - 119ms/step
Epoch 5/1000
1266/1266 - 150s - loss: 5.0545 - r1: 0.1880 - r5: 0.3348 - r10: 0.4066 - p5: 0.0669 - p10: 0.0407 - val_loss: 6.9773 - val_r1: 0.0786 - val_r5: 0.1649 - val_r10: 0.2154 - val_p5: 0.0330 - val_p10: 0.0215 - lr: 4.9753e-04 - 150s/epoch - 119ms/step
Epoch 6/1000
1266/1266 - 151s - loss: 4.9627 - r1: 0.1973 - r5: 0.3482 - r10: 0.4210 - p5: 0.0696 - p10: 0.0421 - val_loss: 6.6430 - val_r1: 0.0893 - val_r5: 0.1847 - val_r10: 0.2390 - val_p5: 0.0369 - val_p10: 0.0239 - lr: 4.9703e-04 - 151s/epoch - 119ms/step
Epoch 7/1000
1266/1266 - 151s - loss: 4.8864 - r1: 0.2044 - r5: 0.3581 - r10: 0.4321 - p5: 0.0716 - p10: 0.0432 - val_loss: 6.7582 - val_r1: 0.0909 - val_r5: 0.1831 - val_r10: 0.2366 - val_p5: 0.0366 - val_p10: 0.0237 - lr: 4.9654e-04 - 151s/epoch - 119ms/step
Epoch 8/1000
1266/1266 - 150s - loss: 4.8261 - r1: 0.2107 - r5: 0.3673 - r10: 0.4407 - p5: 0.0734 - p10: 0.0441 - val_loss: 6.4717 - val_r1: 0.1055 - val_r5: 0.2065 - val_r10: 0.2638 - val_p5: 0.0413 - val_p10: 0.0264 - lr: 4.9604e-04 - 150s/epoch - 119ms/step
Epoch 9/1000
1266/1266 - 151s - loss: 4.7668 - r1: 0.2167 - r5: 0.3752 - r10: 0.4494 - p5: 0.0750 - p10: 0.0449 - val_loss: 6.5623 - val_r1: 0.0988 - val_r5: 0.2023 - val_r10: 0.2598 - val_p5: 0.0404 - val_p10: 0.0260 - lr: 4.9555e-04 - 151s/epoch - 119ms/step
Epoch 10/1000
1266/1266 - 150s - loss: 4.7181 - r1: 0.2215 - r5: 0.3820 - r10: 0.4569 - p5: 0.0764 - p10: 0.0457 - val_loss: 6.6372 - val_r1: 0.0980 - val_r5: 0.1948 - val_r10: 0.2510 - val_p5: 0.0389 - val_p10: 0.0251 - lr: 4.9505e-04 - 150s/epoch - 119ms/step
Epoch 11/1000
1266/1266 - 151s - loss: 4.6766 - r1: 0.2253 - r5: 0.3881 - r10: 0.4635 - p5: 0.0776 - p10: 0.0463 - val_loss: 6.3880 - val_r1: 0.1085 - val_r5: 0.2191 - val_r10: 0.2783 - val_p5: 0.0438 - val_p10: 0.0278 - lr: 4.9456e-04 - 151s/epoch - 119ms/step
Epoch 12/1000
1266/1266 - 151s - loss: 4.6338 - r1: 0.2295 - r5: 0.3941 - r10: 0.4698 - p5: 0.0788 - p10: 0.0470 - val_loss: 6.4548 - val_r1: 0.1063 - val_r5: 0.2115 - val_r10: 0.2712 - val_p5: 0.0423 - val_p10: 0.0271 - lr: 4.9406e-04 - 151s/epoch - 119ms/step
Epoch 13/1000
1266/1266 - 150s - loss: 4.6015 - r1: 0.2335 - r5: 0.3988 - r10: 0.4741 - p5: 0.0798 - p10: 0.0474 - val_loss: 6.5078 - val_r1: 0.1049 - val_r5: 0.2086 - val_r10: 0.2676 - val_p5: 0.0417 - val_p10: 0.0268 - lr: 4.9357e-04 - 150s/epoch - 119ms/step
Epoch 14/1000
1266/1266 - 151s - loss: 4.5664 - r1: 0.2374 - r5: 0.4034 - r10: 0.4792 - p5: 0.0807 - p10: 0.0479 - val_loss: 6.3394 - val_r1: 0.1140 - val_r5: 0.2214 - val_r10: 0.2819 - val_p5: 0.0443 - val_p10: 0.0282 - lr: 4.9307e-04 - 151s/epoch - 120ms/step
Epoch 15/1000
1266/1266 - 152s - loss: 4.5347 - r1: 0.2402 - r5: 0.4086 - r10: 0.4842 - p5: 0.0817 - p10: 0.0484 - val_loss: 6.1877 - val_r1: 0.1237 - val_r5: 0.2352 - val_r10: 0.2973 - val_p5: 0.0470 - val_p10: 0.0297 - lr: 4.9258e-04 - 152s/epoch - 120ms/step
Epoch 16/1000
1266/1266 - 151s - loss: 4.5072 - r1: 0.2433 - r5: 0.4122 - r10: 0.4882 - p5: 0.0824 - p10: 0.0488 - val_loss: 6.1338 - val_r1: 0.1285 - val_r5: 0.2432 - val_r10: 0.3046 - val_p5: 0.0486 - val_p10: 0.0305 - lr: 4.9208e-04 - 151s/epoch - 120ms/step
Epoch 17/1000
1266/1266 - 150s - loss: 4.4815 - r1: 0.2454 - r5: 0.4159 - r10: 0.4924 - p5: 0.0832 - p10: 0.0492 - val_loss: 6.3384 - val_r1: 0.1157 - val_r5: 0.2248 - val_r10: 0.2872 - val_p5: 0.0450 - val_p10: 0.0287 - lr: 4.9159e-04 - 150s/epoch - 119ms/step
Epoch 18/1000
1266/1266 - 152s - loss: 4.4594 - r1: 0.2480 - r5: 0.4184 - r10: 0.4953 - p5: 0.0837 - p10: 0.0495 - val_loss: 6.1097 - val_r1: 0.1299 - val_r5: 0.2436 - val_r10: 0.3059 - val_p5: 0.0487 - val_p10: 0.0306 - lr: 4.9109e-04 - 152s/epoch - 120ms/step
Epoch 19/1000
1266/1266 - 151s - loss: 4.4374 - r1: 0.2506 - r5: 0.4227 - r10: 0.4990 - p5: 0.0845 - p10: 0.0499 - val_loss: 6.0005 - val_r1: 0.1373 - val_r5: 0.2551 - val_r10: 0.3177 - val_p5: 0.0510 - val_p10: 0.0318 - lr: 4.9060e-04 - 151s/epoch - 120ms/step
Epoch 20/1000
1266/1266 - 151s - loss: 4.4135 - r1: 0.2538 - r5: 0.4261 - r10: 0.5022 - p5: 0.0852 - p10: 0.0502 - val_loss: 5.9455 - val_r1: 0.1417 - val_r5: 0.2595 - val_r10: 0.3215 - val_p5: 0.0519 - val_p10: 0.0321 - lr: 4.9010e-04 - 151s/epoch - 119ms/step
Epoch 21/1000
1266/1266 - 151s - loss: 4.4011 - r1: 0.2545 - r5: 0.4271 - r10: 0.5034 - p5: 0.0854 - p10: 0.0503 - val_loss: 5.8836 - val_r1: 0.1455 - val_r5: 0.2655 - val_r10: 0.3282 - val_p5: 0.0531 - val_p10: 0.0328 - lr: 4.8961e-04 - 151s/epoch - 120ms/step
Epoch 22/1000
1266/1266 - 150s - loss: 4.3804 - r1: 0.2566 - r5: 0.4303 - r10: 0.5068 - p5: 0.0861 - p10: 0.0507 - val_loss: 5.9186 - val_r1: 0.1443 - val_r5: 0.2626 - val_r10: 0.3282 - val_p5: 0.0525 - val_p10: 0.0328 - lr: 4.8911e-04 - 150s/epoch - 119ms/step
Epoch 23/1000
1266/1266 - 150s - loss: 4.3688 - r1: 0.2581 - r5: 0.4317 - r10: 0.5087 - p5: 0.0863 - p10: 0.0509 - val_loss: 5.9887 - val_r1: 0.1381 - val_r5: 0.2558 - val_r10: 0.3199 - val_p5: 0.0512 - val_p10: 0.0320 - lr: 4.8862e-04 - 150s/epoch - 119ms/step
Epoch 24/1000
1266/1266 - 150s - loss: 4.3485 - r1: 0.2605 - r5: 0.4352 - r10: 0.5113 - p5: 0.0870 - p10: 0.0511 - val_loss: 5.8909 - val_r1: 0.1458 - val_r5: 0.2665 - val_r10: 0.3313 - val_p5: 0.0533 - val_p10: 0.0331 - lr: 4.8812e-04 - 150s/epoch - 119ms/step
Epoch 25/1000
1266/1266 - 151s - loss: 4.3340 - r1: 0.2609 - r5: 0.4370 - r10: 0.5134 - p5: 0.0874 - p10: 0.0513 - val_loss: 5.8307 - val_r1: 0.1473 - val_r5: 0.2712 - val_r10: 0.3366 - val_p5: 0.0542 - val_p10: 0.0337 - lr: 4.8763e-04 - 151s/epoch - 120ms/step
Epoch 26/1000
1266/1266 - 151s - loss: 4.3200 - r1: 0.2631 - r5: 0.4393 - r10: 0.5157 - p5: 0.0879 - p10: 0.0516 - val_loss: 5.7746 - val_r1: 0.1525 - val_r5: 0.2773 - val_r10: 0.3431 - val_p5: 0.0555 - val_p10: 0.0343 - lr: 4.8713e-04 - 151s/epoch - 120ms/step
Epoch 27/1000
1266/1266 - 151s - loss: 4.3087 - r1: 0.2646 - r5: 0.4407 - r10: 0.5171 - p5: 0.0881 - p10: 0.0517 - val_loss: 5.8714 - val_r1: 0.1449 - val_r5: 0.2685 - val_r10: 0.3323 - val_p5: 0.0537 - val_p10: 0.0332 - lr: 4.8664e-04 - 151s/epoch - 119ms/step
Epoch 28/1000
1266/1266 - 151s - loss: 4.3013 - r1: 0.2654 - r5: 0.4416 - r10: 0.5181 - p5: 0.0883 - p10: 0.0518 - val_loss: 5.6818 - val_r1: 0.1609 - val_r5: 0.2883 - val_r10: 0.3524 - val_p5: 0.0577 - val_p10: 0.0352 - lr: 4.8614e-04 - 151s/epoch - 120ms/step
Epoch 29/1000
1266/1266 - 150s - loss: 4.2829 - r1: 0.2677 - r5: 0.4444 - r10: 0.5203 - p5: 0.0889 - p10: 0.0520 - val_loss: 5.7175 - val_r1: 0.1583 - val_r5: 0.2846 - val_r10: 0.3495 - val_p5: 0.0569 - val_p10: 0.0349 - lr: 4.8565e-04 - 150s/epoch - 119ms/step
Epoch 30/1000
1266/1266 - 150s - loss: 4.2769 - r1: 0.2678 - r5: 0.4455 - r10: 0.5219 - p5: 0.0891 - p10: 0.0522 - val_loss: 5.8436 - val_r1: 0.1475 - val_r5: 0.2700 - val_r10: 0.3350 - val_p5: 0.0540 - val_p10: 0.0335 - lr: 4.8515e-04 - 150s/epoch - 119ms/step
Epoch 31/1000
1266/1266 - 151s - loss: 4.2611 - r1: 0.2696 - r5: 0.4471 - r10: 0.5249 - p5: 0.0894 - p10: 0.0525 - val_loss: 5.6270 - val_r1: 0.1627 - val_r5: 0.2911 - val_r10: 0.3576 - val_p5: 0.0582 - val_p10: 0.0358 - lr: 4.8466e-04 - 151s/epoch - 120ms/step
Epoch 32/1000
1266/1266 - 150s - loss: 4.2536 - r1: 0.2710 - r5: 0.4482 - r10: 0.5249 - p5: 0.0896 - p10: 0.0525 - val_loss: 5.7035 - val_r1: 0.1594 - val_r5: 0.2856 - val_r10: 0.3524 - val_p5: 0.0571 - val_p10: 0.0352 - lr: 4.8416e-04 - 150s/epoch - 119ms/step
Epoch 33/1000
1266/1266 - 150s - loss: 4.2427 - r1: 0.2718 - r5: 0.4504 - r10: 0.5270 - p5: 0.0901 - p10: 0.0527 - val_loss: 5.8224 - val_r1: 0.1503 - val_r5: 0.2741 - val_r10: 0.3390 - val_p5: 0.0548 - val_p10: 0.0339 - lr: 4.8367e-04 - 150s/epoch - 119ms/step
Epoch 34/1000
1266/1266 - 150s - loss: 4.2350 - r1: 0.2723 - r5: 0.4510 - r10: 0.5278 - p5: 0.0902 - p10: 0.0528 - val_loss: 5.6625 - val_r1: 0.1603 - val_r5: 0.2893 - val_r10: 0.3566 - val_p5: 0.0579 - val_p10: 0.0357 - lr: 4.8317e-04 - 150s/epoch - 119ms/step
Epoch 35/1000
1266/1266 - 151s - loss: 4.2219 - r1: 0.2737 - r5: 0.4529 - r10: 0.5298 - p5: 0.0906 - p10: 0.0530 - val_loss: 5.6148 - val_r1: 0.1644 - val_r5: 0.2956 - val_r10: 0.3626 - val_p5: 0.0591 - val_p10: 0.0363 - lr: 4.8268e-04 - 151s/epoch - 119ms/step
Epoch 36/1000
1266/1266 - 151s - loss: 4.2110 - r1: 0.2757 - r5: 0.4552 - r10: 0.5314 - p5: 0.0910 - p10: 0.0531 - val_loss: 5.8562 - val_r1: 0.1481 - val_r5: 0.2718 - val_r10: 0.3384 - val_p5: 0.0544 - val_p10: 0.0338 - lr: 4.8218e-04 - 151s/epoch - 119ms/step
Epoch 37/1000
1266/1266 - 150s - loss: 4.2111 - r1: 0.2747 - r5: 0.4547 - r10: 0.5312 - p5: 0.0909 - p10: 0.0531 - val_loss: 5.6750 - val_r1: 0.1591 - val_r5: 0.2873 - val_r10: 0.3546 - val_p5: 0.0575 - val_p10: 0.0355 - lr: 4.8169e-04 - 150s/epoch - 119ms/step
Epoch 38/1000
1266/1266 - 151s - loss: 4.1988 - r1: 0.2769 - r5: 0.4563 - r10: 0.5334 - p5: 0.0913 - p10: 0.0533 - val_loss: 5.5111 - val_r1: 0.1728 - val_r5: 0.3046 - val_r10: 0.3729 - val_p5: 0.0609 - val_p10: 0.0373 - lr: 4.8119e-04 - 151s/epoch - 120ms/step
Epoch 39/1000
1266/1266 - 151s - loss: 4.1908 - r1: 0.2776 - r5: 0.4579 - r10: 0.5346 - p5: 0.0916 - p10: 0.0535 - val_loss: 5.6764 - val_r1: 0.1593 - val_r5: 0.2892 - val_r10: 0.3546 - val_p5: 0.0578 - val_p10: 0.0355 - lr: 4.8070e-04 - 151s/epoch - 119ms/step
Epoch 40/1000
1266/1266 - 150s - loss: 4.1848 - r1: 0.2781 - r5: 0.4591 - r10: 0.5357 - p5: 0.0918 - p10: 0.0536 - val_loss: 5.6673 - val_r1: 0.1626 - val_r5: 0.2907 - val_r10: 0.3575 - val_p5: 0.0582 - val_p10: 0.0357 - lr: 4.8020e-04 - 150s/epoch - 119ms/step
Epoch 41/1000
1266/1266 - 150s - loss: 4.1734 - r1: 0.2797 - r5: 0.4595 - r10: 0.5364 - p5: 0.0919 - p10: 0.0536 - val_loss: 5.6355 - val_r1: 0.1654 - val_r5: 0.2953 - val_r10: 0.3609 - val_p5: 0.0591 - val_p10: 0.0361 - lr: 4.7971e-04 - 150s/epoch - 119ms/step
Epoch 42/1000
1266/1266 - 151s - loss: 4.1670 - r1: 0.2803 - r5: 0.4611 - r10: 0.5378 - p5: 0.0922 - p10: 0.0538 - val_loss: 5.8253 - val_r1: 0.1536 - val_r5: 0.2785 - val_r10: 0.3437 - val_p5: 0.0557 - val_p10: 0.0344 - lr: 4.7921e-04 - 151s/epoch - 119ms/step
Epoch 43/1000
1266/1266 - 150s - loss: 4.1646 - r1: 0.2811 - r5: 0.4610 - r10: 0.5378 - p5: 0.0922 - p10: 0.0538 - val_loss: 5.9241 - val_r1: 0.1477 - val_r5: 0.2717 - val_r10: 0.3361 - val_p5: 0.0543 - val_p10: 0.0336 - lr: 4.7872e-04 - 150s/epoch - 119ms/step
Epoch 44/1000
1266/1266 - 150s - loss: 4.1580 - r1: 0.2810 - r5: 0.4622 - r10: 0.5388 - p5: 0.0924 - p10: 0.0539 - val_loss: 5.5724 - val_r1: 0.1718 - val_r5: 0.3024 - val_r10: 0.3699 - val_p5: 0.0605 - val_p10: 0.0370 - lr: 4.7822e-04 - 150s/epoch - 119ms/step
Epoch 45/1000
1266/1266 - 150s - loss: 4.1522 - r1: 0.2818 - r5: 0.4629 - r10: 0.5399 - p5: 0.0926 - p10: 0.0540 - val_loss: 5.7885 - val_r1: 0.1565 - val_r5: 0.2820 - val_r10: 0.3477 - val_p5: 0.0564 - val_p10: 0.0348 - lr: 4.7773e-04 - 150s/epoch - 119ms/step
Epoch 46/1000
1266/1266 - 150s - loss: 4.1481 - r1: 0.2812 - r5: 0.4639 - r10: 0.5406 - p5: 0.0928 - p10: 0.0541 - val_loss: 5.8980 - val_r1: 0.1476 - val_r5: 0.2708 - val_r10: 0.3363 - val_p5: 0.0542 - val_p10: 0.0336 - lr: 4.7723e-04 - 150s/epoch - 119ms/step
Epoch 47/1000
1266/1266 - 150s - loss: 4.1411 - r1: 0.2828 - r5: 0.4643 - r10: 0.5412 - p5: 0.0929 - p10: 0.0541 - val_loss: 5.5537 - val_r1: 0.1731 - val_r5: 0.3031 - val_r10: 0.3702 - val_p5: 0.0606 - val_p10: 0.0370 - lr: 4.7674e-04 - 150s/epoch - 119ms/step
Epoch 48/1000
1266/1266 - 150s - loss: 4.1344 - r1: 0.2844 - r5: 0.4663 - r10: 0.5426 - p5: 0.0933 - p10: 0.0543 - val_loss: 5.6699 - val_r1: 0.1644 - val_r5: 0.2913 - val_r10: 0.3588 - val_p5: 0.0583 - val_p10: 0.0359 - lr: 4.7624e-04 - 150s/epoch - 119ms/step
Epoch 49/1000
1266/1266 - 151s - loss: 4.1306 - r1: 0.2848 - r5: 0.4660 - r10: 0.5427 - p5: 0.0932 - p10: 0.0543 - val_loss: 5.7969 - val_r1: 0.1556 - val_r5: 0.2817 - val_r10: 0.3469 - val_p5: 0.0563 - val_p10: 0.0347 - lr: 4.7575e-04 - 151s/epoch - 119ms/step
Epoch 50/1000
1266/1266 - 150s - loss: 4.1295 - r1: 0.2844 - r5: 0.4663 - r10: 0.5432 - p5: 0.0933 - p10: 0.0543 - val_loss: 5.5808 - val_r1: 0.1696 - val_r5: 0.3015 - val_r10: 0.3684 - val_p5: 0.0603 - val_p10: 0.0368 - lr: 4.7525e-04 - 150s/epoch - 119ms/step
Epoch 51/1000
1266/1266 - 151s - loss: 4.1183 - r1: 0.2861 - r5: 0.4682 - r10: 0.5447 - p5: 0.0936 - p10: 0.0545 - val_loss: 5.4989 - val_r1: 0.1778 - val_r5: 0.3098 - val_r10: 0.3771 - val_p5: 0.0620 - val_p10: 0.0377 - lr: 4.7476e-04 - 151s/epoch - 120ms/step
Epoch 52/1000
1266/1266 - 150s - loss: 4.1163 - r1: 0.2858 - r5: 0.4679 - r10: 0.5449 - p5: 0.0936 - p10: 0.0545 - val_loss: 5.6996 - val_r1: 0.1624 - val_r5: 0.2921 - val_r10: 0.3569 - val_p5: 0.0584 - val_p10: 0.0357 - lr: 4.7426e-04 - 150s/epoch - 119ms/step
Epoch 53/1000
1266/1266 - 150s - loss: 4.1129 - r1: 0.2860 - r5: 0.4685 - r10: 0.5455 - p5: 0.0937 - p10: 0.0546 - val_loss: 5.9305 - val_r1: 0.1459 - val_r5: 0.2682 - val_r10: 0.3345 - val_p5: 0.0536 - val_p10: 0.0334 - lr: 4.7377e-04 - 150s/epoch - 119ms/step
Epoch 54/1000
1266/1266 - 151s - loss: 4.1034 - r1: 0.2869 - r5: 0.4694 - r10: 0.5465 - p5: 0.0939 - p10: 0.0547 - val_loss: 5.4914 - val_r1: 0.1773 - val_r5: 0.3102 - val_r10: 0.3790 - val_p5: 0.0621 - val_p10: 0.0379 - lr: 4.7327e-04 - 151s/epoch - 120ms/step
Epoch 55/1000
1266/1266 - 150s - loss: 4.1001 - r1: 0.2884 - r5: 0.4701 - r10: 0.5467 - p5: 0.0940 - p10: 0.0547 - val_loss: 5.5326 - val_r1: 0.1732 - val_r5: 0.3077 - val_r10: 0.3755 - val_p5: 0.0615 - val_p10: 0.0375 - lr: 4.7278e-04 - 150s/epoch - 119ms/step
Epoch 56/1000
1266/1266 - 150s - loss: 4.0973 - r1: 0.2882 - r5: 0.4710 - r10: 0.5483 - p5: 0.0942 - p10: 0.0548 - val_loss: 5.7401 - val_r1: 0.1598 - val_r5: 0.2873 - val_r10: 0.3541 - val_p5: 0.0574 - val_p10: 0.0354 - lr: 4.7228e-04 - 150s/epoch - 119ms/step
Epoch 57/1000
1266/1266 - 150s - loss: 4.0964 - r1: 0.2878 - r5: 0.4709 - r10: 0.5474 - p5: 0.0942 - p10: 0.0547 - val_loss: 5.5869 - val_r1: 0.1718 - val_r5: 0.3014 - val_r10: 0.3686 - val_p5: 0.0603 - val_p10: 0.0369 - lr: 4.7179e-04 - 150s/epoch - 119ms/step
Epoch 58/1000
1266/1266 - 151s - loss: 4.0883 - r1: 0.2894 - r5: 0.4721 - r10: 0.5482 - p5: 0.0944 - p10: 0.0548 - val_loss: 5.4734 - val_r1: 0.1801 - val_r5: 0.3142 - val_r10: 0.3816 - val_p5: 0.0628 - val_p10: 0.0382 - lr: 4.7129e-04 - 151s/epoch - 120ms/step
Epoch 59/1000
1266/1266 - 151s - loss: 4.0822 - r1: 0.2898 - r5: 0.4727 - r10: 0.5500 - p5: 0.0945 - p10: 0.0550 - val_loss: 5.9482 - val_r1: 0.1465 - val_r5: 0.2685 - val_r10: 0.3345 - val_p5: 0.0537 - val_p10: 0.0334 - lr: 4.7080e-04 - 151s/epoch - 119ms/step
Epoch 60/1000
1266/1266 - 150s - loss: 4.0795 - r1: 0.2898 - r5: 0.4735 - r10: 0.5503 - p5: 0.0947 - p10: 0.0550 - val_loss: 5.8383 - val_r1: 0.1545 - val_r5: 0.2782 - val_r10: 0.3434 - val_p5: 0.0556 - val_p10: 0.0343 - lr: 4.7030e-04 - 150s/epoch - 119ms/step
Epoch 61/1000
1266/1266 - 151s - loss: 4.0711 - r1: 0.2915 - r5: 0.4741 - r10: 0.5517 - p5: 0.0948 - p10: 0.0552 - val_loss: 5.4659 - val_r1: 0.1803 - val_r5: 0.3141 - val_r10: 0.3799 - val_p5: 0.0628 - val_p10: 0.0380 - lr: 4.6981e-04 - 151s/epoch - 120ms/step
Epoch 62/1000
1266/1266 - 150s - loss: 4.0687 - r1: 0.2915 - r5: 0.4750 - r10: 0.5518 - p5: 0.0950 - p10: 0.0552 - val_loss: 5.7274 - val_r1: 0.1611 - val_r5: 0.2902 - val_r10: 0.3556 - val_p5: 0.0580 - val_p10: 0.0356 - lr: 4.6931e-04 - 150s/epoch - 119ms/step
Epoch 63/1000
1266/1266 - 151s - loss: 4.0664 - r1: 0.2915 - r5: 0.4757 - r10: 0.5518 - p5: 0.0951 - p10: 0.0552 - val_loss: 5.9497 - val_r1: 0.1501 - val_r5: 0.2713 - val_r10: 0.3365 - val_p5: 0.0543 - val_p10: 0.0336 - lr: 4.6882e-04 - 151s/epoch - 119ms/step
Epoch 64/1000
1266/1266 - 150s - loss: 4.0624 - r1: 0.2921 - r5: 0.4758 - r10: 0.5528 - p5: 0.0952 - p10: 0.0553 - val_loss: 5.6754 - val_r1: 0.1665 - val_r5: 0.2945 - val_r10: 0.3610 - val_p5: 0.0589 - val_p10: 0.0361 - lr: 4.6832e-04 - 150s/epoch - 119ms/step
Epoch 65/1000
1266/1266 - 150s - loss: 4.0607 - r1: 0.2925 - r5: 0.4764 - r10: 0.5528 - p5: 0.0953 - p10: 0.0553 - val_loss: 5.5245 - val_r1: 0.1784 - val_r5: 0.3094 - val_r10: 0.3763 - val_p5: 0.0619 - val_p10: 0.0376 - lr: 4.6783e-04 - 150s/epoch - 119ms/step
Epoch 66/1000
1266/1266 - 150s - loss: 4.0528 - r1: 0.2937 - r5: 0.4772 - r10: 0.5536 - p5: 0.0954 - p10: 0.0554 - val_loss: 5.8906 - val_r1: 0.1521 - val_r5: 0.2749 - val_r10: 0.3408 - val_p5: 0.0550 - val_p10: 0.0341 - lr: 4.6733e-04 - 150s/epoch - 119ms/step
Epoch 67/1000
1266/1266 - 150s - loss: 4.0553 - r1: 0.2930 - r5: 0.4770 - r10: 0.5539 - p5: 0.0954 - p10: 0.0554 - val_loss: 5.9286 - val_r1: 0.1509 - val_r5: 0.2746 - val_r10: 0.3386 - val_p5: 0.0549 - val_p10: 0.0339 - lr: 4.6684e-04 - 150s/epoch - 119ms/step
Epoch 68/1000
1266/1266 - 150s - loss: 4.0464 - r1: 0.2943 - r5: 0.4778 - r10: 0.5547 - p5: 0.0956 - p10: 0.0555 - val_loss: 5.6193 - val_r1: 0.1691 - val_r5: 0.2991 - val_r10: 0.3667 - val_p5: 0.0598 - val_p10: 0.0367 - lr: 4.6634e-04 - 150s/epoch - 119ms/step
Epoch 69/1000
1266/1266 - 150s - loss: 4.0442 - r1: 0.2944 - r5: 0.4779 - r10: 0.5546 - p5: 0.0956 - p10: 0.0555 - val_loss: 5.6634 - val_r1: 0.1670 - val_r5: 0.2959 - val_r10: 0.3627 - val_p5: 0.0592 - val_p10: 0.0363 - lr: 4.6585e-04 - 150s/epoch - 119ms/step
Epoch 70/1000
1266/1266 - 150s - loss: 4.0450 - r1: 0.2944 - r5: 0.4788 - r10: 0.5558 - p5: 0.0958 - p10: 0.0556 - val_loss: 6.0029 - val_r1: 0.1430 - val_r5: 0.2659 - val_r10: 0.3296 - val_p5: 0.0532 - val_p10: 0.0330 - lr: 4.6535e-04 - 150s/epoch - 119ms/step
Epoch 71/1000
1266/1266 - 150s - loss: 4.0393 - r1: 0.2953 - r5: 0.4795 - r10: 0.5562 - p5: 0.0959 - p10: 0.0556 - val_loss: 5.8626 - val_r1: 0.1527 - val_r5: 0.2772 - val_r10: 0.3426 - val_p5: 0.0554 - val_p10: 0.0343 - lr: 4.6486e-04 - 150s/epoch - 119ms/step
Epoch 72/1000
1266/1266 - 150s - loss: 4.0350 - r1: 0.2951 - r5: 0.4797 - r10: 0.5566 - p5: 0.0959 - p10: 0.0557 - val_loss: 5.5414 - val_r1: 0.1761 - val_r5: 0.3072 - val_r10: 0.3743 - val_p5: 0.0614 - val_p10: 0.0374 - lr: 4.6436e-04 - 150s/epoch - 119ms/step
Epoch 73/1000
1266/1266 - 150s - loss: 4.0362 - r1: 0.2953 - r5: 0.4799 - r10: 0.5565 - p5: 0.0960 - p10: 0.0556 - val_loss: 5.7056 - val_r1: 0.1620 - val_r5: 0.2922 - val_r10: 0.3587 - val_p5: 0.0584 - val_p10: 0.0359 - lr: 4.6387e-04 - 150s/epoch - 119ms/step
Epoch 74/1000
1266/1266 - 151s - loss: 4.0287 - r1: 0.2963 - r5: 0.4807 - r10: 0.5572 - p5: 0.0961 - p10: 0.0557 - val_loss: 5.9770 - val_r1: 0.1474 - val_r5: 0.2690 - val_r10: 0.3355 - val_p5: 0.0538 - val_p10: 0.0335 - lr: 4.6337e-04 - 151s/epoch - 119ms/step
Epoch 75/1000
1266/1266 - 150s - loss: 4.0274 - r1: 0.2961 - r5: 0.4800 - r10: 0.5575 - p5: 0.0960 - p10: 0.0558 - val_loss: 5.9322 - val_r1: 0.1516 - val_r5: 0.2736 - val_r10: 0.3389 - val_p5: 0.0547 - val_p10: 0.0339 - lr: 4.6288e-04 - 150s/epoch - 119ms/step
Epoch 76/1000
1266/1266 - 150s - loss: 4.0229 - r1: 0.2966 - r5: 0.4815 - r10: 0.5587 - p5: 0.0963 - p10: 0.0559 - val_loss: 5.5404 - val_r1: 0.1762 - val_r5: 0.3082 - val_r10: 0.3755 - val_p5: 0.0616 - val_p10: 0.0375 - lr: 4.6238e-04 - 150s/epoch - 119ms/step
Epoch 77/1000
1266/1266 - 150s - loss: 4.0212 - r1: 0.2975 - r5: 0.4821 - r10: 0.5583 - p5: 0.0964 - p10: 0.0558 - val_loss: 5.7742 - val_r1: 0.1591 - val_r5: 0.2874 - val_r10: 0.3538 - val_p5: 0.0575 - val_p10: 0.0354 - lr: 4.6189e-04 - 150s/epoch - 119ms/step
Epoch 78/1000
1266/1266 - 150s - loss: 4.0192 - r1: 0.2980 - r5: 0.4820 - r10: 0.5590 - p5: 0.0964 - p10: 0.0559 - val_loss: 6.0602 - val_r1: 0.1449 - val_r5: 0.2647 - val_r10: 0.3284 - val_p5: 0.0529 - val_p10: 0.0328 - lr: 4.6139e-04 - 150s/epoch - 119ms/step
Epoch 79/1000
1266/1266 - 150s - loss: 4.0170 - r1: 0.2975 - r5: 0.4826 - r10: 0.5591 - p5: 0.0965 - p10: 0.0559 - val_loss: 5.8076 - val_r1: 0.1573 - val_r5: 0.2840 - val_r10: 0.3494 - val_p5: 0.0568 - val_p10: 0.0349 - lr: 4.6090e-04 - 150s/epoch - 119ms/step
Epoch 80/1000
1266/1266 - 150s - loss: 4.0086 - r1: 0.2985 - r5: 0.4834 - r10: 0.5601 - p5: 0.0967 - p10: 0.0560 - val_loss: 5.5214 - val_r1: 0.1776 - val_r5: 0.3100 - val_r10: 0.3777 - val_p5: 0.0620 - val_p10: 0.0378 - lr: 4.6040e-04 - 150s/epoch - 119ms/step
Epoch 81/1000
1266/1266 - 150s - loss: 4.0080 - r1: 0.2989 - r5: 0.4840 - r10: 0.5605 - p5: 0.0968 - p10: 0.0560 - val_loss: 5.6652 - val_r1: 0.1665 - val_r5: 0.2975 - val_r10: 0.3649 - val_p5: 0.0595 - val_p10: 0.0365 - lr: 4.5991e-04 - 150s/epoch - 119ms/step
Epoch 82/1000
1266/1266 - 151s - loss: 4.0079 - r1: 0.2989 - r5: 0.4835 - r10: 0.5601 - p5: 0.0967 - p10: 0.0560 - val_loss: 6.0124 - val_r1: 0.1443 - val_r5: 0.2678 - val_r10: 0.3321 - val_p5: 0.0536 - val_p10: 0.0332 - lr: 4.5941e-04 - 151s/epoch - 119ms/step
Epoch 83/1000
1266/1266 - 150s - loss: 4.0077 - r1: 0.2991 - r5: 0.4834 - r10: 0.5603 - p5: 0.0967 - p10: 0.0560 - val_loss: 5.8665 - val_r1: 0.1549 - val_r5: 0.2803 - val_r10: 0.3457 - val_p5: 0.0561 - val_p10: 0.0346 - lr: 4.5892e-04 - 150s/epoch - 119ms/step
Epoch 84/1000
1266/1266 - 151s - loss: 3.9982 - r1: 0.3001 - r5: 0.4854 - r10: 0.5623 - p5: 0.0971 - p10: 0.0562 - val_loss: 5.6533 - val_r1: 0.1689 - val_r5: 0.2987 - val_r10: 0.3652 - val_p5: 0.0597 - val_p10: 0.0365 - lr: 4.5842e-04 - 151s/epoch - 119ms/step
Epoch 85/1000
1266/1266 - 151s - loss: 3.9980 - r1: 0.2992 - r5: 0.4855 - r10: 0.5623 - p5: 0.0971 - p10: 0.0562 - val_loss: 5.6150 - val_r1: 0.1728 - val_r5: 0.3031 - val_r10: 0.3689 - val_p5: 0.0606 - val_p10: 0.0369 - lr: 4.5793e-04 - 151s/epoch - 119ms/step
Epoch 86/1000
1266/1266 - 151s - loss: 3.9947 - r1: 0.2999 - r5: 0.4859 - r10: 0.5625 - p5: 0.0972 - p10: 0.0563 - val_loss: 6.0295 - val_r1: 0.1447 - val_r5: 0.2676 - val_r10: 0.3322 - val_p5: 0.0535 - val_p10: 0.0332 - lr: 4.5743e-04 - 151s/epoch - 119ms/step
Epoch 87/1000
1266/1266 - 151s - loss: 3.9940 - r1: 0.3005 - r5: 0.4859 - r10: 0.5628 - p5: 0.0972 - p10: 0.0563 - val_loss: 5.7775 - val_r1: 0.1597 - val_r5: 0.2871 - val_r10: 0.3540 - val_p5: 0.0574 - val_p10: 0.0354 - lr: 4.5694e-04 - 151s/epoch - 119ms/step
Epoch 88/1000
1266/1266 - 150s - loss: 3.9901 - r1: 0.3009 - r5: 0.4862 - r10: 0.5628 - p5: 0.0972 - p10: 0.0563 - val_loss: 5.6347 - val_r1: 0.1698 - val_r5: 0.3012 - val_r10: 0.3673 - val_p5: 0.0602 - val_p10: 0.0367 - lr: 4.5644e-04 - 150s/epoch - 119ms/step
Epoch 89/1000
1266/1266 - 151s - loss: 3.9893 - r1: 0.3017 - r5: 0.4864 - r10: 0.5629 - p5: 0.0973 - p10: 0.0563 - val_loss: 5.6389 - val_r1: 0.1676 - val_r5: 0.2994 - val_r10: 0.3662 - val_p5: 0.0599 - val_p10: 0.0366 - lr: 4.5595e-04 - 151s/epoch - 119ms/step
Epoch 90/1000
1266/1266 - 151s - loss: 3.9860 - r1: 0.3020 - r5: 0.4866 - r10: 0.5632 - p5: 0.0973 - p10: 0.0563 - val_loss: 5.9514 - val_r1: 0.1492 - val_r5: 0.2748 - val_r10: 0.3408 - val_p5: 0.0550 - val_p10: 0.0341 - lr: 4.5545e-04 - 151s/epoch - 119ms/step
Epoch 91/1000
1266/1266 - 151s - loss: 3.9839 - r1: 0.3012 - r5: 0.4869 - r10: 0.5637 - p5: 0.0974 - p10: 0.0564 - val_loss: 5.8803 - val_r1: 0.1549 - val_r5: 0.2806 - val_r10: 0.3447 - val_p5: 0.0561 - val_p10: 0.0345 - lr: 4.5496e-04 - 151s/epoch - 119ms/step
Epoch 92/1000
1266/1266 - 151s - loss: 3.9824 - r1: 0.3016 - r5: 0.4873 - r10: 0.5637 - p5: 0.0975 - p10: 0.0564 - val_loss: 5.7220 - val_r1: 0.1644 - val_r5: 0.2937 - val_r10: 0.3596 - val_p5: 0.0587 - val_p10: 0.0360 - lr: 4.5446e-04 - 151s/epoch - 119ms/step
Epoch 93/1000
1266/1266 - 151s - loss: 3.9777 - r1: 0.3024 - r5: 0.4883 - r10: 0.5647 - p5: 0.0977 - p10: 0.0565 - val_loss: 5.6606 - val_r1: 0.1694 - val_r5: 0.2987 - val_r10: 0.3657 - val_p5: 0.0597 - val_p10: 0.0366 - lr: 4.5397e-04 - 151s/epoch - 119ms/step
Epoch 94/1000
1266/1266 - 150s - loss: 3.9786 - r1: 0.3025 - r5: 0.4881 - r10: 0.5646 - p5: 0.0976 - p10: 0.0565 - val_loss: 5.7356 - val_r1: 0.1648 - val_r5: 0.2942 - val_r10: 0.3592 - val_p5: 0.0588 - val_p10: 0.0359 - lr: 4.5347e-04 - 150s/epoch - 119ms/step
Epoch 95/1000
1266/1266 - 150s - loss: 3.9750 - r1: 0.3024 - r5: 0.4884 - r10: 0.5652 - p5: 0.0977 - p10: 0.0565 - val_loss: 5.7854 - val_r1: 0.1623 - val_r5: 0.2902 - val_r10: 0.3544 - val_p5: 0.0580 - val_p10: 0.0354 - lr: 4.5298e-04 - 150s/epoch - 119ms/step
Epoch 96/1000
1266/1266 - 151s - loss: 3.9709 - r1: 0.3031 - r5: 0.4888 - r10: 0.5653 - p5: 0.0978 - p10: 0.0565 - val_loss: 5.6681 - val_r1: 0.1675 - val_r5: 0.2995 - val_r10: 0.3650 - val_p5: 0.0599 - val_p10: 0.0365 - lr: 4.5248e-04 - 151s/epoch - 119ms/step
Epoch 97/1000
1266/1266 - 150s - loss: 3.9662 - r1: 0.3039 - r5: 0.4901 - r10: 0.5661 - p5: 0.0980 - p10: 0.0566 - val_loss: 5.5240 - val_r1: 0.1794 - val_r5: 0.3131 - val_r10: 0.3813 - val_p5: 0.0626 - val_p10: 0.0381 - lr: 4.5199e-04 - 150s/epoch - 119ms/step
Epoch 98/1000
1266/1266 - 150s - loss: 3.9679 - r1: 0.3037 - r5: 0.4898 - r10: 0.5662 - p5: 0.0980 - p10: 0.0566 - val_loss: 5.7662 - val_r1: 0.1599 - val_r5: 0.2891 - val_r10: 0.3556 - val_p5: 0.0578 - val_p10: 0.0356 - lr: 4.5149e-04 - 150s/epoch - 119ms/step
Epoch 99/1000
1266/1266 - 150s - loss: 3.9676 - r1: 0.3038 - r5: 0.4894 - r10: 0.5659 - p5: 0.0979 - p10: 0.0566 - val_loss: 5.9197 - val_r1: 0.1514 - val_r5: 0.2757 - val_r10: 0.3402 - val_p5: 0.0551 - val_p10: 0.0340 - lr: 4.5100e-04 - 150s/epoch - 119ms/step
Epoch 100/1000
1266/1266 - 151s - loss: 3.9663 - r1: 0.3036 - r5: 0.4897 - r10: 0.5661 - p5: 0.0979 - p10: 0.0566 - val_loss: 5.6390 - val_r1: 0.1712 - val_r5: 0.3007 - val_r10: 0.3672 - val_p5: 0.0601 - val_p10: 0.0367 - lr: 4.5050e-04 - 151s/epoch - 119ms/step
Epoch 101/1000
1266/1266 - 151s - loss: 3.9619 - r1: 0.3032 - r5: 0.4901 - r10: 0.5663 - p5: 0.0980 - p10: 0.0566 - val_loss: 5.6023 - val_r1: 0.1731 - val_r5: 0.3045 - val_r10: 0.3714 - val_p5: 0.0609 - val_p10: 0.0371 - lr: 4.5001e-04 - 151s/epoch - 119ms/step
Epoch 102/1000
1266/1266 - 151s - loss: 3.9582 - r1: 0.3049 - r5: 0.4901 - r10: 0.5669 - p5: 0.0980 - p10: 0.0567 - val_loss: 5.7545 - val_r1: 0.1628 - val_r5: 0.2925 - val_r10: 0.3575 - val_p5: 0.0585 - val_p10: 0.0358 - lr: 4.4951e-04 - 151s/epoch - 119ms/step
Epoch 103/1000
1266/1266 - 150s - loss: 3.9594 - r1: 0.3049 - r5: 0.4905 - r10: 0.5668 - p5: 0.0981 - p10: 0.0567 - val_loss: 5.7960 - val_r1: 0.1602 - val_r5: 0.2873 - val_r10: 0.3534 - val_p5: 0.0575 - val_p10: 0.0353 - lr: 4.4902e-04 - 150s/epoch - 119ms/step
Epoch 104/1000
1266/1266 - 150s - loss: 3.9528 - r1: 0.3055 - r5: 0.4917 - r10: 0.5686 - p5: 0.0983 - p10: 0.0569 - val_loss: 5.7225 - val_r1: 0.1651 - val_r5: 0.2951 - val_r10: 0.3611 - val_p5: 0.0590 - val_p10: 0.0361 - lr: 4.4852e-04 - 150s/epoch - 119ms/step
Epoch 105/1000
1266/1266 - 150s - loss: 3.9515 - r1: 0.3052 - r5: 0.4921 - r10: 0.5681 - p5: 0.0984 - p10: 0.0568 - val_loss: 5.6282 - val_r1: 0.1690 - val_r5: 0.3005 - val_r10: 0.3672 - val_p5: 0.0601 - val_p10: 0.0367 - lr: 4.4803e-04 - 150s/epoch - 119ms/step
Epoch 106/1000
1266/1266 - 150s - loss: 3.9508 - r1: 0.3057 - r5: 0.4920 - r10: 0.5682 - p5: 0.0984 - p10: 0.0568 - val_loss: 5.6687 - val_r1: 0.1675 - val_r5: 0.2981 - val_r10: 0.3638 - val_p5: 0.0596 - val_p10: 0.0364 - lr: 4.4753e-04 - 150s/epoch - 119ms/step
Epoch 107/1000
1266/1266 - 150s - loss: 3.9507 - r1: 0.3049 - r5: 0.4920 - r10: 0.5684 - p5: 0.0984 - p10: 0.0568 - val_loss: 5.7453 - val_r1: 0.1622 - val_r5: 0.2910 - val_r10: 0.3572 - val_p5: 0.0582 - val_p10: 0.0357 - lr: 4.4704e-04 - 150s/epoch - 119ms/step
Epoch 108/1000
1266/1266 - 150s - loss: 3.9451 - r1: 0.3061 - r5: 0.4931 - r10: 0.5689 - p5: 0.0986 - p10: 0.0569 - val_loss: 5.7475 - val_r1: 0.1634 - val_r5: 0.2912 - val_r10: 0.3569 - val_p5: 0.0582 - val_p10: 0.0357 - lr: 4.4654e-04 - 150s/epoch - 119ms/step
Epoch 109/1000
1266/1266 - 150s - loss: 3.9459 - r1: 0.3071 - r5: 0.4924 - r10: 0.5690 - p5: 0.0985 - p10: 0.0569 - val_loss: 5.6829 - val_r1: 0.1666 - val_r5: 0.2972 - val_r10: 0.3634 - val_p5: 0.0594 - val_p10: 0.0363 - lr: 4.4605e-04 - 150s/epoch - 119ms/step
Epoch 110/1000
1266/1266 - 151s - loss: 3.9446 - r1: 0.3064 - r5: 0.4926 - r10: 0.5694 - p5: 0.0985 - p10: 0.0569 - val_loss: 5.6487 - val_r1: 0.1702 - val_r5: 0.3018 - val_r10: 0.3664 - val_p5: 0.0604 - val_p10: 0.0366 - lr: 4.4555e-04 - 151s/epoch - 119ms/step
Epoch 111/1000
1266/1266 - 151s - loss: 3.9412 - r1: 0.3069 - r5: 0.4931 - r10: 0.5688 - p5: 0.0986 - p10: 0.0569 - val_loss: 5.8215 - val_r1: 0.1596 - val_r5: 0.2868 - val_r10: 0.3518 - val_p5: 0.0574 - val_p10: 0.0352 - lr: 4.4506e-04 - 151s/epoch - 119ms/step
Epoch 111: early stopping
[92m[INFO] Loading best model...[0m
[93m[WARNING] Model folder already exists...[0m
Model: "ATT2ITM_0"
__________________________________________________________________________________________________
 Layer (type)                   Output Shape         Param #     Connected to                     
==================================================================================================
 input_1 (InputLayer)           [(None, 178)]        0           []                               
                                                                                                  
 input_2 (InputLayer)           [(None, 3415)]       0           []                               
                                                                                                  
 embedding (Embedding)          (None, 178, 384)     5538048     ['input_1[0][0]']                
                                                                                                  
 in_rsts (Embedding)            (None, 3415, 384)    1311360     ['input_2[0][0]']                
                                                                                                  
 dense (Dense)                  (None, 178, 256)     98560       ['embedding[0][0]']              
                                                                                                  
 dense_2 (Dense)                (None, 3415, 256)    98560       ['in_rsts[0][0]']                
                                                                                                  
 tf.math.not_equal (TFOpLambda)  (None, 178)         0           ['input_1[0][0]']                
                                                                                                  
 dense_1 (Dense)                (None, 178, 128)     32896       ['dense[0][0]']                  
                                                                                                  
 dense_3 (Dense)                (None, 3415, 128)    32896       ['dense_2[0][0]']                
                                                                                                  
 tf.cast (TFOpLambda)           (None, 178)          0           ['tf.math.not_equal[0][0]']      
                                                                                                  
 word_emb (Lambda)              (None, 178, 128)     0           ['dense_1[0][0]']                
                                                                                                  
 rest_emb (Lambda)              (None, 3415, 128)    0           ['dense_3[0][0]']                
                                                                                                  
 tf.expand_dims (TFOpLambda)    (None, 178, 1)       0           ['tf.cast[0][0]']                
                                                                                                  
 lambda (Lambda)                (None, 178, 3415)    0           ['word_emb[0][0]',               
                                                                  'rest_emb[0][0]']               
                                                                                                  
 tf.tile (TFOpLambda)           (None, 178, 3415)    0           ['tf.expand_dims[0][0]']         
                                                                                                  
 lambda_1 (Lambda)              (None, 178, 3415)    0           ['lambda[0][0]',                 
                                                                  'tf.tile[0][0]']                
                                                                                                  
 dotprod (Activation)           (None, 178, 3415)    0           ['lambda_1[0][0]']               
                                                                                                  
 dropout (Dropout)              (None, 178, 3415)    0           ['dotprod[0][0]']                
                                                                                                  
 sum (Lambda)                   (None, 3415)         0           ['dropout[0][0]']                
                                                                                                  
 out (Activation)               (None, 3415)         0           ['sum[0][0]']                    
                                                                                                  
==================================================================================================
Total params: 7,112,320
Trainable params: 7,112,320
Non-trainable params: 0
__________________________________________________________________________________________________
None
[92m[INFO] Model already trained. Loading weights...[0m
