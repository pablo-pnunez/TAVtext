Model: "ATT2ITM_0"
__________________________________________________________________________________________________
 Layer (type)                   Output Shape         Param #     Connected to                     
==================================================================================================
 input_1 (InputLayer)           [(None, 172)]        0           []                               
                                                                                                  
 input_2 (InputLayer)           [(None, 1322)]       0           []                               
                                                                                                  
 embedding (Embedding)          (None, 172, 384)     3389952     ['input_1[0][0]']                
                                                                                                  
 in_rsts (Embedding)            (None, 1322, 384)    507648      ['input_2[0][0]']                
                                                                                                  
 dense (Dense)                  (None, 172, 256)     98560       ['embedding[0][0]']              
                                                                                                  
 dense_2 (Dense)                (None, 1322, 256)    98560       ['in_rsts[0][0]']                
                                                                                                  
 tf.math.not_equal (TFOpLambda)  (None, 172)         0           ['input_1[0][0]']                
                                                                                                  
 dense_1 (Dense)                (None, 172, 128)     32896       ['dense[0][0]']                  
                                                                                                  
 dense_3 (Dense)                (None, 1322, 128)    32896       ['dense_2[0][0]']                
                                                                                                  
 tf.cast (TFOpLambda)           (None, 172)          0           ['tf.math.not_equal[0][0]']      
                                                                                                  
 word_emb (Lambda)              (None, 172, 128)     0           ['dense_1[0][0]']                
                                                                                                  
 rest_emb (Lambda)              (None, 1322, 128)    0           ['dense_3[0][0]']                
                                                                                                  
 tf.expand_dims (TFOpLambda)    (None, 172, 1)       0           ['tf.cast[0][0]']                
                                                                                                  
 lambda (Lambda)                (None, 172, 1322)    0           ['word_emb[0][0]',               
                                                                  'rest_emb[0][0]']               
                                                                                                  
 tf.tile (TFOpLambda)           (None, 172, 1322)    0           ['tf.expand_dims[0][0]']         
                                                                                                  
 lambda_1 (Lambda)              (None, 172, 1322)    0           ['lambda[0][0]',                 
                                                                  'tf.tile[0][0]']                
                                                                                                  
 dotprod (Activation)           (None, 172, 1322)    0           ['lambda_1[0][0]']               
                                                                                                  
 dropout (Dropout)              (None, 172, 1322)    0           ['dotprod[0][0]']                
                                                                                                  
 sum (Lambda)                   (None, 1322)         0           ['dropout[0][0]']                
                                                                                                  
 out (Activation)               (None, 1322)         0           ['sum[0][0]']                    
                                                                                                  
==================================================================================================
Total params: 4,160,512
Trainable params: 4,160,512
Non-trainable params: 0
__________________________________________________________________________________________________
None
Epoch 1/1000
63/63 - 25s - loss: 6.6802 - r1: 0.0243 - r5: 0.0672 - r10: 0.0996 - p5: 0.0134 - p10: 0.0100 - val_loss: 5.9039 - val_r1: 0.0897 - val_r5: 0.1969 - val_r10: 0.2665 - val_p5: 0.0394 - val_p10: 0.0267 - lr: 4.9951e-04 - 25s/epoch - 399ms/step
Epoch 2/1000
63/63 - 22s - loss: 5.5834 - r1: 0.0849 - r5: 0.1981 - r10: 0.2682 - p5: 0.0396 - p10: 0.0268 - val_loss: 4.9842 - val_r1: 0.1733 - val_r5: 0.3462 - val_r10: 0.4353 - val_p5: 0.0692 - val_p10: 0.0435 - lr: 4.9901e-04 - 22s/epoch - 355ms/step
Epoch 3/1000
63/63 - 22s - loss: 5.0614 - r1: 0.1310 - r5: 0.2786 - r10: 0.3619 - p5: 0.0557 - p10: 0.0362 - val_loss: 4.6642 - val_r1: 0.2156 - val_r5: 0.4027 - val_r10: 0.4893 - val_p5: 0.0805 - val_p10: 0.0489 - lr: 4.9852e-04 - 22s/epoch - 357ms/step
Epoch 4/1000
63/63 - 23s - loss: 4.8234 - r1: 0.1566 - r5: 0.3196 - r10: 0.4060 - p5: 0.0639 - p10: 0.0406 - val_loss: 4.5188 - val_r1: 0.2327 - val_r5: 0.4237 - val_r10: 0.5101 - val_p5: 0.0847 - val_p10: 0.0510 - lr: 4.9802e-04 - 23s/epoch - 357ms/step
Epoch 5/1000
63/63 - 23s - loss: 4.6670 - r1: 0.1761 - r5: 0.3474 - r10: 0.4350 - p5: 0.0695 - p10: 0.0435 - val_loss: 4.4199 - val_r1: 0.2433 - val_r5: 0.4347 - val_r10: 0.5223 - val_p5: 0.0869 - val_p10: 0.0522 - lr: 4.9753e-04 - 23s/epoch - 357ms/step
Epoch 6/1000
63/63 - 23s - loss: 4.5654 - r1: 0.1885 - r5: 0.3639 - r10: 0.4531 - p5: 0.0728 - p10: 0.0453 - val_loss: 4.3244 - val_r1: 0.2584 - val_r5: 0.4518 - val_r10: 0.5352 - val_p5: 0.0904 - val_p10: 0.0535 - lr: 4.9703e-04 - 23s/epoch - 357ms/step
Epoch 7/1000
63/63 - 23s - loss: 4.4699 - r1: 0.2004 - r5: 0.3803 - r10: 0.4690 - p5: 0.0761 - p10: 0.0469 - val_loss: 4.2857 - val_r1: 0.2631 - val_r5: 0.4544 - val_r10: 0.5400 - val_p5: 0.0909 - val_p10: 0.0540 - lr: 4.9654e-04 - 23s/epoch - 358ms/step
Epoch 8/1000
63/63 - 23s - loss: 4.3986 - r1: 0.2089 - r5: 0.3919 - r10: 0.4799 - p5: 0.0784 - p10: 0.0480 - val_loss: 4.2129 - val_r1: 0.2748 - val_r5: 0.4667 - val_r10: 0.5498 - val_p5: 0.0933 - val_p10: 0.0550 - lr: 4.9604e-04 - 23s/epoch - 357ms/step
Epoch 9/1000
63/63 - 22s - loss: 4.3369 - r1: 0.2175 - r5: 0.4036 - r10: 0.4919 - p5: 0.0807 - p10: 0.0492 - val_loss: 4.1735 - val_r1: 0.2797 - val_r5: 0.4708 - val_r10: 0.5538 - val_p5: 0.0942 - val_p10: 0.0554 - lr: 4.9555e-04 - 22s/epoch - 357ms/step
Epoch 10/1000
63/63 - 22s - loss: 4.2786 - r1: 0.2239 - r5: 0.4118 - r10: 0.5015 - p5: 0.0824 - p10: 0.0502 - val_loss: 4.1870 - val_r1: 0.2771 - val_r5: 0.4670 - val_r10: 0.5518 - val_p5: 0.0934 - val_p10: 0.0552 - lr: 4.9505e-04 - 22s/epoch - 350ms/step
Epoch 11/1000
63/63 - 23s - loss: 4.2372 - r1: 0.2286 - r5: 0.4195 - r10: 0.5091 - p5: 0.0839 - p10: 0.0509 - val_loss: 4.1526 - val_r1: 0.2804 - val_r5: 0.4721 - val_r10: 0.5556 - val_p5: 0.0944 - val_p10: 0.0556 - lr: 4.9456e-04 - 23s/epoch - 357ms/step
Epoch 12/1000
63/63 - 23s - loss: 4.1920 - r1: 0.2348 - r5: 0.4271 - r10: 0.5156 - p5: 0.0854 - p10: 0.0516 - val_loss: 4.1275 - val_r1: 0.2869 - val_r5: 0.4758 - val_r10: 0.5590 - val_p5: 0.0951 - val_p10: 0.0559 - lr: 4.9406e-04 - 23s/epoch - 357ms/step
Epoch 13/1000
63/63 - 23s - loss: 4.1528 - r1: 0.2402 - r5: 0.4338 - r10: 0.5221 - p5: 0.0868 - p10: 0.0522 - val_loss: 4.0925 - val_r1: 0.2880 - val_r5: 0.4791 - val_r10: 0.5639 - val_p5: 0.0958 - val_p10: 0.0564 - lr: 4.9357e-04 - 23s/epoch - 357ms/step
Epoch 14/1000
63/63 - 22s - loss: 4.1147 - r1: 0.2445 - r5: 0.4392 - r10: 0.5290 - p5: 0.0878 - p10: 0.0529 - val_loss: 4.0956 - val_r1: 0.2886 - val_r5: 0.4804 - val_r10: 0.5637 - val_p5: 0.0961 - val_p10: 0.0564 - lr: 4.9307e-04 - 22s/epoch - 350ms/step
Epoch 15/1000
63/63 - 22s - loss: 4.0804 - r1: 0.2495 - r5: 0.4449 - r10: 0.5336 - p5: 0.0890 - p10: 0.0534 - val_loss: 4.0607 - val_r1: 0.2957 - val_r5: 0.4847 - val_r10: 0.5663 - val_p5: 0.0969 - val_p10: 0.0566 - lr: 4.9258e-04 - 22s/epoch - 357ms/step
Epoch 16/1000
63/63 - 23s - loss: 4.0558 - r1: 0.2520 - r5: 0.4494 - r10: 0.5388 - p5: 0.0899 - p10: 0.0539 - val_loss: 3.9893 - val_r1: 0.3031 - val_r5: 0.4949 - val_r10: 0.5773 - val_p5: 0.0990 - val_p10: 0.0577 - lr: 4.9208e-04 - 23s/epoch - 358ms/step
Epoch 17/1000
63/63 - 23s - loss: 4.0101 - r1: 0.2593 - r5: 0.4570 - r10: 0.5455 - p5: 0.0914 - p10: 0.0546 - val_loss: 3.9615 - val_r1: 0.3072 - val_r5: 0.4974 - val_r10: 0.5820 - val_p5: 0.0995 - val_p10: 0.0582 - lr: 4.9159e-04 - 23s/epoch - 357ms/step
Epoch 18/1000
63/63 - 22s - loss: 3.9812 - r1: 0.2629 - r5: 0.4613 - r10: 0.5496 - p5: 0.0923 - p10: 0.0550 - val_loss: 3.9751 - val_r1: 0.3036 - val_r5: 0.4971 - val_r10: 0.5781 - val_p5: 0.0994 - val_p10: 0.0578 - lr: 4.9109e-04 - 22s/epoch - 349ms/step
Epoch 19/1000
63/63 - 22s - loss: 3.9531 - r1: 0.2667 - r5: 0.4658 - r10: 0.5539 - p5: 0.0932 - p10: 0.0554 - val_loss: 3.9833 - val_r1: 0.3009 - val_r5: 0.4930 - val_r10: 0.5753 - val_p5: 0.0986 - val_p10: 0.0575 - lr: 4.9060e-04 - 22s/epoch - 349ms/step
Epoch 20/1000
63/63 - 23s - loss: 3.9249 - r1: 0.2705 - r5: 0.4706 - r10: 0.5595 - p5: 0.0941 - p10: 0.0560 - val_loss: 3.9535 - val_r1: 0.3083 - val_r5: 0.4998 - val_r10: 0.5791 - val_p5: 0.1000 - val_p10: 0.0579 - lr: 4.9010e-04 - 23s/epoch - 357ms/step
Epoch 21/1000
63/63 - 23s - loss: 3.8992 - r1: 0.2737 - r5: 0.4755 - r10: 0.5643 - p5: 0.0951 - p10: 0.0564 - val_loss: 3.9451 - val_r1: 0.3054 - val_r5: 0.4989 - val_r10: 0.5802 - val_p5: 0.0998 - val_p10: 0.0580 - lr: 4.8961e-04 - 23s/epoch - 358ms/step
Epoch 22/1000
63/63 - 22s - loss: 3.8758 - r1: 0.2759 - r5: 0.4786 - r10: 0.5672 - p5: 0.0957 - p10: 0.0567 - val_loss: 3.9656 - val_r1: 0.3019 - val_r5: 0.4947 - val_r10: 0.5766 - val_p5: 0.0990 - val_p10: 0.0577 - lr: 4.8911e-04 - 22s/epoch - 349ms/step
Epoch 23/1000
63/63 - 22s - loss: 3.8513 - r1: 0.2803 - r5: 0.4821 - r10: 0.5710 - p5: 0.0964 - p10: 0.0571 - val_loss: 3.9756 - val_r1: 0.3032 - val_r5: 0.4926 - val_r10: 0.5752 - val_p5: 0.0985 - val_p10: 0.0575 - lr: 4.8862e-04 - 22s/epoch - 350ms/step
Epoch 24/1000
63/63 - 23s - loss: 3.8330 - r1: 0.2816 - r5: 0.4852 - r10: 0.5733 - p5: 0.0970 - p10: 0.0573 - val_loss: 3.9444 - val_r1: 0.3051 - val_r5: 0.4985 - val_r10: 0.5790 - val_p5: 0.0997 - val_p10: 0.0579 - lr: 4.8812e-04 - 23s/epoch - 357ms/step
Epoch 25/1000
63/63 - 22s - loss: 3.8055 - r1: 0.2852 - r5: 0.4902 - r10: 0.5781 - p5: 0.0980 - p10: 0.0578 - val_loss: 3.9819 - val_r1: 0.2990 - val_r5: 0.4894 - val_r10: 0.5725 - val_p5: 0.0979 - val_p10: 0.0573 - lr: 4.8763e-04 - 22s/epoch - 349ms/step
Epoch 26/1000
63/63 - 22s - loss: 3.7942 - r1: 0.2870 - r5: 0.4921 - r10: 0.5795 - p5: 0.0984 - p10: 0.0579 - val_loss: 3.9637 - val_r1: 0.3016 - val_r5: 0.4944 - val_r10: 0.5764 - val_p5: 0.0989 - val_p10: 0.0576 - lr: 4.8713e-04 - 22s/epoch - 349ms/step
Epoch 27/1000
63/63 - 22s - loss: 3.7693 - r1: 0.2899 - r5: 0.4960 - r10: 0.5841 - p5: 0.0992 - p10: 0.0584 - val_loss: 3.9585 - val_r1: 0.3010 - val_r5: 0.4941 - val_r10: 0.5758 - val_p5: 0.0988 - val_p10: 0.0576 - lr: 4.8664e-04 - 22s/epoch - 349ms/step
Epoch 28/1000
63/63 - 22s - loss: 3.7617 - r1: 0.2905 - r5: 0.4975 - r10: 0.5854 - p5: 0.0995 - p10: 0.0585 - val_loss: 3.9723 - val_r1: 0.2994 - val_r5: 0.4927 - val_r10: 0.5734 - val_p5: 0.0985 - val_p10: 0.0573 - lr: 4.8614e-04 - 22s/epoch - 350ms/step
Epoch 29/1000
63/63 - 23s - loss: 3.7437 - r1: 0.2927 - r5: 0.4998 - r10: 0.5885 - p5: 0.1000 - p10: 0.0588 - val_loss: 3.9253 - val_r1: 0.3065 - val_r5: 0.4982 - val_r10: 0.5805 - val_p5: 0.0996 - val_p10: 0.0581 - lr: 4.8565e-04 - 23s/epoch - 358ms/step
Epoch 30/1000
63/63 - 22s - loss: 3.7260 - r1: 0.2958 - r5: 0.5042 - r10: 0.5911 - p5: 0.1008 - p10: 0.0591 - val_loss: 3.9578 - val_r1: 0.3033 - val_r5: 0.4951 - val_r10: 0.5745 - val_p5: 0.0990 - val_p10: 0.0575 - lr: 4.8515e-04 - 22s/epoch - 350ms/step
Epoch 31/1000
63/63 - 22s - loss: 3.7066 - r1: 0.2987 - r5: 0.5052 - r10: 0.5933 - p5: 0.1010 - p10: 0.0593 - val_loss: 3.9636 - val_r1: 0.3023 - val_r5: 0.4935 - val_r10: 0.5730 - val_p5: 0.0987 - val_p10: 0.0573 - lr: 4.8466e-04 - 22s/epoch - 350ms/step
Epoch 32/1000
63/63 - 22s - loss: 3.6818 - r1: 0.3016 - r5: 0.5120 - r10: 0.5982 - p5: 0.1024 - p10: 0.0598 - val_loss: 3.9477 - val_r1: 0.3035 - val_r5: 0.4948 - val_r10: 0.5766 - val_p5: 0.0990 - val_p10: 0.0577 - lr: 4.8416e-04 - 22s/epoch - 350ms/step
Epoch 33/1000
63/63 - 22s - loss: 3.6667 - r1: 0.3043 - r5: 0.5123 - r10: 0.5995 - p5: 0.1025 - p10: 0.0599 - val_loss: 3.9554 - val_r1: 0.3039 - val_r5: 0.4940 - val_r10: 0.5750 - val_p5: 0.0988 - val_p10: 0.0575 - lr: 4.8367e-04 - 22s/epoch - 349ms/step
Epoch 34/1000
63/63 - 22s - loss: 3.6506 - r1: 0.3062 - r5: 0.5154 - r10: 0.6029 - p5: 0.1031 - p10: 0.0603 - val_loss: 3.9703 - val_r1: 0.3008 - val_r5: 0.4916 - val_r10: 0.5720 - val_p5: 0.0983 - val_p10: 0.0572 - lr: 4.8317e-04 - 22s/epoch - 349ms/step
Epoch 35/1000
63/63 - 22s - loss: 3.6400 - r1: 0.3081 - r5: 0.5170 - r10: 0.6047 - p5: 0.1034 - p10: 0.0605 - val_loss: 3.9730 - val_r1: 0.3000 - val_r5: 0.4899 - val_r10: 0.5701 - val_p5: 0.0980 - val_p10: 0.0570 - lr: 4.8268e-04 - 22s/epoch - 350ms/step
Epoch 36/1000
63/63 - 23s - loss: 3.6327 - r1: 0.3088 - r5: 0.5178 - r10: 0.6046 - p5: 0.1035 - p10: 0.0605 - val_loss: 3.9246 - val_r1: 0.3088 - val_r5: 0.4989 - val_r10: 0.5782 - val_p5: 0.0998 - val_p10: 0.0578 - lr: 4.8218e-04 - 23s/epoch - 358ms/step
Epoch 37/1000
63/63 - 23s - loss: 3.6133 - r1: 0.3108 - r5: 0.5211 - r10: 0.6082 - p5: 0.1042 - p10: 0.0608 - val_loss: 3.9190 - val_r1: 0.3068 - val_r5: 0.4963 - val_r10: 0.5794 - val_p5: 0.0993 - val_p10: 0.0580 - lr: 4.8169e-04 - 23s/epoch - 358ms/step
Epoch 38/1000
63/63 - 23s - loss: 3.5956 - r1: 0.3137 - r5: 0.5247 - r10: 0.6107 - p5: 0.1049 - p10: 0.0611 - val_loss: 3.9056 - val_r1: 0.3089 - val_r5: 0.5006 - val_r10: 0.5790 - val_p5: 0.1001 - val_p10: 0.0579 - lr: 4.8119e-04 - 23s/epoch - 357ms/step
Epoch 39/1000
63/63 - 22s - loss: 3.5812 - r1: 0.3161 - r5: 0.5263 - r10: 0.6131 - p5: 0.1053 - p10: 0.0613 - val_loss: 3.9219 - val_r1: 0.3057 - val_r5: 0.4967 - val_r10: 0.5770 - val_p5: 0.0993 - val_p10: 0.0577 - lr: 4.8070e-04 - 22s/epoch - 350ms/step
Epoch 40/1000
63/63 - 23s - loss: 3.5717 - r1: 0.3159 - r5: 0.5273 - r10: 0.6146 - p5: 0.1055 - p10: 0.0615 - val_loss: 3.9032 - val_r1: 0.3067 - val_r5: 0.4997 - val_r10: 0.5796 - val_p5: 0.0999 - val_p10: 0.0580 - lr: 4.8020e-04 - 23s/epoch - 358ms/step
Epoch 41/1000
63/63 - 22s - loss: 3.5586 - r1: 0.3187 - r5: 0.5300 - r10: 0.6171 - p5: 0.1060 - p10: 0.0617 - val_loss: 3.9276 - val_r1: 0.3051 - val_r5: 0.4952 - val_r10: 0.5768 - val_p5: 0.0990 - val_p10: 0.0577 - lr: 4.7971e-04 - 22s/epoch - 349ms/step
Epoch 42/1000
63/63 - 22s - loss: 3.5525 - r1: 0.3188 - r5: 0.5304 - r10: 0.6171 - p5: 0.1061 - p10: 0.0617 - val_loss: 3.9125 - val_r1: 0.3080 - val_r5: 0.4991 - val_r10: 0.5785 - val_p5: 0.0998 - val_p10: 0.0578 - lr: 4.7921e-04 - 22s/epoch - 349ms/step
Epoch 43/1000
63/63 - 22s - loss: 3.5361 - r1: 0.3216 - r5: 0.5336 - r10: 0.6202 - p5: 0.1067 - p10: 0.0620 - val_loss: 3.9256 - val_r1: 0.3057 - val_r5: 0.4956 - val_r10: 0.5760 - val_p5: 0.0991 - val_p10: 0.0576 - lr: 4.7872e-04 - 22s/epoch - 349ms/step
Epoch 44/1000
63/63 - 22s - loss: 3.5226 - r1: 0.3246 - r5: 0.5353 - r10: 0.6216 - p5: 0.1071 - p10: 0.0622 - val_loss: 3.9315 - val_r1: 0.3053 - val_r5: 0.4948 - val_r10: 0.5750 - val_p5: 0.0990 - val_p10: 0.0575 - lr: 4.7822e-04 - 22s/epoch - 350ms/step
Epoch 45/1000
63/63 - 22s - loss: 3.5141 - r1: 0.3234 - r5: 0.5372 - r10: 0.6244 - p5: 0.1074 - p10: 0.0624 - val_loss: 3.9346 - val_r1: 0.3035 - val_r5: 0.4951 - val_r10: 0.5752 - val_p5: 0.0990 - val_p10: 0.0575 - lr: 4.7773e-04 - 22s/epoch - 349ms/step
Epoch 46/1000
63/63 - 22s - loss: 3.5007 - r1: 0.3262 - r5: 0.5394 - r10: 0.6258 - p5: 0.1079 - p10: 0.0626 - val_loss: 3.9234 - val_r1: 0.3049 - val_r5: 0.4955 - val_r10: 0.5761 - val_p5: 0.0991 - val_p10: 0.0576 - lr: 4.7723e-04 - 22s/epoch - 349ms/step
Epoch 47/1000
63/63 - 22s - loss: 3.4826 - r1: 0.3290 - r5: 0.5427 - r10: 0.6286 - p5: 0.1085 - p10: 0.0629 - val_loss: 3.9156 - val_r1: 0.3054 - val_r5: 0.4959 - val_r10: 0.5771 - val_p5: 0.0992 - val_p10: 0.0577 - lr: 4.7674e-04 - 22s/epoch - 349ms/step
Epoch 48/1000
63/63 - 22s - loss: 3.4720 - r1: 0.3300 - r5: 0.5432 - r10: 0.6292 - p5: 0.1086 - p10: 0.0629 - val_loss: 3.9482 - val_r1: 0.3028 - val_r5: 0.4929 - val_r10: 0.5733 - val_p5: 0.0986 - val_p10: 0.0573 - lr: 4.7624e-04 - 22s/epoch - 349ms/step
Epoch 49/1000
63/63 - 22s - loss: 3.4701 - r1: 0.3308 - r5: 0.5440 - r10: 0.6299 - p5: 0.1088 - p10: 0.0630 - val_loss: 3.9287 - val_r1: 0.3087 - val_r5: 0.4951 - val_r10: 0.5763 - val_p5: 0.0990 - val_p10: 0.0576 - lr: 4.7575e-04 - 22s/epoch - 350ms/step
Epoch 50/1000
63/63 - 22s - loss: 3.4600 - r1: 0.3323 - r5: 0.5457 - r10: 0.6310 - p5: 0.1092 - p10: 0.0631 - val_loss: 3.9569 - val_r1: 0.3018 - val_r5: 0.4911 - val_r10: 0.5706 - val_p5: 0.0982 - val_p10: 0.0571 - lr: 4.7525e-04 - 22s/epoch - 349ms/step
Epoch 51/1000
63/63 - 22s - loss: 3.4531 - r1: 0.3326 - r5: 0.5462 - r10: 0.6322 - p5: 0.1092 - p10: 0.0632 - val_loss: 3.9701 - val_r1: 0.2993 - val_r5: 0.4883 - val_r10: 0.5683 - val_p5: 0.0976 - val_p10: 0.0568 - lr: 4.7476e-04 - 22s/epoch - 349ms/step
Epoch 52/1000
63/63 - 22s - loss: 3.4394 - r1: 0.3347 - r5: 0.5488 - r10: 0.6346 - p5: 0.1098 - p10: 0.0635 - val_loss: 3.9427 - val_r1: 0.3027 - val_r5: 0.4924 - val_r10: 0.5739 - val_p5: 0.0985 - val_p10: 0.0574 - lr: 4.7426e-04 - 22s/epoch - 349ms/step
Epoch 53/1000
63/63 - 22s - loss: 3.4313 - r1: 0.3356 - r5: 0.5505 - r10: 0.6355 - p5: 0.1101 - p10: 0.0636 - val_loss: 3.9515 - val_r1: 0.3013 - val_r5: 0.4929 - val_r10: 0.5726 - val_p5: 0.0986 - val_p10: 0.0573 - lr: 4.7377e-04 - 22s/epoch - 350ms/step
Epoch 54/1000
63/63 - 22s - loss: 3.4244 - r1: 0.3376 - r5: 0.5506 - r10: 0.6365 - p5: 0.1101 - p10: 0.0637 - val_loss: 3.9309 - val_r1: 0.3052 - val_r5: 0.4962 - val_r10: 0.5758 - val_p5: 0.0992 - val_p10: 0.0576 - lr: 4.7327e-04 - 22s/epoch - 350ms/step
Epoch 55/1000
63/63 - 22s - loss: 3.4066 - r1: 0.3397 - r5: 0.5539 - r10: 0.6398 - p5: 0.1108 - p10: 0.0640 - val_loss: 3.9142 - val_r1: 0.3083 - val_r5: 0.4987 - val_r10: 0.5770 - val_p5: 0.0997 - val_p10: 0.0577 - lr: 4.7278e-04 - 22s/epoch - 350ms/step
Epoch 56/1000
63/63 - 22s - loss: 3.4034 - r1: 0.3402 - r5: 0.5542 - r10: 0.6398 - p5: 0.1108 - p10: 0.0640 - val_loss: 3.9169 - val_r1: 0.3080 - val_r5: 0.4991 - val_r10: 0.5778 - val_p5: 0.0998 - val_p10: 0.0578 - lr: 4.7228e-04 - 22s/epoch - 349ms/step
Epoch 57/1000
63/63 - 22s - loss: 3.3962 - r1: 0.3412 - r5: 0.5561 - r10: 0.6406 - p5: 0.1112 - p10: 0.0641 - val_loss: 3.9106 - val_r1: 0.3105 - val_r5: 0.4998 - val_r10: 0.5791 - val_p5: 0.1000 - val_p10: 0.0579 - lr: 4.7179e-04 - 22s/epoch - 349ms/step
Epoch 58/1000
63/63 - 22s - loss: 3.3803 - r1: 0.3433 - r5: 0.5587 - r10: 0.6432 - p5: 0.1117 - p10: 0.0643 - val_loss: 3.9173 - val_r1: 0.3078 - val_r5: 0.4987 - val_r10: 0.5778 - val_p5: 0.0997 - val_p10: 0.0578 - lr: 4.7129e-04 - 22s/epoch - 349ms/step
Epoch 59/1000
63/63 - 22s - loss: 3.3670 - r1: 0.3463 - r5: 0.5607 - r10: 0.6450 - p5: 0.1121 - p10: 0.0645 - val_loss: 3.9185 - val_r1: 0.3069 - val_r5: 0.4985 - val_r10: 0.5780 - val_p5: 0.0997 - val_p10: 0.0578 - lr: 4.7080e-04 - 22s/epoch - 348ms/step
Epoch 60/1000
63/63 - 22s - loss: 3.3625 - r1: 0.3460 - r5: 0.5625 - r10: 0.6469 - p5: 0.1125 - p10: 0.0647 - val_loss: 3.9222 - val_r1: 0.3059 - val_r5: 0.4986 - val_r10: 0.5753 - val_p5: 0.0997 - val_p10: 0.0575 - lr: 4.7030e-04 - 22s/epoch - 349ms/step
Epoch 61/1000
63/63 - 22s - loss: 3.3572 - r1: 0.3464 - r5: 0.5624 - r10: 0.6469 - p5: 0.1125 - p10: 0.0647 - val_loss: 3.9312 - val_r1: 0.3063 - val_r5: 0.4957 - val_r10: 0.5745 - val_p5: 0.0991 - val_p10: 0.0574 - lr: 4.6981e-04 - 22s/epoch - 350ms/step
Epoch 62/1000
63/63 - 22s - loss: 3.3463 - r1: 0.3488 - r5: 0.5638 - r10: 0.6490 - p5: 0.1128 - p10: 0.0649 - val_loss: 3.9478 - val_r1: 0.3020 - val_r5: 0.4935 - val_r10: 0.5725 - val_p5: 0.0987 - val_p10: 0.0573 - lr: 4.6931e-04 - 22s/epoch - 350ms/step
Epoch 63/1000
63/63 - 22s - loss: 3.3369 - r1: 0.3495 - r5: 0.5651 - r10: 0.6499 - p5: 0.1130 - p10: 0.0650 - val_loss: 3.9439 - val_r1: 0.3041 - val_r5: 0.4930 - val_r10: 0.5720 - val_p5: 0.0986 - val_p10: 0.0572 - lr: 4.6882e-04 - 22s/epoch - 349ms/step
Epoch 64/1000
63/63 - 22s - loss: 3.3359 - r1: 0.3487 - r5: 0.5662 - r10: 0.6504 - p5: 0.1132 - p10: 0.0650 - val_loss: 3.9636 - val_r1: 0.3009 - val_r5: 0.4919 - val_r10: 0.5690 - val_p5: 0.0984 - val_p10: 0.0569 - lr: 4.6832e-04 - 22s/epoch - 349ms/step
Epoch 65/1000
63/63 - 22s - loss: 3.3232 - r1: 0.3511 - r5: 0.5676 - r10: 0.6528 - p5: 0.1135 - p10: 0.0653 - val_loss: 3.9616 - val_r1: 0.3022 - val_r5: 0.4920 - val_r10: 0.5693 - val_p5: 0.0984 - val_p10: 0.0569 - lr: 4.6783e-04 - 22s/epoch - 349ms/step
Epoch 66/1000
63/63 - 22s - loss: 3.3261 - r1: 0.3505 - r5: 0.5684 - r10: 0.6520 - p5: 0.1137 - p10: 0.0652 - val_loss: 3.9337 - val_r1: 0.3065 - val_r5: 0.4970 - val_r10: 0.5728 - val_p5: 0.0994 - val_p10: 0.0573 - lr: 4.6733e-04 - 22s/epoch - 350ms/step
Epoch 67/1000
63/63 - 22s - loss: 3.3184 - r1: 0.3525 - r5: 0.5688 - r10: 0.6524 - p5: 0.1138 - p10: 0.0652 - val_loss: 3.9364 - val_r1: 0.3029 - val_r5: 0.4976 - val_r10: 0.5728 - val_p5: 0.0995 - val_p10: 0.0573 - lr: 4.6684e-04 - 22s/epoch - 349ms/step
Epoch 68/1000
63/63 - 22s - loss: 3.3066 - r1: 0.3543 - r5: 0.5689 - r10: 0.6539 - p5: 0.1138 - p10: 0.0654 - val_loss: 3.9351 - val_r1: 0.3050 - val_r5: 0.4966 - val_r10: 0.5735 - val_p5: 0.0993 - val_p10: 0.0573 - lr: 4.6634e-04 - 22s/epoch - 349ms/step
Epoch 69/1000
63/63 - 22s - loss: 3.2934 - r1: 0.3555 - r5: 0.5725 - r10: 0.6569 - p5: 0.1145 - p10: 0.0657 - val_loss: 3.9328 - val_r1: 0.3050 - val_r5: 0.4963 - val_r10: 0.5739 - val_p5: 0.0993 - val_p10: 0.0574 - lr: 4.6585e-04 - 22s/epoch - 350ms/step
Epoch 70/1000
63/63 - 22s - loss: 3.2852 - r1: 0.3568 - r5: 0.5748 - r10: 0.6583 - p5: 0.1150 - p10: 0.0658 - val_loss: 3.9386 - val_r1: 0.3051 - val_r5: 0.4965 - val_r10: 0.5738 - val_p5: 0.0993 - val_p10: 0.0574 - lr: 4.6535e-04 - 22s/epoch - 350ms/step
Epoch 71/1000
63/63 - 22s - loss: 3.2748 - r1: 0.3578 - r5: 0.5762 - r10: 0.6593 - p5: 0.1152 - p10: 0.0659 - val_loss: 3.9411 - val_r1: 0.3036 - val_r5: 0.4954 - val_r10: 0.5722 - val_p5: 0.0991 - val_p10: 0.0572 - lr: 4.6486e-04 - 22s/epoch - 349ms/step
Epoch 72/1000
63/63 - 22s - loss: 3.2650 - r1: 0.3599 - r5: 0.5778 - r10: 0.6609 - p5: 0.1156 - p10: 0.0661 - val_loss: 3.9426 - val_r1: 0.3041 - val_r5: 0.4968 - val_r10: 0.5726 - val_p5: 0.0994 - val_p10: 0.0573 - lr: 4.6436e-04 - 22s/epoch - 350ms/step
Epoch 73/1000
63/63 - 22s - loss: 3.2573 - r1: 0.3604 - r5: 0.5782 - r10: 0.6622 - p5: 0.1156 - p10: 0.0662 - val_loss: 3.9561 - val_r1: 0.3019 - val_r5: 0.4912 - val_r10: 0.5716 - val_p5: 0.0982 - val_p10: 0.0572 - lr: 4.6387e-04 - 22s/epoch - 349ms/step
Epoch 74/1000
63/63 - 22s - loss: 3.2527 - r1: 0.3616 - r5: 0.5790 - r10: 0.6625 - p5: 0.1158 - p10: 0.0662 - val_loss: 3.9585 - val_r1: 0.3030 - val_r5: 0.4939 - val_r10: 0.5703 - val_p5: 0.0988 - val_p10: 0.0570 - lr: 4.6337e-04 - 22s/epoch - 350ms/step
Epoch 75/1000
63/63 - 22s - loss: 3.2445 - r1: 0.3638 - r5: 0.5797 - r10: 0.6633 - p5: 0.1159 - p10: 0.0663 - val_loss: 3.9468 - val_r1: 0.3059 - val_r5: 0.4935 - val_r10: 0.5713 - val_p5: 0.0987 - val_p10: 0.0571 - lr: 4.6288e-04 - 22s/epoch - 350ms/step
Epoch 76/1000
63/63 - 22s - loss: 3.2394 - r1: 0.3635 - r5: 0.5810 - r10: 0.6642 - p5: 0.1162 - p10: 0.0664 - val_loss: 3.9700 - val_r1: 0.3011 - val_r5: 0.4891 - val_r10: 0.5675 - val_p5: 0.0978 - val_p10: 0.0568 - lr: 4.6238e-04 - 22s/epoch - 349ms/step
Epoch 77/1000
63/63 - 22s - loss: 3.2384 - r1: 0.3627 - r5: 0.5822 - r10: 0.6641 - p5: 0.1164 - p10: 0.0664 - val_loss: 3.9696 - val_r1: 0.3020 - val_r5: 0.4901 - val_r10: 0.5691 - val_p5: 0.0981 - val_p10: 0.0569 - lr: 4.6189e-04 - 22s/epoch - 349ms/step
Epoch 78/1000
63/63 - 22s - loss: 3.2311 - r1: 0.3640 - r5: 0.5822 - r10: 0.6660 - p5: 0.1164 - p10: 0.0666 - val_loss: 3.9856 - val_r1: 0.2979 - val_r5: 0.4869 - val_r10: 0.5671 - val_p5: 0.0974 - val_p10: 0.0567 - lr: 4.6139e-04 - 22s/epoch - 349ms/step
Epoch 79/1000
63/63 - 22s - loss: 3.2236 - r1: 0.3662 - r5: 0.5835 - r10: 0.6669 - p5: 0.1167 - p10: 0.0667 - val_loss: 3.9737 - val_r1: 0.2994 - val_r5: 0.4883 - val_r10: 0.5673 - val_p5: 0.0977 - val_p10: 0.0567 - lr: 4.6090e-04 - 22s/epoch - 350ms/step
Epoch 80/1000
63/63 - 22s - loss: 3.2205 - r1: 0.3655 - r5: 0.5841 - r10: 0.6677 - p5: 0.1168 - p10: 0.0668 - val_loss: 3.9849 - val_r1: 0.2987 - val_r5: 0.4862 - val_r10: 0.5660 - val_p5: 0.0972 - val_p10: 0.0566 - lr: 4.6040e-04 - 22s/epoch - 349ms/step
Epoch 81/1000
63/63 - 22s - loss: 3.2188 - r1: 0.3659 - r5: 0.5838 - r10: 0.6667 - p5: 0.1168 - p10: 0.0667 - val_loss: 3.9622 - val_r1: 0.3028 - val_r5: 0.4892 - val_r10: 0.5698 - val_p5: 0.0978 - val_p10: 0.0570 - lr: 4.5991e-04 - 22s/epoch - 349ms/step
Epoch 82/1000
63/63 - 22s - loss: 3.2099 - r1: 0.3679 - r5: 0.5858 - r10: 0.6686 - p5: 0.1172 - p10: 0.0669 - val_loss: 3.9606 - val_r1: 0.3045 - val_r5: 0.4915 - val_r10: 0.5684 - val_p5: 0.0983 - val_p10: 0.0568 - lr: 4.5941e-04 - 22s/epoch - 349ms/step
Epoch 83/1000
63/63 - 22s - loss: 3.2067 - r1: 0.3679 - r5: 0.5859 - r10: 0.6697 - p5: 0.1172 - p10: 0.0670 - val_loss: 3.9745 - val_r1: 0.3011 - val_r5: 0.4875 - val_r10: 0.5681 - val_p5: 0.0975 - val_p10: 0.0568 - lr: 4.5892e-04 - 22s/epoch - 349ms/step
Epoch 84/1000
63/63 - 22s - loss: 3.2018 - r1: 0.3685 - r5: 0.5876 - r10: 0.6706 - p5: 0.1175 - p10: 0.0671 - val_loss: 3.9636 - val_r1: 0.3020 - val_r5: 0.4894 - val_r10: 0.5694 - val_p5: 0.0979 - val_p10: 0.0569 - lr: 4.5842e-04 - 22s/epoch - 349ms/step
Epoch 85/1000
63/63 - 22s - loss: 3.2039 - r1: 0.3681 - r5: 0.5861 - r10: 0.6697 - p5: 0.1172 - p10: 0.0670 - val_loss: 3.9614 - val_r1: 0.3013 - val_r5: 0.4887 - val_r10: 0.5686 - val_p5: 0.0977 - val_p10: 0.0569 - lr: 4.5793e-04 - 22s/epoch - 350ms/step
Epoch 86/1000
63/63 - 22s - loss: 3.1953 - r1: 0.3692 - r5: 0.5873 - r10: 0.6716 - p5: 0.1175 - p10: 0.0672 - val_loss: 3.9596 - val_r1: 0.3036 - val_r5: 0.4909 - val_r10: 0.5720 - val_p5: 0.0982 - val_p10: 0.0572 - lr: 4.5743e-04 - 22s/epoch - 349ms/step
Epoch 87/1000
63/63 - 22s - loss: 3.1759 - r1: 0.3732 - r5: 0.5911 - r10: 0.6740 - p5: 0.1182 - p10: 0.0674 - val_loss: 3.9515 - val_r1: 0.3046 - val_r5: 0.4937 - val_r10: 0.5685 - val_p5: 0.0987 - val_p10: 0.0569 - lr: 4.5694e-04 - 22s/epoch - 350ms/step
Epoch 88/1000
63/63 - 22s - loss: 3.1712 - r1: 0.3721 - r5: 0.5918 - r10: 0.6751 - p5: 0.1183 - p10: 0.0675 - val_loss: 3.9562 - val_r1: 0.3036 - val_r5: 0.4912 - val_r10: 0.5698 - val_p5: 0.0982 - val_p10: 0.0570 - lr: 4.5644e-04 - 22s/epoch - 349ms/step
Epoch 89/1000
63/63 - 22s - loss: 3.1620 - r1: 0.3756 - r5: 0.5938 - r10: 0.6765 - p5: 0.1188 - p10: 0.0676 - val_loss: 3.9583 - val_r1: 0.3032 - val_r5: 0.4912 - val_r10: 0.5696 - val_p5: 0.0982 - val_p10: 0.0570 - lr: 4.5595e-04 - 22s/epoch - 349ms/step
Epoch 90/1000
63/63 - 22s - loss: 3.1624 - r1: 0.3740 - r5: 0.5933 - r10: 0.6765 - p5: 0.1187 - p10: 0.0676 - val_loss: 3.9578 - val_r1: 0.3038 - val_r5: 0.4910 - val_r10: 0.5728 - val_p5: 0.0982 - val_p10: 0.0573 - lr: 4.5545e-04 - 22s/epoch - 349ms/step
Epoch 90: early stopping
[92m[INFO] Loading best model...[0m
[93m[WARNING] Model folder already exists...[0m
Model: "ATT2ITM_0"
__________________________________________________________________________________________________
 Layer (type)                   Output Shape         Param #     Connected to                     
==================================================================================================
 input_1 (InputLayer)           [(None, 172)]        0           []                               
                                                                                                  
 input_2 (InputLayer)           [(None, 1322)]       0           []                               
                                                                                                  
 embedding (Embedding)          (None, 172, 384)     3389952     ['input_1[0][0]']                
                                                                                                  
 in_rsts (Embedding)            (None, 1322, 384)    507648      ['input_2[0][0]']                
                                                                                                  
 dense (Dense)                  (None, 172, 256)     98560       ['embedding[0][0]']              
                                                                                                  
 dense_2 (Dense)                (None, 1322, 256)    98560       ['in_rsts[0][0]']                
                                                                                                  
 tf.math.not_equal (TFOpLambda)  (None, 172)         0           ['input_1[0][0]']                
                                                                                                  
 dense_1 (Dense)                (None, 172, 128)     32896       ['dense[0][0]']                  
                                                                                                  
 dense_3 (Dense)                (None, 1322, 128)    32896       ['dense_2[0][0]']                
                                                                                                  
 tf.cast (TFOpLambda)           (None, 172)          0           ['tf.math.not_equal[0][0]']      
                                                                                                  
 word_emb (Lambda)              (None, 172, 128)     0           ['dense_1[0][0]']                
                                                                                                  
 rest_emb (Lambda)              (None, 1322, 128)    0           ['dense_3[0][0]']                
                                                                                                  
 tf.expand_dims (TFOpLambda)    (None, 172, 1)       0           ['tf.cast[0][0]']                
                                                                                                  
 lambda (Lambda)                (None, 172, 1322)    0           ['word_emb[0][0]',               
                                                                  'rest_emb[0][0]']               
                                                                                                  
 tf.tile (TFOpLambda)           (None, 172, 1322)    0           ['tf.expand_dims[0][0]']         
                                                                                                  
 lambda_1 (Lambda)              (None, 172, 1322)    0           ['lambda[0][0]',                 
                                                                  'tf.tile[0][0]']                
                                                                                                  
 dotprod (Activation)           (None, 172, 1322)    0           ['lambda_1[0][0]']               
                                                                                                  
 dropout (Dropout)              (None, 172, 1322)    0           ['dotprod[0][0]']                
                                                                                                  
 sum (Lambda)                   (None, 1322)         0           ['dropout[0][0]']                
                                                                                                  
 out (Activation)               (None, 1322)         0           ['sum[0][0]']                    
                                                                                                  
==================================================================================================
Total params: 4,160,512
Trainable params: 4,160,512
Non-trainable params: 0
__________________________________________________________________________________________________
None
[92m[INFO] Model already trained. Loading weights...[0m
