Using TensorFlow backend
Epoch 1/1000
251/251 - 26s - loss: 6.0041 - NDCG@10: 0.1306 - r1: 0.0688 - r5: 0.1551 - r10: 0.2093 - p5: 0.0310 - p10: 0.0209 - f1: 0.0048 - val_loss: 4.9567 - val_NDCG@10: 0.2852 - val_r1: 0.1743 - val_r5: 0.3350 - val_r10: 0.4200 - val_p5: 0.0670 - val_p10: 0.0420 - val_f1: 0.0077 - lr: 4.9951e-04 - e_time: 25.4470 - 26s/epoch - 104ms/step
Epoch 2/1000
251/251 - 22s - loss: 4.8944 - NDCG@10: 0.2672 - r1: 0.1635 - r5: 0.3137 - r10: 0.3930 - p5: 0.0627 - p10: 0.0393 - f1: 0.0102 - val_loss: 4.3868 - val_NDCG@10: 0.3699 - val_r1: 0.2491 - val_r5: 0.4260 - val_r10: 0.5118 - val_p5: 0.0852 - val_p10: 0.0512 - val_f1: 0.0161 - lr: 4.9901e-04 - e_time: 21.7070 - 22s/epoch - 89ms/step
Epoch 3/1000
251/251 - 22s - loss: 4.5596 - NDCG@10: 0.3155 - r1: 0.2033 - r5: 0.3669 - r10: 0.4493 - p5: 0.0734 - p10: 0.0449 - f1: 0.0118 - val_loss: 4.1709 - val_NDCG@10: 0.4002 - val_r1: 0.2780 - val_r5: 0.4610 - val_r10: 0.5414 - val_p5: 0.0922 - val_p10: 0.0541 - val_f1: 0.0171 - lr: 4.9852e-04 - e_time: 21.8237 - 22s/epoch - 89ms/step
Epoch 4/1000
251/251 - 23s - loss: 4.3560 - NDCG@10: 0.3446 - r1: 0.2281 - r5: 0.3994 - r10: 0.4823 - p5: 0.0799 - p10: 0.0482 - f1: 0.0131 - val_loss: 4.0344 - val_NDCG@10: 0.4167 - val_r1: 0.2936 - val_r5: 0.4783 - val_r10: 0.5576 - val_p5: 0.0957 - val_p10: 0.0558 - val_f1: 0.0181 - lr: 4.9802e-04 - e_time: 21.8590 - 23s/epoch - 91ms/step
Epoch 5/1000
251/251 - 23s - loss: 4.2217 - NDCG@10: 0.3644 - r1: 0.2452 - r5: 0.4209 - r10: 0.5038 - p5: 0.0842 - p10: 0.0504 - f1: 0.0138 - val_loss: 3.9596 - val_NDCG@10: 0.4263 - val_r1: 0.3047 - val_r5: 0.4876 - val_r10: 0.5656 - val_p5: 0.0975 - val_p10: 0.0565 - val_f1: 0.0191 - lr: 4.9753e-04 - e_time: 21.9259 - 23s/epoch - 90ms/step
Epoch 6/1000
251/251 - 22s - loss: 4.1177 - NDCG@10: 0.3786 - r1: 0.2574 - r5: 0.4367 - r10: 0.5201 - p5: 0.0873 - p10: 0.0520 - f1: 0.0146 - val_loss: 3.9044 - val_NDCG@10: 0.4331 - val_r1: 0.3100 - val_r5: 0.4944 - val_r10: 0.5738 - val_p5: 0.0989 - val_p10: 0.0574 - val_f1: 0.0184 - lr: 4.9703e-04 - e_time: 21.9235 - 22s/epoch - 90ms/step
Epoch 7/1000
251/251 - 22s - loss: 4.0252 - NDCG@10: 0.3917 - r1: 0.2695 - r5: 0.4509 - r10: 0.5335 - p5: 0.0902 - p10: 0.0533 - f1: 0.0151 - val_loss: 3.8664 - val_NDCG@10: 0.4383 - val_r1: 0.3164 - val_r5: 0.4991 - val_r10: 0.5776 - val_p5: 0.0998 - val_p10: 0.0578 - val_f1: 0.0176 - lr: 4.9654e-04 - e_time: 21.9090 - 22s/epoch - 90ms/step
Epoch 8/1000
251/251 - 22s - loss: 3.9527 - NDCG@10: 0.4014 - r1: 0.2775 - r5: 0.4619 - r10: 0.5450 - p5: 0.0924 - p10: 0.0545 - f1: 0.0155 - val_loss: 3.8233 - val_NDCG@10: 0.4436 - val_r1: 0.3220 - val_r5: 0.5048 - val_r10: 0.5820 - val_p5: 0.1009 - val_p10: 0.0582 - val_f1: 0.0185 - lr: 4.9604e-04 - e_time: 21.9228 - 22s/epoch - 90ms/step
Epoch 9/1000
251/251 - 22s - loss: 3.8765 - NDCG@10: 0.4131 - r1: 0.2881 - r5: 0.4746 - r10: 0.5573 - p5: 0.0949 - p10: 0.0557 - f1: 0.0159 - val_loss: 3.7554 - val_NDCG@10: 0.4528 - val_r1: 0.3306 - val_r5: 0.5146 - val_r10: 0.5901 - val_p5: 0.1029 - val_p10: 0.0590 - val_f1: 0.0207 - lr: 4.9555e-04 - e_time: 21.9317 - 22s/epoch - 90ms/step
Epoch 10/1000
251/251 - 22s - loss: 3.8189 - NDCG@10: 0.4213 - r1: 0.2944 - r5: 0.4841 - r10: 0.5670 - p5: 0.0968 - p10: 0.0567 - f1: 0.0162 - val_loss: 3.7776 - val_NDCG@10: 0.4501 - val_r1: 0.3291 - val_r5: 0.5108 - val_r10: 0.5876 - val_p5: 0.1022 - val_p10: 0.0588 - val_f1: 0.0188 - lr: 4.9505e-04 - e_time: 21.9178 - 22s/epoch - 87ms/step
Epoch 11/1000
251/251 - 22s - loss: 3.7729 - NDCG@10: 0.4278 - r1: 0.3004 - r5: 0.4909 - r10: 0.5741 - p5: 0.0982 - p10: 0.0574 - f1: 0.0165 - val_loss: 3.7699 - val_NDCG@10: 0.4501 - val_r1: 0.3287 - val_r5: 0.5109 - val_r10: 0.5869 - val_p5: 0.1022 - val_p10: 0.0587 - val_f1: 0.0206 - lr: 4.9456e-04 - e_time: 21.9504 - 22s/epoch - 87ms/step
Epoch 12/1000
251/251 - 22s - loss: 3.7163 - NDCG@10: 0.4358 - r1: 0.3070 - r5: 0.4999 - r10: 0.5828 - p5: 0.1000 - p10: 0.0583 - f1: 0.0173 - val_loss: 3.7590 - val_NDCG@10: 0.4506 - val_r1: 0.3295 - val_r5: 0.5121 - val_r10: 0.5864 - val_p5: 0.1024 - val_p10: 0.0586 - val_f1: 0.0233 - lr: 4.9406e-04 - e_time: 21.9162 - 22s/epoch - 87ms/step
Epoch 13/1000
251/251 - 22s - loss: 3.6781 - NDCG@10: 0.4418 - r1: 0.3121 - r5: 0.5070 - r10: 0.5895 - p5: 0.1014 - p10: 0.0590 - f1: 0.0174 - val_loss: 3.7543 - val_NDCG@10: 0.4527 - val_r1: 0.3324 - val_r5: 0.5116 - val_r10: 0.5894 - val_p5: 0.1023 - val_p10: 0.0589 - val_f1: 0.0195 - lr: 4.9357e-04 - e_time: 21.9240 - 22s/epoch - 90ms/step
Epoch 14/1000
251/251 - 22s - loss: 3.6301 - NDCG@10: 0.4482 - r1: 0.3184 - r5: 0.5126 - r10: 0.5961 - p5: 0.1025 - p10: 0.0596 - f1: 0.0175 - val_loss: 3.7463 - val_NDCG@10: 0.4531 - val_r1: 0.3342 - val_r5: 0.5131 - val_r10: 0.5878 - val_p5: 0.1026 - val_p10: 0.0588 - val_f1: 0.0195 - lr: 4.9307e-04 - e_time: 21.9116 - 22s/epoch - 90ms/step
Epoch 15/1000
251/251 - 22s - loss: 3.5874 - NDCG@10: 0.4551 - r1: 0.3245 - r5: 0.5209 - r10: 0.6034 - p5: 0.1042 - p10: 0.0603 - f1: 0.0174 - val_loss: 3.7479 - val_NDCG@10: 0.4531 - val_r1: 0.3355 - val_r5: 0.5112 - val_r10: 0.5869 - val_p5: 0.1022 - val_p10: 0.0587 - val_f1: 0.0194 - lr: 4.9258e-04 - e_time: 21.9085 - 22s/epoch - 87ms/step
Epoch 16/1000
251/251 - 22s - loss: 3.5555 - NDCG@10: 0.4590 - r1: 0.3272 - r5: 0.5258 - r10: 0.6082 - p5: 0.1051 - p10: 0.0608 - f1: 0.0177 - val_loss: 3.7524 - val_NDCG@10: 0.4529 - val_r1: 0.3335 - val_r5: 0.5125 - val_r10: 0.5888 - val_p5: 0.1025 - val_p10: 0.0589 - val_f1: 0.0205 - lr: 4.9208e-04 - e_time: 21.9169 - 22s/epoch - 87ms/step
Epoch 17/1000
251/251 - 22s - loss: 3.5238 - NDCG@10: 0.4642 - r1: 0.3331 - r5: 0.5300 - r10: 0.6128 - p5: 0.1060 - p10: 0.0613 - f1: 0.0183 - val_loss: 3.7252 - val_NDCG@10: 0.4590 - val_r1: 0.3401 - val_r5: 0.5177 - val_r10: 0.5940 - val_p5: 0.1035 - val_p10: 0.0594 - val_f1: 0.0263 - lr: 4.9159e-04 - e_time: 21.9251 - 22s/epoch - 90ms/step
Epoch 18/1000
251/251 - 22s - loss: 3.4846 - NDCG@10: 0.4694 - r1: 0.3376 - r5: 0.5361 - r10: 0.6185 - p5: 0.1072 - p10: 0.0618 - f1: 0.0186 - val_loss: 3.7559 - val_NDCG@10: 0.4521 - val_r1: 0.3335 - val_r5: 0.5130 - val_r10: 0.5865 - val_p5: 0.1026 - val_p10: 0.0586 - val_f1: 0.0218 - lr: 4.9109e-04 - e_time: 21.9255 - 22s/epoch - 87ms/step
Epoch 19/1000
251/251 - 22s - loss: 3.4653 - NDCG@10: 0.4723 - r1: 0.3405 - r5: 0.5393 - r10: 0.6209 - p5: 0.1079 - p10: 0.0621 - f1: 0.0185 - val_loss: 3.7501 - val_NDCG@10: 0.4544 - val_r1: 0.3358 - val_r5: 0.5140 - val_r10: 0.5879 - val_p5: 0.1028 - val_p10: 0.0588 - val_f1: 0.0231 - lr: 4.9060e-04 - e_time: 21.9318 - 22s/epoch - 87ms/step
Epoch 20/1000
251/251 - 22s - loss: 3.4275 - NDCG@10: 0.4777 - r1: 0.3451 - r5: 0.5454 - r10: 0.6273 - p5: 0.1091 - p10: 0.0627 - f1: 0.0186 - val_loss: 3.7570 - val_NDCG@10: 0.4536 - val_r1: 0.3359 - val_r5: 0.5126 - val_r10: 0.5874 - val_p5: 0.1025 - val_p10: 0.0587 - val_f1: 0.0217 - lr: 4.9010e-04 - e_time: 21.9349 - 22s/epoch - 87ms/step
Epoch 21/1000
251/251 - 22s - loss: 3.4016 - NDCG@10: 0.4813 - r1: 0.3473 - r5: 0.5500 - r10: 0.6319 - p5: 0.1100 - p10: 0.0632 - f1: 0.0186 - val_loss: 3.7640 - val_NDCG@10: 0.4538 - val_r1: 0.3354 - val_r5: 0.5139 - val_r10: 0.5879 - val_p5: 0.1028 - val_p10: 0.0588 - val_f1: 0.0236 - lr: 4.8961e-04 - e_time: 21.9285 - 22s/epoch - 87ms/step
Epoch 22/1000
251/251 - 22s - loss: 3.3828 - NDCG@10: 0.4840 - r1: 0.3504 - r5: 0.5527 - r10: 0.6342 - p5: 0.1105 - p10: 0.0634 - f1: 0.0190 - val_loss: 3.7432 - val_NDCG@10: 0.4557 - val_r1: 0.3369 - val_r5: 0.5162 - val_r10: 0.5897 - val_p5: 0.1033 - val_p10: 0.0590 - val_f1: 0.0220 - lr: 4.8911e-04 - e_time: 21.9350 - 22s/epoch - 87ms/step
Epoch 23/1000
251/251 - 22s - loss: 3.3527 - NDCG@10: 0.4888 - r1: 0.3549 - r5: 0.5573 - r10: 0.6389 - p5: 0.1115 - p10: 0.0639 - f1: 0.0192 - val_loss: 3.7652 - val_NDCG@10: 0.4529 - val_r1: 0.3344 - val_r5: 0.5125 - val_r10: 0.5862 - val_p5: 0.1025 - val_p10: 0.0586 - val_f1: 0.0242 - lr: 4.8862e-04 - e_time: 21.9390 - 22s/epoch - 87ms/step
Epoch 24/1000
251/251 - 22s - loss: 3.3337 - NDCG@10: 0.4916 - r1: 0.3577 - r5: 0.5602 - r10: 0.6414 - p5: 0.1120 - p10: 0.0641 - f1: 0.0196 - val_loss: 3.7630 - val_NDCG@10: 0.4543 - val_r1: 0.3365 - val_r5: 0.5135 - val_r10: 0.5871 - val_p5: 0.1027 - val_p10: 0.0587 - val_f1: 0.0223 - lr: 4.8812e-04 - e_time: 21.9421 - 22s/epoch - 87ms/step
Epoch 25/1000
251/251 - 22s - loss: 3.3102 - NDCG@10: 0.4951 - r1: 0.3611 - r5: 0.5641 - r10: 0.6451 - p5: 0.1128 - p10: 0.0645 - f1: 0.0197 - val_loss: 3.7566 - val_NDCG@10: 0.4563 - val_r1: 0.3391 - val_r5: 0.5157 - val_r10: 0.5892 - val_p5: 0.1031 - val_p10: 0.0589 - val_f1: 0.0243 - lr: 4.8763e-04 - e_time: 21.9430 - 22s/epoch - 87ms/step
Epoch 26/1000
251/251 - 22s - loss: 3.2926 - NDCG@10: 0.4975 - r1: 0.3626 - r5: 0.5670 - r10: 0.6482 - p5: 0.1134 - p10: 0.0648 - f1: 0.0197 - val_loss: 3.7901 - val_NDCG@10: 0.4515 - val_r1: 0.3339 - val_r5: 0.5111 - val_r10: 0.5832 - val_p5: 0.1022 - val_p10: 0.0583 - val_f1: 0.0218 - lr: 4.8713e-04 - e_time: 21.9505 - 22s/epoch - 87ms/step
Epoch 27/1000
251/251 - 22s - loss: 3.2757 - NDCG@10: 0.5004 - r1: 0.3665 - r5: 0.5700 - r10: 0.6498 - p5: 0.1140 - p10: 0.0650 - f1: 0.0198 - val_loss: 3.7768 - val_NDCG@10: 0.4531 - val_r1: 0.3350 - val_r5: 0.5118 - val_r10: 0.5862 - val_p5: 0.1024 - val_p10: 0.0586 - val_f1: 0.0243 - lr: 4.8664e-04 - e_time: 21.9255 - 22s/epoch - 87ms/step
Epoch 27: early stopping
[92m[INFO] Loading best model...[0m
