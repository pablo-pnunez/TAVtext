Model: "ATT2ITM_1"
__________________________________________________________________________________________________
 Layer (type)                   Output Shape         Param #     Connected to                     
==================================================================================================
 input_1 (InputLayer)           [(None, 172)]        0           []                               
                                                                                                  
 input_2 (InputLayer)           [(None, 1322)]       0           []                               
                                                                                                  
 embedding (Embedding)          (None, 172, 384)     3389952     ['input_1[0][0]']                
                                                                                                  
 in_rsts (Embedding)            (None, 1322, 384)    507648      ['input_2[0][0]']                
                                                                                                  
 dense (Dense)                  (None, 172, 256)     98560       ['embedding[0][0]']              
                                                                                                  
 dense_2 (Dense)                (None, 1322, 256)    98560       ['in_rsts[0][0]']                
                                                                                                  
 tf.math.not_equal (TFOpLambda)  (None, 172)         0           ['input_1[0][0]']                
                                                                                                  
 dense_1 (Dense)                (None, 172, 128)     32896       ['dense[0][0]']                  
                                                                                                  
 dense_3 (Dense)                (None, 1322, 128)    32896       ['dense_2[0][0]']                
                                                                                                  
 tf.cast (TFOpLambda)           (None, 172)          0           ['tf.math.not_equal[0][0]']      
                                                                                                  
 word_emb (Lambda)              (None, 172, 128)     0           ['dense_1[0][0]']                
                                                                                                  
 rest_emb (Lambda)              (None, 1322, 128)    0           ['dense_3[0][0]']                
                                                                                                  
 tf.expand_dims (TFOpLambda)    (None, 172, 1)       0           ['tf.cast[0][0]']                
                                                                                                  
 lambda (Lambda)                (None, 172, 1322)    0           ['word_emb[0][0]',               
                                                                  'rest_emb[0][0]']               
                                                                                                  
 tf.tile (TFOpLambda)           (None, 172, 1322)    0           ['tf.expand_dims[0][0]']         
                                                                                                  
 lambda_1 (Lambda)              (None, 172, 1322)    0           ['lambda[0][0]',                 
                                                                  'tf.tile[0][0]']                
                                                                                                  
 dotprod (Activation)           (None, 172, 1322)    0           ['lambda_1[0][0]']               
                                                                                                  
 dropout (Dropout)              (None, 172, 1322)    0           ['dotprod[0][0]']                
                                                                                                  
 sum (Lambda)                   (None, 1322)         0           ['dropout[0][0]']                
                                                                                                  
 out (Activation)               (None, 1322)         0           ['sum[0][0]']                    
                                                                                                  
==================================================================================================
Total params: 4,160,512
Trainable params: 4,160,512
Non-trainable params: 0
__________________________________________________________________________________________________
None
Epoch 1/1000
[93m[WARNING] Model folder already exists...[0m
Model: "ATT2ITM_1"
__________________________________________________________________________________________________
 Layer (type)                   Output Shape         Param #     Connected to                     
==================================================================================================
 input_1 (InputLayer)           [(None, 172)]        0           []                               
                                                                                                  
 input_2 (InputLayer)           [(None, 1322)]       0           []                               
                                                                                                  
 embedding (Embedding)          (None, 172, 384)     3389952     ['input_1[0][0]']                
                                                                                                  
 in_rsts (Embedding)            (None, 1322, 384)    507648      ['input_2[0][0]']                
                                                                                                  
 dense (Dense)                  (None, 172, 256)     98560       ['embedding[0][0]']              
                                                                                                  
 dense_2 (Dense)                (None, 1322, 256)    98560       ['in_rsts[0][0]']                
                                                                                                  
 tf.math.not_equal (TFOpLambda)  (None, 172)         0           ['input_1[0][0]']                
                                                                                                  
 dense_1 (Dense)                (None, 172, 128)     32896       ['dense[0][0]']                  
                                                                                                  
 dense_3 (Dense)                (None, 1322, 128)    32896       ['dense_2[0][0]']                
                                                                                                  
 tf.cast (TFOpLambda)           (None, 172)          0           ['tf.math.not_equal[0][0]']      
                                                                                                  
 word_emb (Lambda)              (None, 172, 128)     0           ['dense_1[0][0]']                
                                                                                                  
 rest_emb (Lambda)              (None, 1322, 128)    0           ['dense_3[0][0]']                
                                                                                                  
 tf.expand_dims (TFOpLambda)    (None, 172, 1)       0           ['tf.cast[0][0]']                
                                                                                                  
 lambda (Lambda)                (None, 172, 1322)    0           ['word_emb[0][0]',               
                                                                  'rest_emb[0][0]']               
                                                                                                  
 tf.tile (TFOpLambda)           (None, 172, 1322)    0           ['tf.expand_dims[0][0]']         
                                                                                                  
 lambda_1 (Lambda)              (None, 172, 1322)    0           ['lambda[0][0]',                 
                                                                  'tf.tile[0][0]']                
                                                                                                  
 dotprod (Activation)           (None, 172, 1322)    0           ['lambda_1[0][0]']               
                                                                                                  
 dropout (Dropout)              (None, 172, 1322)    0           ['dotprod[0][0]']                
                                                                                                  
 sum (Lambda)                   (None, 1322)         0           ['dropout[0][0]']                
                                                                                                  
 out (Activation)               (None, 1322)         0           ['sum[0][0]']                    
                                                                                                  
==================================================================================================
Total params: 4,160,512
Trainable params: 4,160,512
Non-trainable params: 0
__________________________________________________________________________________________________
None
Epoch 1/1000
126/126 - 25s - loss: 0.0113 - r1: 0.0034 - r5: 0.0142 - r10: 0.0254 - p5: 0.0028 - p10: 0.0025 - val_loss: 0.0038 - val_r1: 0.0084 - val_r5: 0.0342 - val_r10: 0.0524 - val_p5: 0.0068 - val_p10: 0.0053 - lr: 4.9951e-04 - 25s/epoch - 198ms/step
Epoch 2/1000
126/126 - 22s - loss: 0.0041 - r1: 0.0050 - r5: 0.0185 - r10: 0.0320 - p5: 0.0037 - p10: 0.0032 - val_loss: 0.0037 - val_r1: 0.0126 - val_r5: 0.0422 - val_r10: 0.0643 - val_p5: 0.0084 - val_p10: 0.0064 - lr: 4.9901e-04 - 22s/epoch - 178ms/step
Epoch 3/1000
126/126 - 23s - loss: 0.0040 - r1: 0.0068 - r5: 0.0226 - r10: 0.0383 - p5: 0.0045 - p10: 0.0038 - val_loss: 0.0036 - val_r1: 0.0205 - val_r5: 0.0529 - val_r10: 0.0765 - val_p5: 0.0106 - val_p10: 0.0076 - lr: 4.9852e-04 - 23s/epoch - 179ms/step
Epoch 4/1000
126/126 - 23s - loss: 0.0039 - r1: 0.0110 - r5: 0.0327 - r10: 0.0511 - p5: 0.0065 - p10: 0.0051 - val_loss: 0.0036 - val_r1: 0.0303 - val_r5: 0.0710 - val_r10: 0.0998 - val_p5: 0.0142 - val_p10: 0.0100 - lr: 4.9802e-04 - 23s/epoch - 179ms/step
Epoch 5/1000
126/126 - 23s - loss: 0.0038 - r1: 0.0210 - r5: 0.0527 - r10: 0.0758 - p5: 0.0105 - p10: 0.0076 - val_loss: 0.0034 - val_r1: 0.0495 - val_r5: 0.1127 - val_r10: 0.1491 - val_p5: 0.0225 - val_p10: 0.0149 - lr: 4.9753e-04 - 23s/epoch - 179ms/step
Epoch 6/1000
126/126 - 23s - loss: 0.0036 - r1: 0.0343 - r5: 0.0819 - r10: 0.1144 - p5: 0.0164 - p10: 0.0114 - val_loss: 0.0032 - val_r1: 0.0784 - val_r5: 0.1601 - val_r10: 0.2113 - val_p5: 0.0320 - val_p10: 0.0211 - lr: 4.9703e-04 - 23s/epoch - 179ms/step
Epoch 7/1000
126/126 - 23s - loss: 0.0035 - r1: 0.0500 - r5: 0.1121 - r10: 0.1531 - p5: 0.0224 - p10: 0.0153 - val_loss: 0.0031 - val_r1: 0.1049 - val_r5: 0.2094 - val_r10: 0.2711 - val_p5: 0.0419 - val_p10: 0.0271 - lr: 4.9654e-04 - 23s/epoch - 179ms/step
Epoch 8/1000
126/126 - 23s - loss: 0.0033 - r1: 0.0660 - r5: 0.1429 - r10: 0.1909 - p5: 0.0286 - p10: 0.0191 - val_loss: 0.0029 - val_r1: 0.1261 - val_r5: 0.2493 - val_r10: 0.3174 - val_p5: 0.0498 - val_p10: 0.0317 - lr: 4.9604e-04 - 23s/epoch - 179ms/step
Epoch 9/1000
126/126 - 23s - loss: 0.0032 - r1: 0.0791 - r5: 0.1690 - r10: 0.2220 - p5: 0.0338 - p10: 0.0222 - val_loss: 0.0028 - val_r1: 0.1437 - val_r5: 0.2786 - val_r10: 0.3552 - val_p5: 0.0557 - val_p10: 0.0355 - lr: 4.9555e-04 - 23s/epoch - 179ms/step
Epoch 10/1000
126/126 - 23s - loss: 0.0031 - r1: 0.0914 - r5: 0.1908 - r10: 0.2491 - p5: 0.0382 - p10: 0.0249 - val_loss: 0.0028 - val_r1: 0.1602 - val_r5: 0.3063 - val_r10: 0.3839 - val_p5: 0.0613 - val_p10: 0.0384 - lr: 4.9505e-04 - 23s/epoch - 179ms/step
Epoch 11/1000
126/126 - 23s - loss: 0.0031 - r1: 0.1029 - r5: 0.2096 - r10: 0.2705 - p5: 0.0419 - p10: 0.0270 - val_loss: 0.0027 - val_r1: 0.1713 - val_r5: 0.3273 - val_r10: 0.4078 - val_p5: 0.0655 - val_p10: 0.0408 - lr: 4.9456e-04 - 23s/epoch - 179ms/step
Epoch 12/1000
126/126 - 23s - loss: 0.0030 - r1: 0.1130 - r5: 0.2262 - r10: 0.2891 - p5: 0.0452 - p10: 0.0289 - val_loss: 0.0026 - val_r1: 0.1834 - val_r5: 0.3446 - val_r10: 0.4257 - val_p5: 0.0689 - val_p10: 0.0426 - lr: 4.9406e-04 - 23s/epoch - 179ms/step
Epoch 13/1000
126/126 - 23s - loss: 0.0030 - r1: 0.1208 - r5: 0.2401 - r10: 0.3054 - p5: 0.0480 - p10: 0.0305 - val_loss: 0.0026 - val_r1: 0.1945 - val_r5: 0.3577 - val_r10: 0.4397 - val_p5: 0.0715 - val_p10: 0.0440 - lr: 4.9357e-04 - 23s/epoch - 179ms/step
Epoch 14/1000
126/126 - 23s - loss: 0.0029 - r1: 0.1283 - r5: 0.2519 - r10: 0.3197 - p5: 0.0504 - p10: 0.0320 - val_loss: 0.0026 - val_r1: 0.2027 - val_r5: 0.3703 - val_r10: 0.4510 - val_p5: 0.0741 - val_p10: 0.0451 - lr: 4.9307e-04 - 23s/epoch - 179ms/step
Epoch 15/1000
126/126 - 23s - loss: 0.0029 - r1: 0.1362 - r5: 0.2635 - r10: 0.3314 - p5: 0.0527 - p10: 0.0331 - val_loss: 0.0025 - val_r1: 0.2110 - val_r5: 0.3807 - val_r10: 0.4615 - val_p5: 0.0761 - val_p10: 0.0462 - lr: 4.9258e-04 - 23s/epoch - 179ms/step
Epoch 16/1000
126/126 - 23s - loss: 0.0029 - r1: 0.1425 - r5: 0.2728 - r10: 0.3409 - p5: 0.0546 - p10: 0.0341 - val_loss: 0.0025 - val_r1: 0.2207 - val_r5: 0.3896 - val_r10: 0.4738 - val_p5: 0.0779 - val_p10: 0.0474 - lr: 4.9208e-04 - 23s/epoch - 179ms/step
Epoch 17/1000
126/126 - 23s - loss: 0.0028 - r1: 0.1489 - r5: 0.2812 - r10: 0.3506 - p5: 0.0562 - p10: 0.0351 - val_loss: 0.0025 - val_r1: 0.2271 - val_r5: 0.3966 - val_r10: 0.4804 - val_p5: 0.0793 - val_p10: 0.0480 - lr: 4.9159e-04 - 23s/epoch - 179ms/step
Epoch 18/1000
126/126 - 23s - loss: 0.0028 - r1: 0.1547 - r5: 0.2894 - r10: 0.3602 - p5: 0.0579 - p10: 0.0360 - val_loss: 0.0025 - val_r1: 0.2303 - val_r5: 0.4032 - val_r10: 0.4868 - val_p5: 0.0806 - val_p10: 0.0487 - lr: 4.9109e-04 - 23s/epoch - 179ms/step
Epoch 19/1000
126/126 - 23s - loss: 0.0028 - r1: 0.1591 - r5: 0.2967 - r10: 0.3682 - p5: 0.0594 - p10: 0.0368 - val_loss: 0.0025 - val_r1: 0.2374 - val_r5: 0.4126 - val_r10: 0.4946 - val_p5: 0.0825 - val_p10: 0.0495 - lr: 4.9060e-04 - 23s/epoch - 179ms/step
Epoch 20/1000
126/126 - 23s - loss: 0.0028 - r1: 0.1646 - r5: 0.3040 - r10: 0.3755 - p5: 0.0608 - p10: 0.0376 - val_loss: 0.0024 - val_r1: 0.2396 - val_r5: 0.4141 - val_r10: 0.4987 - val_p5: 0.0829 - val_p10: 0.0499 - lr: 4.9010e-04 - 23s/epoch - 179ms/step
Epoch 21/1000
126/126 - 23s - loss: 0.0027 - r1: 0.1686 - r5: 0.3101 - r10: 0.3819 - p5: 0.0620 - p10: 0.0382 - val_loss: 0.0024 - val_r1: 0.2414 - val_r5: 0.4160 - val_r10: 0.5015 - val_p5: 0.0832 - val_p10: 0.0501 - lr: 4.8961e-04 - 23s/epoch - 179ms/step
Epoch 22/1000
126/126 - 23s - loss: 0.0027 - r1: 0.1720 - r5: 0.3165 - r10: 0.3885 - p5: 0.0633 - p10: 0.0389 - val_loss: 0.0024 - val_r1: 0.2473 - val_r5: 0.4271 - val_r10: 0.5093 - val_p5: 0.0854 - val_p10: 0.0509 - lr: 4.8911e-04 - 23s/epoch - 179ms/step
Epoch 23/1000
126/126 - 23s - loss: 0.0027 - r1: 0.1768 - r5: 0.3216 - r10: 0.3934 - p5: 0.0643 - p10: 0.0393 - val_loss: 0.0024 - val_r1: 0.2474 - val_r5: 0.4279 - val_r10: 0.5097 - val_p5: 0.0856 - val_p10: 0.0510 - lr: 4.8862e-04 - 23s/epoch - 179ms/step
Epoch 24/1000
126/126 - 22s - loss: 0.0027 - r1: 0.1815 - r5: 0.3272 - r10: 0.4006 - p5: 0.0654 - p10: 0.0401 - val_loss: 0.0024 - val_r1: 0.2503 - val_r5: 0.4293 - val_r10: 0.5118 - val_p5: 0.0859 - val_p10: 0.0512 - lr: 4.8812e-04 - 22s/epoch - 175ms/step
Epoch 25/1000
126/126 - 23s - loss: 0.0027 - r1: 0.1852 - r5: 0.3328 - r10: 0.4051 - p5: 0.0666 - p10: 0.0405 - val_loss: 0.0024 - val_r1: 0.2539 - val_r5: 0.4367 - val_r10: 0.5163 - val_p5: 0.0873 - val_p10: 0.0516 - lr: 4.8763e-04 - 23s/epoch - 179ms/step
Epoch 26/1000
126/126 - 23s - loss: 0.0026 - r1: 0.1892 - r5: 0.3378 - r10: 0.4113 - p5: 0.0676 - p10: 0.0411 - val_loss: 0.0024 - val_r1: 0.2597 - val_r5: 0.4417 - val_r10: 0.5239 - val_p5: 0.0883 - val_p10: 0.0524 - lr: 4.8713e-04 - 23s/epoch - 179ms/step
Epoch 27/1000
126/126 - 22s - loss: 0.0026 - r1: 0.1930 - r5: 0.3429 - r10: 0.4163 - p5: 0.0686 - p10: 0.0416 - val_loss: 0.0024 - val_r1: 0.2614 - val_r5: 0.4439 - val_r10: 0.5241 - val_p5: 0.0888 - val_p10: 0.0524 - lr: 4.8664e-04 - 22s/epoch - 175ms/step
Epoch 28/1000
126/126 - 23s - loss: 0.0026 - r1: 0.1959 - r5: 0.3478 - r10: 0.4210 - p5: 0.0696 - p10: 0.0421 - val_loss: 0.0024 - val_r1: 0.2612 - val_r5: 0.4417 - val_r10: 0.5221 - val_p5: 0.0883 - val_p10: 0.0522 - lr: 4.8614e-04 - 23s/epoch - 179ms/step
Epoch 29/1000
126/126 - 23s - loss: 0.0026 - r1: 0.1995 - r5: 0.3525 - r10: 0.4263 - p5: 0.0705 - p10: 0.0426 - val_loss: 0.0024 - val_r1: 0.2648 - val_r5: 0.4433 - val_r10: 0.5252 - val_p5: 0.0887 - val_p10: 0.0525 - lr: 4.8565e-04 - 23s/epoch - 179ms/step
Epoch 30/1000
126/126 - 23s - loss: 0.0026 - r1: 0.2026 - r5: 0.3575 - r10: 0.4308 - p5: 0.0715 - p10: 0.0431 - val_loss: 0.0024 - val_r1: 0.2638 - val_r5: 0.4447 - val_r10: 0.5247 - val_p5: 0.0889 - val_p10: 0.0525 - lr: 4.8515e-04 - 23s/epoch - 179ms/step
Epoch 31/1000
126/126 - 22s - loss: 0.0026 - r1: 0.2059 - r5: 0.3600 - r10: 0.4353 - p5: 0.0720 - p10: 0.0435 - val_loss: 0.0024 - val_r1: 0.2634 - val_r5: 0.4411 - val_r10: 0.5219 - val_p5: 0.0882 - val_p10: 0.0522 - lr: 4.8466e-04 - 22s/epoch - 175ms/step
Epoch 32/1000
126/126 - 22s - loss: 0.0026 - r1: 0.2086 - r5: 0.3640 - r10: 0.4387 - p5: 0.0728 - p10: 0.0439 - val_loss: 0.0024 - val_r1: 0.2666 - val_r5: 0.4455 - val_r10: 0.5266 - val_p5: 0.0891 - val_p10: 0.0527 - lr: 4.8416e-04 - 22s/epoch - 175ms/step
Epoch 33/1000
126/126 - 23s - loss: 0.0026 - r1: 0.2116 - r5: 0.3682 - r10: 0.4422 - p5: 0.0736 - p10: 0.0442 - val_loss: 0.0024 - val_r1: 0.2673 - val_r5: 0.4506 - val_r10: 0.5303 - val_p5: 0.0901 - val_p10: 0.0530 - lr: 4.8367e-04 - 23s/epoch - 182ms/step
Epoch 34/1000
126/126 - 22s - loss: 0.0025 - r1: 0.2130 - r5: 0.3711 - r10: 0.4465 - p5: 0.0742 - p10: 0.0446 - val_loss: 0.0024 - val_r1: 0.2693 - val_r5: 0.4505 - val_r10: 0.5307 - val_p5: 0.0901 - val_p10: 0.0531 - lr: 4.8317e-04 - 22s/epoch - 175ms/step
Epoch 35/1000
126/126 - 23s - loss: 0.0025 - r1: 0.2168 - r5: 0.3754 - r10: 0.4493 - p5: 0.0751 - p10: 0.0449 - val_loss: 0.0023 - val_r1: 0.2730 - val_r5: 0.4521 - val_r10: 0.5324 - val_p5: 0.0904 - val_p10: 0.0532 - lr: 4.8268e-04 - 23s/epoch - 179ms/step
Epoch 36/1000
126/126 - 23s - loss: 0.0025 - r1: 0.2192 - r5: 0.3788 - r10: 0.4546 - p5: 0.0758 - p10: 0.0455 - val_loss: 0.0023 - val_r1: 0.2759 - val_r5: 0.4575 - val_r10: 0.5362 - val_p5: 0.0915 - val_p10: 0.0536 - lr: 4.8218e-04 - 23s/epoch - 179ms/step
Epoch 37/1000
126/126 - 23s - loss: 0.0025 - r1: 0.2216 - r5: 0.3822 - r10: 0.4582 - p5: 0.0764 - p10: 0.0458 - val_loss: 0.0023 - val_r1: 0.2749 - val_r5: 0.4538 - val_r10: 0.5326 - val_p5: 0.0908 - val_p10: 0.0533 - lr: 4.8169e-04 - 23s/epoch - 179ms/step
Epoch 38/1000
126/126 - 22s - loss: 0.0025 - r1: 0.2236 - r5: 0.3859 - r10: 0.4606 - p5: 0.0772 - p10: 0.0461 - val_loss: 0.0023 - val_r1: 0.2748 - val_r5: 0.4526 - val_r10: 0.5310 - val_p5: 0.0905 - val_p10: 0.0531 - lr: 4.8119e-04 - 22s/epoch - 175ms/step
Epoch 39/1000
126/126 - 23s - loss: 0.0025 - r1: 0.2278 - r5: 0.3883 - r10: 0.4633 - p5: 0.0776 - p10: 0.0463 - val_loss: 0.0023 - val_r1: 0.2788 - val_r5: 0.4583 - val_r10: 0.5359 - val_p5: 0.0917 - val_p10: 0.0536 - lr: 4.8070e-04 - 23s/epoch - 179ms/step
Epoch 40/1000
126/126 - 23s - loss: 0.0025 - r1: 0.2273 - r5: 0.3904 - r10: 0.4655 - p5: 0.0781 - p10: 0.0466 - val_loss: 0.0023 - val_r1: 0.2797 - val_r5: 0.4616 - val_r10: 0.5395 - val_p5: 0.0923 - val_p10: 0.0540 - lr: 4.8020e-04 - 23s/epoch - 179ms/step
Epoch 41/1000
126/126 - 22s - loss: 0.0025 - r1: 0.2306 - r5: 0.3947 - r10: 0.4700 - p5: 0.0789 - p10: 0.0470 - val_loss: 0.0023 - val_r1: 0.2811 - val_r5: 0.4620 - val_r10: 0.5405 - val_p5: 0.0924 - val_p10: 0.0541 - lr: 4.7971e-04 - 22s/epoch - 175ms/step
Epoch 42/1000
126/126 - 22s - loss: 0.0024 - r1: 0.2321 - r5: 0.3962 - r10: 0.4726 - p5: 0.0793 - p10: 0.0473 - val_loss: 0.0023 - val_r1: 0.2793 - val_r5: 0.4641 - val_r10: 0.5414 - val_p5: 0.0928 - val_p10: 0.0541 - lr: 4.7921e-04 - 22s/epoch - 175ms/step
Epoch 43/1000
126/126 - 22s - loss: 0.0024 - r1: 0.2343 - r5: 0.3990 - r10: 0.4749 - p5: 0.0798 - p10: 0.0475 - val_loss: 0.0023 - val_r1: 0.2820 - val_r5: 0.4636 - val_r10: 0.5445 - val_p5: 0.0927 - val_p10: 0.0544 - lr: 4.7872e-04 - 22s/epoch - 175ms/step
Epoch 44/1000
126/126 - 22s - loss: 0.0024 - r1: 0.2362 - r5: 0.4015 - r10: 0.4771 - p5: 0.0803 - p10: 0.0477 - val_loss: 0.0023 - val_r1: 0.2829 - val_r5: 0.4624 - val_r10: 0.5417 - val_p5: 0.0925 - val_p10: 0.0542 - lr: 4.7822e-04 - 22s/epoch - 175ms/step
Epoch 45/1000
126/126 - 22s - loss: 0.0024 - r1: 0.2367 - r5: 0.4029 - r10: 0.4787 - p5: 0.0806 - p10: 0.0479 - val_loss: 0.0023 - val_r1: 0.2794 - val_r5: 0.4607 - val_r10: 0.5403 - val_p5: 0.0922 - val_p10: 0.0540 - lr: 4.7773e-04 - 22s/epoch - 175ms/step
Epoch 46/1000
126/126 - 22s - loss: 0.0024 - r1: 0.2379 - r5: 0.4026 - r10: 0.4795 - p5: 0.0805 - p10: 0.0480 - val_loss: 0.0023 - val_r1: 0.2826 - val_r5: 0.4620 - val_r10: 0.5438 - val_p5: 0.0924 - val_p10: 0.0544 - lr: 4.7723e-04 - 22s/epoch - 175ms/step
Epoch 47/1000
126/126 - 22s - loss: 0.0024 - r1: 0.2400 - r5: 0.4068 - r10: 0.4832 - p5: 0.0814 - p10: 0.0483 - val_loss: 0.0023 - val_r1: 0.2838 - val_r5: 0.4646 - val_r10: 0.5431 - val_p5: 0.0929 - val_p10: 0.0543 - lr: 4.7674e-04 - 22s/epoch - 175ms/step
Epoch 48/1000
126/126 - 22s - loss: 0.0024 - r1: 0.2432 - r5: 0.4100 - r10: 0.4858 - p5: 0.0820 - p10: 0.0486 - val_loss: 0.0023 - val_r1: 0.2816 - val_r5: 0.4621 - val_r10: 0.5409 - val_p5: 0.0924 - val_p10: 0.0541 - lr: 4.7624e-04 - 22s/epoch - 175ms/step
Epoch 49/1000
126/126 - 22s - loss: 0.0024 - r1: 0.2433 - r5: 0.4107 - r10: 0.4868 - p5: 0.0821 - p10: 0.0487 - val_loss: 0.0023 - val_r1: 0.2826 - val_r5: 0.4632 - val_r10: 0.5424 - val_p5: 0.0926 - val_p10: 0.0542 - lr: 4.7575e-04 - 22s/epoch - 175ms/step
Epoch 50/1000
126/126 - 22s - loss: 0.0024 - r1: 0.2451 - r5: 0.4128 - r10: 0.4888 - p5: 0.0826 - p10: 0.0489 - val_loss: 0.0023 - val_r1: 0.2848 - val_r5: 0.4664 - val_r10: 0.5448 - val_p5: 0.0933 - val_p10: 0.0545 - lr: 4.7525e-04 - 22s/epoch - 175ms/step
Epoch 51/1000
126/126 - 22s - loss: 0.0024 - r1: 0.2452 - r5: 0.4133 - r10: 0.4900 - p5: 0.0827 - p10: 0.0490 - val_loss: 0.0023 - val_r1: 0.2849 - val_r5: 0.4666 - val_r10: 0.5420 - val_p5: 0.0933 - val_p10: 0.0542 - lr: 4.7476e-04 - 22s/epoch - 175ms/step
Epoch 52/1000
126/126 - 22s - loss: 0.0024 - r1: 0.2488 - r5: 0.4169 - r10: 0.4937 - p5: 0.0834 - p10: 0.0494 - val_loss: 0.0024 - val_r1: 0.2853 - val_r5: 0.4671 - val_r10: 0.5442 - val_p5: 0.0934 - val_p10: 0.0544 - lr: 4.7426e-04 - 22s/epoch - 175ms/step
Epoch 53/1000
126/126 - 22s - loss: 0.0024 - r1: 0.2492 - r5: 0.4183 - r10: 0.4954 - p5: 0.0837 - p10: 0.0495 - val_loss: 0.0023 - val_r1: 0.2877 - val_r5: 0.4691 - val_r10: 0.5462 - val_p5: 0.0938 - val_p10: 0.0546 - lr: 4.7377e-04 - 22s/epoch - 175ms/step
Epoch 54/1000
126/126 - 22s - loss: 0.0024 - r1: 0.2508 - r5: 0.4208 - r10: 0.4973 - p5: 0.0842 - p10: 0.0497 - val_loss: 0.0023 - val_r1: 0.2879 - val_r5: 0.4710 - val_r10: 0.5487 - val_p5: 0.0942 - val_p10: 0.0549 - lr: 4.7327e-04 - 22s/epoch - 175ms/step
Epoch 55/1000
126/126 - 22s - loss: 0.0024 - r1: 0.2520 - r5: 0.4217 - r10: 0.4992 - p5: 0.0844 - p10: 0.0499 - val_loss: 0.0023 - val_r1: 0.2896 - val_r5: 0.4684 - val_r10: 0.5487 - val_p5: 0.0937 - val_p10: 0.0549 - lr: 4.7278e-04 - 22s/epoch - 175ms/step
Epoch 56/1000
126/126 - 22s - loss: 0.0024 - r1: 0.2526 - r5: 0.4225 - r10: 0.4996 - p5: 0.0845 - p10: 0.0500 - val_loss: 0.0023 - val_r1: 0.2879 - val_r5: 0.4681 - val_r10: 0.5465 - val_p5: 0.0936 - val_p10: 0.0546 - lr: 4.7228e-04 - 22s/epoch - 175ms/step
Epoch 57/1000
126/126 - 22s - loss: 0.0023 - r1: 0.2544 - r5: 0.4242 - r10: 0.5000 - p5: 0.0848 - p10: 0.0500 - val_loss: 0.0023 - val_r1: 0.2849 - val_r5: 0.4670 - val_r10: 0.5437 - val_p5: 0.0934 - val_p10: 0.0544 - lr: 4.7179e-04 - 22s/epoch - 175ms/step
Epoch 58/1000
126/126 - 22s - loss: 0.0023 - r1: 0.2547 - r5: 0.4266 - r10: 0.5029 - p5: 0.0853 - p10: 0.0503 - val_loss: 0.0023 - val_r1: 0.2915 - val_r5: 0.4718 - val_r10: 0.5499 - val_p5: 0.0944 - val_p10: 0.0550 - lr: 4.7129e-04 - 22s/epoch - 175ms/step
Epoch 59/1000
126/126 - 22s - loss: 0.0023 - r1: 0.2568 - r5: 0.4277 - r10: 0.5046 - p5: 0.0855 - p10: 0.0505 - val_loss: 0.0023 - val_r1: 0.2900 - val_r5: 0.4667 - val_r10: 0.5432 - val_p5: 0.0934 - val_p10: 0.0543 - lr: 4.7080e-04 - 22s/epoch - 175ms/step
Epoch 60/1000
126/126 - 22s - loss: 0.0023 - r1: 0.2574 - r5: 0.4284 - r10: 0.5054 - p5: 0.0857 - p10: 0.0505 - val_loss: 0.0024 - val_r1: 0.2889 - val_r5: 0.4682 - val_r10: 0.5450 - val_p5: 0.0936 - val_p10: 0.0545 - lr: 4.7030e-04 - 22s/epoch - 175ms/step
Epoch 61/1000
126/126 - 22s - loss: 0.0023 - r1: 0.2585 - r5: 0.4300 - r10: 0.5074 - p5: 0.0860 - p10: 0.0507 - val_loss: 0.0023 - val_r1: 0.2890 - val_r5: 0.4689 - val_r10: 0.5475 - val_p5: 0.0938 - val_p10: 0.0548 - lr: 4.6981e-04 - 22s/epoch - 175ms/step
Epoch 62/1000
126/126 - 22s - loss: 0.0023 - r1: 0.2606 - r5: 0.4335 - r10: 0.5099 - p5: 0.0867 - p10: 0.0510 - val_loss: 0.0024 - val_r1: 0.2916 - val_r5: 0.4714 - val_r10: 0.5482 - val_p5: 0.0943 - val_p10: 0.0548 - lr: 4.6931e-04 - 22s/epoch - 175ms/step
Epoch 63/1000
126/126 - 22s - loss: 0.0023 - r1: 0.2610 - r5: 0.4347 - r10: 0.5107 - p5: 0.0869 - p10: 0.0511 - val_loss: 0.0023 - val_r1: 0.2921 - val_r5: 0.4741 - val_r10: 0.5522 - val_p5: 0.0948 - val_p10: 0.0552 - lr: 4.6882e-04 - 22s/epoch - 175ms/step
Epoch 64/1000
126/126 - 22s - loss: 0.0023 - r1: 0.2619 - r5: 0.4364 - r10: 0.5130 - p5: 0.0873 - p10: 0.0513 - val_loss: 0.0023 - val_r1: 0.2948 - val_r5: 0.4755 - val_r10: 0.5503 - val_p5: 0.0951 - val_p10: 0.0550 - lr: 4.6832e-04 - 22s/epoch - 175ms/step
Epoch 65/1000
126/126 - 22s - loss: 0.0023 - r1: 0.2643 - r5: 0.4377 - r10: 0.5145 - p5: 0.0875 - p10: 0.0514 - val_loss: 0.0023 - val_r1: 0.2924 - val_r5: 0.4729 - val_r10: 0.5505 - val_p5: 0.0946 - val_p10: 0.0550 - lr: 4.6783e-04 - 22s/epoch - 175ms/step
Epoch 66/1000
126/126 - 22s - loss: 0.0023 - r1: 0.2656 - r5: 0.4380 - r10: 0.5156 - p5: 0.0876 - p10: 0.0516 - val_loss: 0.0023 - val_r1: 0.2939 - val_r5: 0.4736 - val_r10: 0.5504 - val_p5: 0.0947 - val_p10: 0.0550 - lr: 4.6733e-04 - 22s/epoch - 175ms/step
Epoch 67/1000
126/126 - 22s - loss: 0.0023 - r1: 0.2662 - r5: 0.4396 - r10: 0.5160 - p5: 0.0879 - p10: 0.0516 - val_loss: 0.0023 - val_r1: 0.2894 - val_r5: 0.4715 - val_r10: 0.5474 - val_p5: 0.0943 - val_p10: 0.0547 - lr: 4.6684e-04 - 22s/epoch - 175ms/step
Epoch 68/1000
126/126 - 22s - loss: 0.0023 - r1: 0.2660 - r5: 0.4408 - r10: 0.5174 - p5: 0.0882 - p10: 0.0517 - val_loss: 0.0023 - val_r1: 0.2924 - val_r5: 0.4703 - val_r10: 0.5480 - val_p5: 0.0941 - val_p10: 0.0548 - lr: 4.6634e-04 - 22s/epoch - 175ms/step
Epoch 69/1000
126/126 - 22s - loss: 0.0023 - r1: 0.2678 - r5: 0.4415 - r10: 0.5184 - p5: 0.0883 - p10: 0.0518 - val_loss: 0.0024 - val_r1: 0.2918 - val_r5: 0.4711 - val_r10: 0.5481 - val_p5: 0.0942 - val_p10: 0.0548 - lr: 4.6585e-04 - 22s/epoch - 175ms/step
Epoch 70/1000
126/126 - 22s - loss: 0.0023 - r1: 0.2685 - r5: 0.4434 - r10: 0.5208 - p5: 0.0887 - p10: 0.0521 - val_loss: 0.0024 - val_r1: 0.2905 - val_r5: 0.4707 - val_r10: 0.5469 - val_p5: 0.0941 - val_p10: 0.0547 - lr: 4.6535e-04 - 22s/epoch - 175ms/step
Epoch 71/1000
126/126 - 22s - loss: 0.0023 - r1: 0.2701 - r5: 0.4447 - r10: 0.5213 - p5: 0.0889 - p10: 0.0521 - val_loss: 0.0024 - val_r1: 0.2945 - val_r5: 0.4717 - val_r10: 0.5497 - val_p5: 0.0943 - val_p10: 0.0550 - lr: 4.6486e-04 - 22s/epoch - 175ms/step
Epoch 72/1000
126/126 - 22s - loss: 0.0023 - r1: 0.2707 - r5: 0.4459 - r10: 0.5228 - p5: 0.0892 - p10: 0.0523 - val_loss: 0.0024 - val_r1: 0.2957 - val_r5: 0.4730 - val_r10: 0.5505 - val_p5: 0.0946 - val_p10: 0.0550 - lr: 4.6436e-04 - 22s/epoch - 175ms/step
Epoch 73/1000
126/126 - 22s - loss: 0.0023 - r1: 0.2715 - r5: 0.4471 - r10: 0.5244 - p5: 0.0894 - p10: 0.0524 - val_loss: 0.0024 - val_r1: 0.2924 - val_r5: 0.4721 - val_r10: 0.5464 - val_p5: 0.0944 - val_p10: 0.0546 - lr: 4.6387e-04 - 22s/epoch - 175ms/step
Epoch 74/1000
126/126 - 22s - loss: 0.0023 - r1: 0.2715 - r5: 0.4467 - r10: 0.5246 - p5: 0.0893 - p10: 0.0525 - val_loss: 0.0024 - val_r1: 0.2930 - val_r5: 0.4719 - val_r10: 0.5486 - val_p5: 0.0944 - val_p10: 0.0549 - lr: 4.6337e-04 - 22s/epoch - 175ms/step
Epoch 75/1000
126/126 - 22s - loss: 0.0022 - r1: 0.2733 - r5: 0.4492 - r10: 0.5268 - p5: 0.0898 - p10: 0.0527 - val_loss: 0.0024 - val_r1: 0.2934 - val_r5: 0.4730 - val_r10: 0.5496 - val_p5: 0.0946 - val_p10: 0.0550 - lr: 4.6288e-04 - 22s/epoch - 175ms/step
Epoch 76/1000
126/126 - 22s - loss: 0.0022 - r1: 0.2744 - r5: 0.4500 - r10: 0.5284 - p5: 0.0900 - p10: 0.0528 - val_loss: 0.0024 - val_r1: 0.2921 - val_r5: 0.4704 - val_r10: 0.5458 - val_p5: 0.0941 - val_p10: 0.0546 - lr: 4.6238e-04 - 22s/epoch - 175ms/step
Epoch 77/1000
126/126 - 22s - loss: 0.0022 - r1: 0.2752 - r5: 0.4515 - r10: 0.5291 - p5: 0.0903 - p10: 0.0529 - val_loss: 0.0024 - val_r1: 0.2935 - val_r5: 0.4719 - val_r10: 0.5485 - val_p5: 0.0943 - val_p10: 0.0549 - lr: 4.6189e-04 - 22s/epoch - 175ms/step
Epoch 78/1000
126/126 - 22s - loss: 0.0022 - r1: 0.2761 - r5: 0.4521 - r10: 0.5283 - p5: 0.0904 - p10: 0.0528 - val_loss: 0.0024 - val_r1: 0.2927 - val_r5: 0.4717 - val_r10: 0.5485 - val_p5: 0.0943 - val_p10: 0.0549 - lr: 4.6139e-04 - 22s/epoch - 175ms/step
Epoch 79/1000
126/126 - 22s - loss: 0.0022 - r1: 0.2778 - r5: 0.4531 - r10: 0.5307 - p5: 0.0906 - p10: 0.0531 - val_loss: 0.0024 - val_r1: 0.2942 - val_r5: 0.4744 - val_r10: 0.5519 - val_p5: 0.0949 - val_p10: 0.0552 - lr: 4.6090e-04 - 22s/epoch - 175ms/step
Epoch 80/1000
126/126 - 22s - loss: 0.0022 - r1: 0.2778 - r5: 0.4544 - r10: 0.5323 - p5: 0.0909 - p10: 0.0532 - val_loss: 0.0024 - val_r1: 0.2956 - val_r5: 0.4746 - val_r10: 0.5502 - val_p5: 0.0949 - val_p10: 0.0550 - lr: 4.6040e-04 - 22s/epoch - 175ms/step
Epoch 81/1000
126/126 - 22s - loss: 0.0022 - r1: 0.2780 - r5: 0.4555 - r10: 0.5317 - p5: 0.0911 - p10: 0.0532 - val_loss: 0.0024 - val_r1: 0.2944 - val_r5: 0.4735 - val_r10: 0.5502 - val_p5: 0.0947 - val_p10: 0.0550 - lr: 4.5991e-04 - 22s/epoch - 175ms/step
Epoch 82/1000
126/126 - 22s - loss: 0.0022 - r1: 0.2795 - r5: 0.4551 - r10: 0.5328 - p5: 0.0910 - p10: 0.0533 - val_loss: 0.0024 - val_r1: 0.2951 - val_r5: 0.4733 - val_r10: 0.5494 - val_p5: 0.0946 - val_p10: 0.0550 - lr: 4.5941e-04 - 22s/epoch - 175ms/step
Epoch 83/1000
126/126 - 22s - loss: 0.0022 - r1: 0.2808 - r5: 0.4568 - r10: 0.5336 - p5: 0.0914 - p10: 0.0534 - val_loss: 0.0024 - val_r1: 0.2930 - val_r5: 0.4714 - val_r10: 0.5480 - val_p5: 0.0943 - val_p10: 0.0548 - lr: 4.5892e-04 - 22s/epoch - 175ms/step
Epoch 84/1000
126/126 - 22s - loss: 0.0022 - r1: 0.2816 - r5: 0.4594 - r10: 0.5353 - p5: 0.0919 - p10: 0.0535 - val_loss: 0.0024 - val_r1: 0.2953 - val_r5: 0.4730 - val_r10: 0.5481 - val_p5: 0.0946 - val_p10: 0.0548 - lr: 4.5842e-04 - 22s/epoch - 175ms/step
Epoch 85/1000
126/126 - 22s - loss: 0.0022 - r1: 0.2821 - r5: 0.4603 - r10: 0.5376 - p5: 0.0921 - p10: 0.0538 - val_loss: 0.0024 - val_r1: 0.2941 - val_r5: 0.4724 - val_r10: 0.5504 - val_p5: 0.0945 - val_p10: 0.0550 - lr: 4.5793e-04 - 22s/epoch - 175ms/step
Epoch 86/1000
126/126 - 22s - loss: 0.0022 - r1: 0.2822 - r5: 0.4600 - r10: 0.5370 - p5: 0.0920 - p10: 0.0537 - val_loss: 0.0024 - val_r1: 0.2965 - val_r5: 0.4744 - val_r10: 0.5530 - val_p5: 0.0949 - val_p10: 0.0553 - lr: 4.5743e-04 - 22s/epoch - 175ms/step
Epoch 87/1000
126/126 - 22s - loss: 0.0022 - r1: 0.2831 - r5: 0.4624 - r10: 0.5395 - p5: 0.0925 - p10: 0.0540 - val_loss: 0.0024 - val_r1: 0.2953 - val_r5: 0.4737 - val_r10: 0.5527 - val_p5: 0.0947 - val_p10: 0.0553 - lr: 4.5694e-04 - 22s/epoch - 175ms/step
Epoch 88/1000
126/126 - 22s - loss: 0.0022 - r1: 0.2848 - r5: 0.4620 - r10: 0.5389 - p5: 0.0924 - p10: 0.0539 - val_loss: 0.0023 - val_r1: 0.2990 - val_r5: 0.4770 - val_r10: 0.5558 - val_p5: 0.0954 - val_p10: 0.0556 - lr: 4.5644e-04 - 22s/epoch - 175ms/step
Epoch 89/1000
126/126 - 22s - loss: 0.0022 - r1: 0.2848 - r5: 0.4639 - r10: 0.5413 - p5: 0.0928 - p10: 0.0541 - val_loss: 0.0023 - val_r1: 0.2958 - val_r5: 0.4755 - val_r10: 0.5534 - val_p5: 0.0951 - val_p10: 0.0553 - lr: 4.5595e-04 - 22s/epoch - 175ms/step
Epoch 90/1000
126/126 - 22s - loss: 0.0022 - r1: 0.2856 - r5: 0.4648 - r10: 0.5415 - p5: 0.0930 - p10: 0.0541 - val_loss: 0.0023 - val_r1: 0.2979 - val_r5: 0.4780 - val_r10: 0.5551 - val_p5: 0.0956 - val_p10: 0.0555 - lr: 4.5545e-04 - 22s/epoch - 175ms/step
Epoch 90: early stopping
[92m[INFO] Loading best model...[0m
[93m[WARNING] Model folder already exists...[0m
Model: "ATT2ITM_1"
__________________________________________________________________________________________________
 Layer (type)                   Output Shape         Param #     Connected to                     
==================================================================================================
 input_1 (InputLayer)           [(None, 172)]        0           []                               
                                                                                                  
 input_2 (InputLayer)           [(None, 1322)]       0           []                               
                                                                                                  
 embedding (Embedding)          (None, 172, 384)     3389952     ['input_1[0][0]']                
                                                                                                  
 in_rsts (Embedding)            (None, 1322, 384)    507648      ['input_2[0][0]']                
                                                                                                  
 dense (Dense)                  (None, 172, 256)     98560       ['embedding[0][0]']              
                                                                                                  
 dense_2 (Dense)                (None, 1322, 256)    98560       ['in_rsts[0][0]']                
                                                                                                  
 tf.math.not_equal (TFOpLambda)  (None, 172)         0           ['input_1[0][0]']                
                                                                                                  
 dense_1 (Dense)                (None, 172, 128)     32896       ['dense[0][0]']                  
                                                                                                  
 dense_3 (Dense)                (None, 1322, 128)    32896       ['dense_2[0][0]']                
                                                                                                  
 tf.cast (TFOpLambda)           (None, 172)          0           ['tf.math.not_equal[0][0]']      
                                                                                                  
 word_emb (Lambda)              (None, 172, 128)     0           ['dense_1[0][0]']                
                                                                                                  
 rest_emb (Lambda)              (None, 1322, 128)    0           ['dense_3[0][0]']                
                                                                                                  
 tf.expand_dims (TFOpLambda)    (None, 172, 1)       0           ['tf.cast[0][0]']                
                                                                                                  
 lambda (Lambda)                (None, 172, 1322)    0           ['word_emb[0][0]',               
                                                                  'rest_emb[0][0]']               
                                                                                                  
 tf.tile (TFOpLambda)           (None, 172, 1322)    0           ['tf.expand_dims[0][0]']         
                                                                                                  
 lambda_1 (Lambda)              (None, 172, 1322)    0           ['lambda[0][0]',                 
                                                                  'tf.tile[0][0]']                
                                                                                                  
 dotprod (Activation)           (None, 172, 1322)    0           ['lambda_1[0][0]']               
                                                                                                  
 dropout (Dropout)              (None, 172, 1322)    0           ['dotprod[0][0]']                
                                                                                                  
 sum (Lambda)                   (None, 1322)         0           ['dropout[0][0]']                
                                                                                                  
 out (Activation)               (None, 1322)         0           ['sum[0][0]']                    
                                                                                                  
==================================================================================================
Total params: 4,160,512
Trainable params: 4,160,512
Non-trainable params: 0
__________________________________________________________________________________________________
None
[92m[INFO] Model already trained. Loading weights...[0m
