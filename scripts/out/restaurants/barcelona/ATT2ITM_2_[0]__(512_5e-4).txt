Using TensorFlow backend
Epoch 1/1000
502/502 - 27s - loss: 5.7756 - NDCG@10: 0.1588 - r1: 0.0879 - r5: 0.1875 - r10: 0.2486 - p5: 0.0375 - p10: 0.0249 - f1: 0.0057 - val_loss: 4.7392 - val_NDCG@10: 0.3146 - val_r1: 0.1961 - val_r5: 0.3686 - val_r10: 0.4569 - val_p5: 0.0737 - val_p10: 0.0457 - val_f1: 0.0092 - lr: 4.9951e-04 - e_time: 26.0006 - 27s/epoch - 53ms/step
Epoch 2/1000
502/502 - 23s - loss: 4.7751 - NDCG@10: 0.2858 - r1: 0.1787 - r5: 0.3343 - r10: 0.4152 - p5: 0.0669 - p10: 0.0415 - f1: 0.0107 - val_loss: 4.4297 - val_NDCG@10: 0.3573 - val_r1: 0.2394 - val_r5: 0.4117 - val_r10: 0.4964 - val_p5: 0.0824 - val_p10: 0.0496 - val_f1: 0.0139 - lr: 4.9901e-04 - e_time: 22.2125 - 23s/epoch - 45ms/step
Epoch 3/1000
502/502 - 23s - loss: 4.4736 - NDCG@10: 0.3287 - r1: 0.2148 - r5: 0.3829 - r10: 0.4636 - p5: 0.0766 - p10: 0.0464 - f1: 0.0123 - val_loss: 4.2761 - val_NDCG@10: 0.3777 - val_r1: 0.2607 - val_r5: 0.4329 - val_r10: 0.5146 - val_p5: 0.0866 - val_p10: 0.0515 - val_f1: 0.0149 - lr: 4.9852e-04 - e_time: 22.2577 - 23s/epoch - 45ms/step
Epoch 4/1000
502/502 - 23s - loss: 4.2835 - NDCG@10: 0.3563 - r1: 0.2382 - r5: 0.4130 - r10: 0.4946 - p5: 0.0826 - p10: 0.0495 - f1: 0.0137 - val_loss: 4.1953 - val_NDCG@10: 0.3890 - val_r1: 0.2727 - val_r5: 0.4446 - val_r10: 0.5247 - val_p5: 0.0889 - val_p10: 0.0525 - val_f1: 0.0173 - lr: 4.9802e-04 - e_time: 22.2295 - 23s/epoch - 45ms/step
Epoch 5/1000
502/502 - 23s - loss: 4.1549 - NDCG@10: 0.3745 - r1: 0.2539 - r5: 0.4321 - r10: 0.5150 - p5: 0.0864 - p10: 0.0515 - f1: 0.0143 - val_loss: 4.0318 - val_NDCG@10: 0.4133 - val_r1: 0.2945 - val_r5: 0.4727 - val_r10: 0.5505 - val_p5: 0.0945 - val_p10: 0.0551 - val_f1: 0.0187 - lr: 4.9753e-04 - e_time: 22.2490 - 23s/epoch - 45ms/step
Epoch 6/1000
502/502 - 22s - loss: 4.0493 - NDCG@10: 0.3892 - r1: 0.2673 - r5: 0.4481 - r10: 0.5311 - p5: 0.0896 - p10: 0.0531 - f1: 0.0150 - val_loss: 4.0526 - val_NDCG@10: 0.4094 - val_r1: 0.2921 - val_r5: 0.4664 - val_r10: 0.5445 - val_p5: 0.0933 - val_p10: 0.0544 - val_f1: 0.0195 - lr: 4.9703e-04 - e_time: 22.2463 - 22s/epoch - 44ms/step
Epoch 7/1000
502/502 - 23s - loss: 3.9565 - NDCG@10: 0.4026 - r1: 0.2788 - r5: 0.4626 - r10: 0.5454 - p5: 0.0925 - p10: 0.0545 - f1: 0.0154 - val_loss: 4.0194 - val_NDCG@10: 0.4137 - val_r1: 0.2963 - val_r5: 0.4698 - val_r10: 0.5483 - val_p5: 0.0940 - val_p10: 0.0548 - val_f1: 0.0194 - lr: 4.9654e-04 - e_time: 22.2430 - 23s/epoch - 45ms/step
Epoch 8/1000
502/502 - 23s - loss: 3.8880 - NDCG@10: 0.4112 - r1: 0.2859 - r5: 0.4721 - r10: 0.5560 - p5: 0.0944 - p10: 0.0556 - f1: 0.0159 - val_loss: 4.0154 - val_NDCG@10: 0.4144 - val_r1: 0.2968 - val_r5: 0.4727 - val_r10: 0.5495 - val_p5: 0.0945 - val_p10: 0.0550 - val_f1: 0.0207 - lr: 4.9604e-04 - e_time: 22.2738 - 23s/epoch - 45ms/step
Epoch 9/1000
502/502 - 23s - loss: 3.8167 - NDCG@10: 0.4222 - r1: 0.2954 - r5: 0.4848 - r10: 0.5678 - p5: 0.0970 - p10: 0.0568 - f1: 0.0165 - val_loss: 3.8886 - val_NDCG@10: 0.4326 - val_r1: 0.3145 - val_r5: 0.4915 - val_r10: 0.5685 - val_p5: 0.0983 - val_p10: 0.0568 - val_f1: 0.0183 - lr: 4.9555e-04 - e_time: 22.2737 - 23s/epoch - 45ms/step
Epoch 10/1000
502/502 - 22s - loss: 3.7573 - NDCG@10: 0.4303 - r1: 0.3026 - r5: 0.4939 - r10: 0.5765 - p5: 0.0988 - p10: 0.0576 - f1: 0.0165 - val_loss: 3.9304 - val_NDCG@10: 0.4272 - val_r1: 0.3098 - val_r5: 0.4830 - val_r10: 0.5619 - val_p5: 0.0966 - val_p10: 0.0562 - val_f1: 0.0203 - lr: 4.9505e-04 - e_time: 22.2635 - 22s/epoch - 44ms/step
Epoch 11/1000
502/502 - 22s - loss: 3.7049 - NDCG@10: 0.4375 - r1: 0.3087 - r5: 0.5021 - r10: 0.5846 - p5: 0.1004 - p10: 0.0585 - f1: 0.0170 - val_loss: 3.9437 - val_NDCG@10: 0.4257 - val_r1: 0.3090 - val_r5: 0.4827 - val_r10: 0.5589 - val_p5: 0.0965 - val_p10: 0.0559 - val_f1: 0.0197 - lr: 4.9456e-04 - e_time: 22.2337 - 22s/epoch - 44ms/step
Epoch 12/1000
502/502 - 22s - loss: 3.6569 - NDCG@10: 0.4448 - r1: 0.3153 - r5: 0.5097 - r10: 0.5924 - p5: 0.1019 - p10: 0.0592 - f1: 0.0175 - val_loss: 3.9610 - val_NDCG@10: 0.4245 - val_r1: 0.3093 - val_r5: 0.4813 - val_r10: 0.5562 - val_p5: 0.0963 - val_p10: 0.0556 - val_f1: 0.0200 - lr: 4.9406e-04 - e_time: 22.2604 - 22s/epoch - 44ms/step
Epoch 13/1000
502/502 - 23s - loss: 3.6124 - NDCG@10: 0.4519 - r1: 0.3223 - r5: 0.5166 - r10: 0.5992 - p5: 0.1033 - p10: 0.0599 - f1: 0.0178 - val_loss: 3.8617 - val_NDCG@10: 0.4380 - val_r1: 0.3207 - val_r5: 0.4958 - val_r10: 0.5720 - val_p5: 0.0991 - val_p10: 0.0572 - val_f1: 0.0219 - lr: 4.9357e-04 - e_time: 22.2217 - 23s/epoch - 45ms/step
Epoch 14/1000
502/502 - 22s - loss: 3.5711 - NDCG@10: 0.4567 - r1: 0.3264 - r5: 0.5222 - r10: 0.6047 - p5: 0.1044 - p10: 0.0605 - f1: 0.0180 - val_loss: 3.9617 - val_NDCG@10: 0.4228 - val_r1: 0.3070 - val_r5: 0.4807 - val_r10: 0.5553 - val_p5: 0.0962 - val_p10: 0.0555 - val_f1: 0.0205 - lr: 4.9307e-04 - e_time: 22.2941 - 22s/epoch - 44ms/step
Epoch 15/1000
502/502 - 22s - loss: 3.5256 - NDCG@10: 0.4639 - r1: 0.3328 - r5: 0.5300 - r10: 0.6121 - p5: 0.1060 - p10: 0.0612 - f1: 0.0180 - val_loss: 3.9046 - val_NDCG@10: 0.4315 - val_r1: 0.3155 - val_r5: 0.4891 - val_r10: 0.5642 - val_p5: 0.0978 - val_p10: 0.0564 - val_f1: 0.0218 - lr: 4.9258e-04 - e_time: 22.2875 - 22s/epoch - 44ms/step
Epoch 16/1000
502/502 - 22s - loss: 3.4957 - NDCG@10: 0.4676 - r1: 0.3353 - r5: 0.5349 - r10: 0.6169 - p5: 0.1070 - p10: 0.0617 - f1: 0.0184 - val_loss: 3.9438 - val_NDCG@10: 0.4274 - val_r1: 0.3107 - val_r5: 0.4853 - val_r10: 0.5608 - val_p5: 0.0971 - val_p10: 0.0561 - val_f1: 0.0204 - lr: 4.9208e-04 - e_time: 22.2700 - 22s/epoch - 44ms/step
Epoch 17/1000
502/502 - 22s - loss: 3.4689 - NDCG@10: 0.4724 - r1: 0.3394 - r5: 0.5403 - r10: 0.6222 - p5: 0.1081 - p10: 0.0622 - f1: 0.0187 - val_loss: 3.8707 - val_NDCG@10: 0.4388 - val_r1: 0.3215 - val_r5: 0.4977 - val_r10: 0.5722 - val_p5: 0.0995 - val_p10: 0.0572 - val_f1: 0.0231 - lr: 4.9159e-04 - e_time: 22.2984 - 22s/epoch - 44ms/step
Epoch 18/1000
502/502 - 22s - loss: 3.4351 - NDCG@10: 0.4768 - r1: 0.3435 - r5: 0.5449 - r10: 0.6272 - p5: 0.1090 - p10: 0.0627 - f1: 0.0190 - val_loss: 3.9268 - val_NDCG@10: 0.4322 - val_r1: 0.3163 - val_r5: 0.4886 - val_r10: 0.5652 - val_p5: 0.0977 - val_p10: 0.0565 - val_f1: 0.0196 - lr: 4.9109e-04 - e_time: 22.3160 - 22s/epoch - 44ms/step
Epoch 19/1000
502/502 - 22s - loss: 3.4130 - NDCG@10: 0.4800 - r1: 0.3468 - r5: 0.5475 - r10: 0.6303 - p5: 0.1095 - p10: 0.0630 - f1: 0.0187 - val_loss: 3.9239 - val_NDCG@10: 0.4321 - val_r1: 0.3177 - val_r5: 0.4886 - val_r10: 0.5644 - val_p5: 0.0977 - val_p10: 0.0564 - val_f1: 0.0232 - lr: 4.9060e-04 - e_time: 22.2817 - 22s/epoch - 44ms/step
Epoch 20/1000
502/502 - 22s - loss: 3.3771 - NDCG@10: 0.4854 - r1: 0.3515 - r5: 0.5534 - r10: 0.6361 - p5: 0.1107 - p10: 0.0636 - f1: 0.0193 - val_loss: 3.9322 - val_NDCG@10: 0.4320 - val_r1: 0.3174 - val_r5: 0.4882 - val_r10: 0.5640 - val_p5: 0.0977 - val_p10: 0.0564 - val_f1: 0.0225 - lr: 4.9010e-04 - e_time: 22.2558 - 22s/epoch - 44ms/step
Epoch 21/1000
502/502 - 22s - loss: 3.3599 - NDCG@10: 0.4881 - r1: 0.3545 - r5: 0.5567 - r10: 0.6382 - p5: 0.1113 - p10: 0.0638 - f1: 0.0194 - val_loss: 3.8920 - val_NDCG@10: 0.4372 - val_r1: 0.3219 - val_r5: 0.4941 - val_r10: 0.5690 - val_p5: 0.0988 - val_p10: 0.0569 - val_f1: 0.0243 - lr: 4.8961e-04 - e_time: 22.2978 - 22s/epoch - 44ms/step
Epoch 22/1000
502/502 - 22s - loss: 3.3297 - NDCG@10: 0.4921 - r1: 0.3590 - r5: 0.5608 - r10: 0.6411 - p5: 0.1122 - p10: 0.0641 - f1: 0.0196 - val_loss: 3.9405 - val_NDCG@10: 0.4320 - val_r1: 0.3157 - val_r5: 0.4898 - val_r10: 0.5648 - val_p5: 0.0980 - val_p10: 0.0565 - val_f1: 0.0215 - lr: 4.8911e-04 - e_time: 22.3016 - 22s/epoch - 44ms/step
Epoch 23/1000
502/502 - 22s - loss: 3.3107 - NDCG@10: 0.4951 - r1: 0.3603 - r5: 0.5645 - r10: 0.6459 - p5: 0.1129 - p10: 0.0646 - f1: 0.0195 - val_loss: 3.9566 - val_NDCG@10: 0.4310 - val_r1: 0.3155 - val_r5: 0.4869 - val_r10: 0.5640 - val_p5: 0.0974 - val_p10: 0.0564 - val_f1: 0.0256 - lr: 4.8862e-04 - e_time: 22.2842 - 22s/epoch - 44ms/step
Epoch 23: early stopping
[92m[INFO] Loading best model...[0m
