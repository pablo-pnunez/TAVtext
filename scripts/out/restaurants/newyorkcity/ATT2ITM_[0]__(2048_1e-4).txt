Model: "ATT2ITM_0"
__________________________________________________________________________________________________
 Layer (type)                   Output Shape         Param #     Connected to                     
==================================================================================================
 input_1 (InputLayer)           [(None, 200)]        0           []                               
                                                                                                  
 input_2 (InputLayer)           [(None, 1985)]       0           []                               
                                                                                                  
 embedding (Embedding)          (None, 200, 384)     4634112     ['input_1[0][0]']                
                                                                                                  
 in_rsts (Embedding)            (None, 1985, 384)    762240      ['input_2[0][0]']                
                                                                                                  
 dense (Dense)                  (None, 200, 256)     98560       ['embedding[0][0]']              
                                                                                                  
 dense_2 (Dense)                (None, 1985, 256)    98560       ['in_rsts[0][0]']                
                                                                                                  
 tf.math.not_equal (TFOpLambda)  (None, 200)         0           ['input_1[0][0]']                
                                                                                                  
 dense_1 (Dense)                (None, 200, 128)     32896       ['dense[0][0]']                  
                                                                                                  
 dense_3 (Dense)                (None, 1985, 128)    32896       ['dense_2[0][0]']                
                                                                                                  
 tf.cast (TFOpLambda)           (None, 200)          0           ['tf.math.not_equal[0][0]']      
                                                                                                  
 word_emb (Lambda)              (None, 200, 128)     0           ['dense_1[0][0]']                
                                                                                                  
 rest_emb (Lambda)              (None, 1985, 128)    0           ['dense_3[0][0]']                
                                                                                                  
 tf.expand_dims (TFOpLambda)    (None, 200, 1)       0           ['tf.cast[0][0]']                
                                                                                                  
 lambda (Lambda)                (None, 200, 1985)    0           ['word_emb[0][0]',               
                                                                  'rest_emb[0][0]']               
                                                                                                  
 tf.tile (TFOpLambda)           (None, 200, 1985)    0           ['tf.expand_dims[0][0]']         
                                                                                                  
 lambda_1 (Lambda)              (None, 200, 1985)    0           ['lambda[0][0]',                 
                                                                  'tf.tile[0][0]']                
                                                                                                  
 dotprod (Activation)           (None, 200, 1985)    0           ['lambda_1[0][0]']               
                                                                                                  
 dropout (Dropout)              (None, 200, 1985)    0           ['dotprod[0][0]']                
                                                                                                  
 sum (Lambda)                   (None, 1985)         0           ['dropout[0][0]']                
                                                                                                  
 out (Activation)               (None, 1985)         0           ['sum[0][0]']                    
                                                                                                  
==================================================================================================
Total params: 5,659,264
Trainable params: 5,659,264
Non-trainable params: 0
__________________________________________________________________________________________________
None
Epoch 1/1000
Model: "ATT2ITM_0"
__________________________________________________________________________________________________
 Layer (type)                   Output Shape         Param #     Connected to                     
==================================================================================================
 input_1 (InputLayer)           [(None, 200)]        0           []                               
                                                                                                  
 input_2 (InputLayer)           [(None, 1985)]       0           []                               
                                                                                                  
 embedding (Embedding)          (None, 200, 384)     4634112     ['input_1[0][0]']                
                                                                                                  
 in_rsts (Embedding)            (None, 1985, 384)    762240      ['input_2[0][0]']                
                                                                                                  
 dense (Dense)                  (None, 200, 256)     98560       ['embedding[0][0]']              
                                                                                                  
 dense_2 (Dense)                (None, 1985, 256)    98560       ['in_rsts[0][0]']                
                                                                                                  
 tf.math.not_equal (TFOpLambda)  (None, 200)         0           ['input_1[0][0]']                
                                                                                                  
 dense_1 (Dense)                (None, 200, 128)     32896       ['dense[0][0]']                  
                                                                                                  
 dense_3 (Dense)                (None, 1985, 128)    32896       ['dense_2[0][0]']                
                                                                                                  
 tf.cast (TFOpLambda)           (None, 200)          0           ['tf.math.not_equal[0][0]']      
                                                                                                  
 word_emb (Lambda)              (None, 200, 128)     0           ['dense_1[0][0]']                
                                                                                                  
 rest_emb (Lambda)              (None, 1985, 128)    0           ['dense_3[0][0]']                
                                                                                                  
 tf.expand_dims (TFOpLambda)    (None, 200, 1)       0           ['tf.cast[0][0]']                
                                                                                                  
 lambda (Lambda)                (None, 200, 1985)    0           ['word_emb[0][0]',               
                                                                  'rest_emb[0][0]']               
                                                                                                  
 tf.tile (TFOpLambda)           (None, 200, 1985)    0           ['tf.expand_dims[0][0]']         
                                                                                                  
 lambda_1 (Lambda)              (None, 200, 1985)    0           ['lambda[0][0]',                 
                                                                  'tf.tile[0][0]']                
                                                                                                  
 dotprod (Activation)           (None, 200, 1985)    0           ['lambda_1[0][0]']               
                                                                                                  
 dropout (Dropout)              (None, 200, 1985)    0           ['dotprod[0][0]']                
                                                                                                  
 sum (Lambda)                   (None, 1985)         0           ['dropout[0][0]']                
                                                                                                  
 out (Activation)               (None, 1985)         0           ['sum[0][0]']                    
                                                                                                  
==================================================================================================
Total params: 5,659,264
Trainable params: 5,659,264
Non-trainable params: 0
__________________________________________________________________________________________________
None
Epoch 1/1000
323/323 - 91s - loss: 6.6986 - r1: 0.0542 - r5: 0.1132 - r10: 0.1505 - p5: 0.0226 - p10: 0.0150 - val_loss: 5.7205 - val_r1: 0.1418 - val_r5: 0.2641 - val_r10: 0.3312 - val_p5: 0.0528 - val_p10: 0.0331 - lr: 9.9901e-05 - 91s/epoch - 283ms/step
Epoch 2/1000
323/323 - 89s - loss: 5.4824 - r1: 0.1273 - r5: 0.2487 - r10: 0.3179 - p5: 0.0497 - p10: 0.0318 - val_loss: 5.1560 - val_r1: 0.2035 - val_r5: 0.3635 - val_r10: 0.4445 - val_p5: 0.0727 - val_p10: 0.0444 - lr: 9.9802e-05 - 89s/epoch - 276ms/step
Epoch 3/1000
323/323 - 89s - loss: 4.9654 - r1: 0.1704 - r5: 0.3211 - r10: 0.4018 - p5: 0.0642 - p10: 0.0402 - val_loss: 4.7447 - val_r1: 0.2465 - val_r5: 0.4217 - val_r10: 0.5062 - val_p5: 0.0843 - val_p10: 0.0506 - lr: 9.9703e-05 - 89s/epoch - 276ms/step
Epoch 4/1000
323/323 - 89s - loss: 4.7305 - r1: 0.1938 - r5: 0.3574 - r10: 0.4418 - p5: 0.0715 - p10: 0.0442 - val_loss: 4.5905 - val_r1: 0.2618 - val_r5: 0.4416 - val_r10: 0.5270 - val_p5: 0.0883 - val_p10: 0.0527 - lr: 9.9604e-05 - 89s/epoch - 276ms/step
Epoch 5/1000
323/323 - 89s - loss: 4.5936 - r1: 0.2090 - r5: 0.3794 - r10: 0.4641 - p5: 0.0759 - p10: 0.0464 - val_loss: 4.4248 - val_r1: 0.2820 - val_r5: 0.4663 - val_r10: 0.5494 - val_p5: 0.0933 - val_p10: 0.0549 - lr: 9.9505e-05 - 89s/epoch - 276ms/step
Epoch 6/1000
323/323 - 89s - loss: 4.4953 - r1: 0.2209 - r5: 0.3950 - r10: 0.4812 - p5: 0.0790 - p10: 0.0481 - val_loss: 4.3732 - val_r1: 0.2868 - val_r5: 0.4706 - val_r10: 0.5555 - val_p5: 0.0941 - val_p10: 0.0556 - lr: 9.9406e-05 - 89s/epoch - 276ms/step
Epoch 7/1000
323/323 - 89s - loss: 4.4231 - r1: 0.2301 - r5: 0.4068 - r10: 0.4927 - p5: 0.0814 - p10: 0.0493 - val_loss: 4.3143 - val_r1: 0.2914 - val_r5: 0.4781 - val_r10: 0.5617 - val_p5: 0.0956 - val_p10: 0.0562 - lr: 9.9307e-05 - 89s/epoch - 275ms/step
Epoch 8/1000
323/323 - 89s - loss: 4.3654 - r1: 0.2373 - r5: 0.4171 - r10: 0.5028 - p5: 0.0834 - p10: 0.0503 - val_loss: 4.2419 - val_r1: 0.3026 - val_r5: 0.4908 - val_r10: 0.5727 - val_p5: 0.0982 - val_p10: 0.0573 - lr: 9.9208e-05 - 89s/epoch - 275ms/step
Epoch 9/1000
323/323 - 89s - loss: 4.3169 - r1: 0.2429 - r5: 0.4253 - r10: 0.5111 - p5: 0.0851 - p10: 0.0511 - val_loss: 4.1565 - val_r1: 0.3160 - val_r5: 0.5056 - val_r10: 0.5874 - val_p5: 0.1011 - val_p10: 0.0587 - lr: 9.9109e-05 - 89s/epoch - 275ms/step
Epoch 10/1000
323/323 - 89s - loss: 4.2751 - r1: 0.2488 - r5: 0.4322 - r10: 0.5181 - p5: 0.0864 - p10: 0.0518 - val_loss: 4.1510 - val_r1: 0.3159 - val_r5: 0.5047 - val_r10: 0.5863 - val_p5: 0.1010 - val_p10: 0.0586 - lr: 9.9010e-05 - 89s/epoch - 275ms/step
Epoch 11/1000
323/323 - 89s - loss: 4.2370 - r1: 0.2540 - r5: 0.4386 - r10: 0.5233 - p5: 0.0877 - p10: 0.0523 - val_loss: 4.1399 - val_r1: 0.3150 - val_r5: 0.5045 - val_r10: 0.5866 - val_p5: 0.1009 - val_p10: 0.0587 - lr: 9.8911e-05 - 89s/epoch - 276ms/step
Epoch 12/1000
323/323 - 89s - loss: 4.2054 - r1: 0.2580 - r5: 0.4434 - r10: 0.5285 - p5: 0.0887 - p10: 0.0528 - val_loss: 4.0936 - val_r1: 0.3223 - val_r5: 0.5127 - val_r10: 0.5945 - val_p5: 0.1026 - val_p10: 0.0595 - lr: 9.8812e-05 - 89s/epoch - 275ms/step
Epoch 13/1000
323/323 - 89s - loss: 4.1778 - r1: 0.2615 - r5: 0.4480 - r10: 0.5329 - p5: 0.0896 - p10: 0.0533 - val_loss: 4.0401 - val_r1: 0.3298 - val_r5: 0.5209 - val_r10: 0.6001 - val_p5: 0.1042 - val_p10: 0.0600 - lr: 9.8713e-05 - 89s/epoch - 275ms/step
Epoch 14/1000
323/323 - 89s - loss: 4.1500 - r1: 0.2648 - r5: 0.4530 - r10: 0.5383 - p5: 0.0906 - p10: 0.0538 - val_loss: 4.0054 - val_r1: 0.3343 - val_r5: 0.5249 - val_r10: 0.6053 - val_p5: 0.1050 - val_p10: 0.0605 - lr: 9.8614e-05 - 89s/epoch - 275ms/step
Epoch 15/1000
323/323 - 89s - loss: 4.1282 - r1: 0.2683 - r5: 0.4563 - r10: 0.5415 - p5: 0.0913 - p10: 0.0542 - val_loss: 3.9643 - val_r1: 0.3407 - val_r5: 0.5331 - val_r10: 0.6130 - val_p5: 0.1066 - val_p10: 0.0613 - lr: 9.8515e-05 - 89s/epoch - 275ms/step
Epoch 16/1000
323/323 - 89s - loss: 4.1067 - r1: 0.2701 - r5: 0.4595 - r10: 0.5444 - p5: 0.0919 - p10: 0.0544 - val_loss: 3.9419 - val_r1: 0.3433 - val_r5: 0.5369 - val_r10: 0.6156 - val_p5: 0.1074 - val_p10: 0.0616 - lr: 9.8416e-05 - 89s/epoch - 275ms/step
Epoch 17/1000
323/323 - 89s - loss: 4.0854 - r1: 0.2738 - r5: 0.4635 - r10: 0.5488 - p5: 0.0927 - p10: 0.0549 - val_loss: 3.9126 - val_r1: 0.3464 - val_r5: 0.5393 - val_r10: 0.6186 - val_p5: 0.1079 - val_p10: 0.0619 - lr: 9.8317e-05 - 89s/epoch - 275ms/step
Epoch 18/1000
323/323 - 89s - loss: 4.0629 - r1: 0.2764 - r5: 0.4670 - r10: 0.5520 - p5: 0.0934 - p10: 0.0552 - val_loss: 3.9114 - val_r1: 0.3470 - val_r5: 0.5399 - val_r10: 0.6179 - val_p5: 0.1080 - val_p10: 0.0618 - lr: 9.8218e-05 - 89s/epoch - 275ms/step
Epoch 19/1000
323/323 - 89s - loss: 4.0433 - r1: 0.2789 - r5: 0.4700 - r10: 0.5551 - p5: 0.0940 - p10: 0.0555 - val_loss: 3.6623 - val_r1: 0.3806 - val_r5: 0.5758 - val_r10: 0.6532 - val_p5: 0.1152 - val_p10: 0.0653 - lr: 9.8119e-05 - 89s/epoch - 275ms/step
Epoch 20/1000
323/323 - 88s - loss: 4.0219 - r1: 0.2820 - r5: 0.4734 - r10: 0.5583 - p5: 0.0947 - p10: 0.0558 - val_loss: 3.8992 - val_r1: 0.3484 - val_r5: 0.5414 - val_r10: 0.6179 - val_p5: 0.1083 - val_p10: 0.0618 - lr: 9.8020e-05 - 88s/epoch - 273ms/step
Epoch 21/1000
323/323 - 88s - loss: 4.0133 - r1: 0.2826 - r5: 0.4748 - r10: 0.5594 - p5: 0.0949 - p10: 0.0559 - val_loss: 3.8727 - val_r1: 0.3532 - val_r5: 0.5450 - val_r10: 0.6227 - val_p5: 0.1090 - val_p10: 0.0623 - lr: 9.7921e-05 - 88s/epoch - 273ms/step
Epoch 22/1000
323/323 - 88s - loss: 3.9978 - r1: 0.2849 - r5: 0.4772 - r10: 0.5622 - p5: 0.0954 - p10: 0.0562 - val_loss: 3.8396 - val_r1: 0.3571 - val_r5: 0.5494 - val_r10: 0.6266 - val_p5: 0.1099 - val_p10: 0.0627 - lr: 9.7822e-05 - 88s/epoch - 273ms/step
Epoch 23/1000
323/323 - 88s - loss: 3.9823 - r1: 0.2870 - r5: 0.4797 - r10: 0.5643 - p5: 0.0959 - p10: 0.0564 - val_loss: 3.7850 - val_r1: 0.3636 - val_r5: 0.5572 - val_r10: 0.6350 - val_p5: 0.1114 - val_p10: 0.0635 - lr: 9.7723e-05 - 88s/epoch - 273ms/step
Epoch 24/1000
323/323 - 88s - loss: 3.9685 - r1: 0.2880 - r5: 0.4820 - r10: 0.5670 - p5: 0.0964 - p10: 0.0567 - val_loss: 3.7870 - val_r1: 0.3636 - val_r5: 0.5579 - val_r10: 0.6343 - val_p5: 0.1116 - val_p10: 0.0634 - lr: 9.7624e-05 - 88s/epoch - 273ms/step
Epoch 25/1000
323/323 - 88s - loss: 3.9551 - r1: 0.2903 - r5: 0.4848 - r10: 0.5690 - p5: 0.0970 - p10: 0.0569 - val_loss: 3.7781 - val_r1: 0.3647 - val_r5: 0.5585 - val_r10: 0.6353 - val_p5: 0.1117 - val_p10: 0.0635 - lr: 9.7525e-05 - 88s/epoch - 273ms/step
Epoch 26/1000
323/323 - 88s - loss: 3.9424 - r1: 0.2920 - r5: 0.4855 - r10: 0.5707 - p5: 0.0971 - p10: 0.0571 - val_loss: 3.7573 - val_r1: 0.3679 - val_r5: 0.5622 - val_r10: 0.6381 - val_p5: 0.1124 - val_p10: 0.0638 - lr: 9.7426e-05 - 88s/epoch - 273ms/step
Epoch 27/1000
323/323 - 88s - loss: 3.9322 - r1: 0.2934 - r5: 0.4879 - r10: 0.5726 - p5: 0.0976 - p10: 0.0573 - val_loss: 3.7285 - val_r1: 0.3722 - val_r5: 0.5648 - val_r10: 0.6420 - val_p5: 0.1130 - val_p10: 0.0642 - lr: 9.7327e-05 - 88s/epoch - 273ms/step
Epoch 28/1000
323/323 - 88s - loss: 3.9161 - r1: 0.2951 - r5: 0.4901 - r10: 0.5746 - p5: 0.0980 - p10: 0.0575 - val_loss: 3.7234 - val_r1: 0.3733 - val_r5: 0.5673 - val_r10: 0.6424 - val_p5: 0.1134 - val_p10: 0.0642 - lr: 9.7228e-05 - 88s/epoch - 273ms/step
Epoch 29/1000
323/323 - 88s - loss: 3.8999 - r1: 0.2978 - r5: 0.4929 - r10: 0.5774 - p5: 0.0986 - p10: 0.0577 - val_loss: 3.7038 - val_r1: 0.3756 - val_r5: 0.5687 - val_r10: 0.6444 - val_p5: 0.1137 - val_p10: 0.0644 - lr: 9.7129e-05 - 88s/epoch - 273ms/step
Epoch 30/1000
323/323 - 88s - loss: 3.8936 - r1: 0.2984 - r5: 0.4941 - r10: 0.5782 - p5: 0.0988 - p10: 0.0578 - val_loss: 3.7147 - val_r1: 0.3736 - val_r5: 0.5661 - val_r10: 0.6438 - val_p5: 0.1132 - val_p10: 0.0644 - lr: 9.7030e-05 - 88s/epoch - 273ms/step
Epoch 31/1000
323/323 - 88s - loss: 3.8772 - r1: 0.3008 - r5: 0.4964 - r10: 0.5808 - p5: 0.0993 - p10: 0.0581 - val_loss: 3.6714 - val_r1: 0.3804 - val_r5: 0.5738 - val_r10: 0.6492 - val_p5: 0.1147 - val_p10: 0.0649 - lr: 9.6931e-05 - 88s/epoch - 273ms/step
Epoch 32/1000
323/323 - 88s - loss: 3.8684 - r1: 0.3015 - r5: 0.4984 - r10: 0.5820 - p5: 0.0997 - p10: 0.0582 - val_loss: 3.7026 - val_r1: 0.3737 - val_r5: 0.5688 - val_r10: 0.6449 - val_p5: 0.1138 - val_p10: 0.0645 - lr: 9.6832e-05 - 88s/epoch - 273ms/step
Epoch 33/1000
323/323 - 89s - loss: 3.8571 - r1: 0.3035 - r5: 0.4996 - r10: 0.5834 - p5: 0.0999 - p10: 0.0583 - val_loss: 3.5209 - val_r1: 0.3970 - val_r5: 0.5923 - val_r10: 0.6675 - val_p5: 0.1184 - val_p10: 0.0668 - lr: 9.6733e-05 - 89s/epoch - 275ms/step
Epoch 34/1000
323/323 - 88s - loss: 3.8430 - r1: 0.3046 - r5: 0.5022 - r10: 0.5859 - p5: 0.1004 - p10: 0.0586 - val_loss: 3.7148 - val_r1: 0.3703 - val_r5: 0.5653 - val_r10: 0.6419 - val_p5: 0.1131 - val_p10: 0.0642 - lr: 9.6634e-05 - 88s/epoch - 273ms/step
Epoch 35/1000
323/323 - 88s - loss: 3.8416 - r1: 0.3046 - r5: 0.5024 - r10: 0.5859 - p5: 0.1005 - p10: 0.0586 - val_loss: 3.6914 - val_r1: 0.3746 - val_r5: 0.5686 - val_r10: 0.6449 - val_p5: 0.1137 - val_p10: 0.0645 - lr: 9.6535e-05 - 88s/epoch - 273ms/step
Epoch 36/1000
323/323 - 88s - loss: 3.8343 - r1: 0.3055 - r5: 0.5034 - r10: 0.5870 - p5: 0.1007 - p10: 0.0587 - val_loss: 3.6684 - val_r1: 0.3794 - val_r5: 0.5709 - val_r10: 0.6481 - val_p5: 0.1142 - val_p10: 0.0648 - lr: 9.6436e-05 - 88s/epoch - 273ms/step
Epoch 37/1000
323/323 - 88s - loss: 3.8227 - r1: 0.3074 - r5: 0.5052 - r10: 0.5887 - p5: 0.1010 - p10: 0.0589 - val_loss: 3.6576 - val_r1: 0.3808 - val_r5: 0.5734 - val_r10: 0.6491 - val_p5: 0.1147 - val_p10: 0.0649 - lr: 9.6337e-05 - 88s/epoch - 273ms/step
Epoch 38/1000
323/323 - 88s - loss: 3.8127 - r1: 0.3089 - r5: 0.5065 - r10: 0.5901 - p5: 0.1013 - p10: 0.0590 - val_loss: 3.6465 - val_r1: 0.3814 - val_r5: 0.5731 - val_r10: 0.6508 - val_p5: 0.1146 - val_p10: 0.0651 - lr: 9.6238e-05 - 88s/epoch - 273ms/step
Epoch 39/1000
323/323 - 88s - loss: 3.8052 - r1: 0.3094 - r5: 0.5082 - r10: 0.5915 - p5: 0.1016 - p10: 0.0592 - val_loss: 3.6451 - val_r1: 0.3813 - val_r5: 0.5746 - val_r10: 0.6510 - val_p5: 0.1149 - val_p10: 0.0651 - lr: 9.6139e-05 - 88s/epoch - 273ms/step
Epoch 40/1000
323/323 - 89s - loss: 3.7918 - r1: 0.3115 - r5: 0.5097 - r10: 0.5931 - p5: 0.1019 - p10: 0.0593 - val_loss: 3.4533 - val_r1: 0.4060 - val_r5: 0.6001 - val_r10: 0.6742 - val_p5: 0.1200 - val_p10: 0.0674 - lr: 9.6040e-05 - 89s/epoch - 275ms/step
Epoch 41/1000
323/323 - 88s - loss: 3.7826 - r1: 0.3128 - r5: 0.5112 - r10: 0.5947 - p5: 0.1022 - p10: 0.0595 - val_loss: 3.6359 - val_r1: 0.3841 - val_r5: 0.5759 - val_r10: 0.6503 - val_p5: 0.1152 - val_p10: 0.0650 - lr: 9.5941e-05 - 88s/epoch - 273ms/step
Epoch 42/1000
323/323 - 88s - loss: 3.7776 - r1: 0.3133 - r5: 0.5121 - r10: 0.5951 - p5: 0.1024 - p10: 0.0595 - val_loss: 3.6463 - val_r1: 0.3817 - val_r5: 0.5731 - val_r10: 0.6490 - val_p5: 0.1146 - val_p10: 0.0649 - lr: 9.5842e-05 - 88s/epoch - 273ms/step
Epoch 43/1000
323/323 - 88s - loss: 3.7669 - r1: 0.3146 - r5: 0.5145 - r10: 0.5971 - p5: 0.1029 - p10: 0.0597 - val_loss: 3.6149 - val_r1: 0.3865 - val_r5: 0.5786 - val_r10: 0.6545 - val_p5: 0.1157 - val_p10: 0.0655 - lr: 9.5743e-05 - 88s/epoch - 273ms/step
Epoch 44/1000
323/323 - 88s - loss: 3.7631 - r1: 0.3155 - r5: 0.5146 - r10: 0.5981 - p5: 0.1029 - p10: 0.0598 - val_loss: 3.6406 - val_r1: 0.3822 - val_r5: 0.5735 - val_r10: 0.6497 - val_p5: 0.1147 - val_p10: 0.0650 - lr: 9.5644e-05 - 88s/epoch - 273ms/step
Epoch 45/1000
323/323 - 88s - loss: 3.7531 - r1: 0.3166 - r5: 0.5159 - r10: 0.5989 - p5: 0.1032 - p10: 0.0599 - val_loss: 3.6000 - val_r1: 0.3881 - val_r5: 0.5807 - val_r10: 0.6557 - val_p5: 0.1162 - val_p10: 0.0656 - lr: 9.5545e-05 - 88s/epoch - 272ms/step
Epoch 46/1000
323/323 - 88s - loss: 3.7447 - r1: 0.3180 - r5: 0.5171 - r10: 0.6006 - p5: 0.1034 - p10: 0.0601 - val_loss: 3.6007 - val_r1: 0.3882 - val_r5: 0.5801 - val_r10: 0.6549 - val_p5: 0.1160 - val_p10: 0.0655 - lr: 9.5446e-05 - 88s/epoch - 273ms/step
Epoch 47/1000
323/323 - 88s - loss: 3.7395 - r1: 0.3186 - r5: 0.5183 - r10: 0.6011 - p5: 0.1036 - p10: 0.0601 - val_loss: 3.5998 - val_r1: 0.3886 - val_r5: 0.5799 - val_r10: 0.6551 - val_p5: 0.1160 - val_p10: 0.0655 - lr: 9.5347e-05 - 88s/epoch - 273ms/step
Epoch 48/1000
323/323 - 88s - loss: 3.7326 - r1: 0.3191 - r5: 0.5188 - r10: 0.6022 - p5: 0.1038 - p10: 0.0602 - val_loss: 3.5705 - val_r1: 0.3922 - val_r5: 0.5838 - val_r10: 0.6592 - val_p5: 0.1168 - val_p10: 0.0659 - lr: 9.5248e-05 - 88s/epoch - 273ms/step
Epoch 49/1000
323/323 - 88s - loss: 3.7233 - r1: 0.3205 - r5: 0.5207 - r10: 0.6035 - p5: 0.1041 - p10: 0.0604 - val_loss: 3.5735 - val_r1: 0.3922 - val_r5: 0.5841 - val_r10: 0.6584 - val_p5: 0.1168 - val_p10: 0.0658 - lr: 9.5149e-05 - 88s/epoch - 273ms/step
Epoch 50/1000
323/323 - 88s - loss: 3.7155 - r1: 0.3219 - r5: 0.5215 - r10: 0.6043 - p5: 0.1043 - p10: 0.0604 - val_loss: 3.5466 - val_r1: 0.3961 - val_r5: 0.5870 - val_r10: 0.6624 - val_p5: 0.1174 - val_p10: 0.0663 - lr: 9.5050e-05 - 88s/epoch - 273ms/step
Epoch 51/1000
323/323 - 88s - loss: 3.7117 - r1: 0.3210 - r5: 0.5226 - r10: 0.6061 - p5: 0.1045 - p10: 0.0606 - val_loss: 3.5622 - val_r1: 0.3926 - val_r5: 0.5850 - val_r10: 0.6602 - val_p5: 0.1170 - val_p10: 0.0660 - lr: 9.4951e-05 - 88s/epoch - 273ms/step
Epoch 52/1000
323/323 - 88s - loss: 3.7002 - r1: 0.3233 - r5: 0.5242 - r10: 0.6075 - p5: 0.1048 - p10: 0.0608 - val_loss: 3.5683 - val_r1: 0.3917 - val_r5: 0.5836 - val_r10: 0.6580 - val_p5: 0.1167 - val_p10: 0.0658 - lr: 9.4852e-05 - 88s/epoch - 273ms/step
Epoch 53/1000
323/323 - 88s - loss: 3.6978 - r1: 0.3235 - r5: 0.5240 - r10: 0.6071 - p5: 0.1048 - p10: 0.0607 - val_loss: 3.5658 - val_r1: 0.3911 - val_r5: 0.5836 - val_r10: 0.6587 - val_p5: 0.1167 - val_p10: 0.0659 - lr: 9.4753e-05 - 88s/epoch - 273ms/step
Epoch 54/1000
323/323 - 89s - loss: 3.6904 - r1: 0.3240 - r5: 0.5258 - r10: 0.6088 - p5: 0.1052 - p10: 0.0609 - val_loss: 3.4045 - val_r1: 0.4121 - val_r5: 0.6064 - val_r10: 0.6801 - val_p5: 0.1213 - val_p10: 0.0680 - lr: 9.4654e-05 - 89s/epoch - 275ms/step
Epoch 55/1000
323/323 - 88s - loss: 3.6800 - r1: 0.3259 - r5: 0.5273 - r10: 0.6103 - p5: 0.1055 - p10: 0.0610 - val_loss: 3.5892 - val_r1: 0.3886 - val_r5: 0.5803 - val_r10: 0.6545 - val_p5: 0.1161 - val_p10: 0.0655 - lr: 9.4555e-05 - 88s/epoch - 273ms/step
Epoch 56/1000
323/323 - 88s - loss: 3.6784 - r1: 0.3259 - r5: 0.5267 - r10: 0.6099 - p5: 0.1053 - p10: 0.0610 - val_loss: 3.5937 - val_r1: 0.3861 - val_r5: 0.5796 - val_r10: 0.6544 - val_p5: 0.1159 - val_p10: 0.0654 - lr: 9.4456e-05 - 88s/epoch - 272ms/step
Epoch 57/1000
323/323 - 88s - loss: 3.6704 - r1: 0.3277 - r5: 0.5287 - r10: 0.6111 - p5: 0.1057 - p10: 0.0611 - val_loss: 3.5679 - val_r1: 0.3910 - val_r5: 0.5832 - val_r10: 0.6580 - val_p5: 0.1166 - val_p10: 0.0658 - lr: 9.4357e-05 - 88s/epoch - 273ms/step
Epoch 58/1000
323/323 - 88s - loss: 3.6655 - r1: 0.3268 - r5: 0.5295 - r10: 0.6121 - p5: 0.1059 - p10: 0.0612 - val_loss: 3.5717 - val_r1: 0.3901 - val_r5: 0.5828 - val_r10: 0.6572 - val_p5: 0.1166 - val_p10: 0.0657 - lr: 9.4258e-05 - 88s/epoch - 273ms/step
Epoch 59/1000
323/323 - 88s - loss: 3.6579 - r1: 0.3289 - r5: 0.5309 - r10: 0.6134 - p5: 0.1062 - p10: 0.0613 - val_loss: 3.5544 - val_r1: 0.3927 - val_r5: 0.5847 - val_r10: 0.6588 - val_p5: 0.1169 - val_p10: 0.0659 - lr: 9.4159e-05 - 88s/epoch - 273ms/step
Epoch 60/1000
323/323 - 88s - loss: 3.6520 - r1: 0.3297 - r5: 0.5317 - r10: 0.6140 - p5: 0.1063 - p10: 0.0614 - val_loss: 3.5517 - val_r1: 0.3921 - val_r5: 0.5861 - val_r10: 0.6600 - val_p5: 0.1172 - val_p10: 0.0660 - lr: 9.4060e-05 - 88s/epoch - 273ms/step
Epoch 61/1000
323/323 - 88s - loss: 3.6488 - r1: 0.3304 - r5: 0.5317 - r10: 0.6141 - p5: 0.1063 - p10: 0.0614 - val_loss: 3.5489 - val_r1: 0.3918 - val_r5: 0.5848 - val_r10: 0.6599 - val_p5: 0.1170 - val_p10: 0.0660 - lr: 9.3961e-05 - 88s/epoch - 273ms/step
Epoch 62/1000
323/323 - 88s - loss: 3.6415 - r1: 0.3309 - r5: 0.5332 - r10: 0.6160 - p5: 0.1066 - p10: 0.0616 - val_loss: 3.5482 - val_r1: 0.3925 - val_r5: 0.5856 - val_r10: 0.6597 - val_p5: 0.1171 - val_p10: 0.0660 - lr: 9.3862e-05 - 88s/epoch - 273ms/step
Epoch 63/1000
323/323 - 88s - loss: 3.6365 - r1: 0.3314 - r5: 0.5341 - r10: 0.6168 - p5: 0.1068 - p10: 0.0617 - val_loss: 3.5230 - val_r1: 0.3962 - val_r5: 0.5906 - val_r10: 0.6623 - val_p5: 0.1181 - val_p10: 0.0662 - lr: 9.3763e-05 - 88s/epoch - 273ms/step
Epoch 64/1000
323/323 - 88s - loss: 3.6289 - r1: 0.3323 - r5: 0.5352 - r10: 0.6179 - p5: 0.1070 - p10: 0.0618 - val_loss: 3.5403 - val_r1: 0.3933 - val_r5: 0.5865 - val_r10: 0.6594 - val_p5: 0.1173 - val_p10: 0.0659 - lr: 9.3664e-05 - 88s/epoch - 272ms/step
Epoch 65/1000
323/323 - 88s - loss: 3.6253 - r1: 0.3330 - r5: 0.5358 - r10: 0.6185 - p5: 0.1072 - p10: 0.0618 - val_loss: 3.5263 - val_r1: 0.3956 - val_r5: 0.5892 - val_r10: 0.6607 - val_p5: 0.1178 - val_p10: 0.0661 - lr: 9.3565e-05 - 88s/epoch - 272ms/step
Epoch 66/1000
323/323 - 88s - loss: 3.6202 - r1: 0.3337 - r5: 0.5362 - r10: 0.6189 - p5: 0.1072 - p10: 0.0619 - val_loss: 3.5563 - val_r1: 0.3902 - val_r5: 0.5842 - val_r10: 0.6573 - val_p5: 0.1168 - val_p10: 0.0657 - lr: 9.3466e-05 - 88s/epoch - 273ms/step
Epoch 67/1000
323/323 - 88s - loss: 3.6136 - r1: 0.3341 - r5: 0.5375 - r10: 0.6199 - p5: 0.1075 - p10: 0.0620 - val_loss: 3.5295 - val_r1: 0.3953 - val_r5: 0.5886 - val_r10: 0.6607 - val_p5: 0.1177 - val_p10: 0.0661 - lr: 9.3367e-05 - 88s/epoch - 273ms/step
Epoch 68/1000
323/323 - 89s - loss: 3.6081 - r1: 0.3350 - r5: 0.5377 - r10: 0.6205 - p5: 0.1075 - p10: 0.0620 - val_loss: 3.3686 - val_r1: 0.4168 - val_r5: 0.6104 - val_r10: 0.6831 - val_p5: 0.1221 - val_p10: 0.0683 - lr: 9.3268e-05 - 89s/epoch - 275ms/step
Epoch 69/1000
323/323 - 88s - loss: 3.6023 - r1: 0.3358 - r5: 0.5392 - r10: 0.6215 - p5: 0.1078 - p10: 0.0621 - val_loss: 3.6000 - val_r1: 0.3840 - val_r5: 0.5763 - val_r10: 0.6507 - val_p5: 0.1153 - val_p10: 0.0651 - lr: 9.3169e-05 - 88s/epoch - 273ms/step
Epoch 70/1000
323/323 - 88s - loss: 3.6018 - r1: 0.3358 - r5: 0.5393 - r10: 0.6216 - p5: 0.1079 - p10: 0.0622 - val_loss: 3.5365 - val_r1: 0.3945 - val_r5: 0.5864 - val_r10: 0.6596 - val_p5: 0.1173 - val_p10: 0.0660 - lr: 9.3070e-05 - 88s/epoch - 272ms/step
Epoch 71/1000
323/323 - 88s - loss: 3.5929 - r1: 0.3371 - r5: 0.5403 - r10: 0.6230 - p5: 0.1081 - p10: 0.0623 - val_loss: 3.5517 - val_r1: 0.3904 - val_r5: 0.5839 - val_r10: 0.6571 - val_p5: 0.1168 - val_p10: 0.0657 - lr: 9.2971e-05 - 88s/epoch - 273ms/step
Epoch 72/1000
323/323 - 88s - loss: 3.5880 - r1: 0.3371 - r5: 0.5411 - r10: 0.6241 - p5: 0.1082 - p10: 0.0624 - val_loss: 3.5255 - val_r1: 0.3944 - val_r5: 0.5870 - val_r10: 0.6603 - val_p5: 0.1174 - val_p10: 0.0660 - lr: 9.2872e-05 - 88s/epoch - 273ms/step
Epoch 73/1000
323/323 - 88s - loss: 3.5861 - r1: 0.3382 - r5: 0.5416 - r10: 0.6238 - p5: 0.1083 - p10: 0.0624 - val_loss: 3.5478 - val_r1: 0.3915 - val_r5: 0.5843 - val_r10: 0.6578 - val_p5: 0.1169 - val_p10: 0.0658 - lr: 9.2773e-05 - 88s/epoch - 273ms/step
Epoch 74/1000
323/323 - 88s - loss: 3.5803 - r1: 0.3389 - r5: 0.5432 - r10: 0.6250 - p5: 0.1086 - p10: 0.0625 - val_loss: 3.5158 - val_r1: 0.3960 - val_r5: 0.5894 - val_r10: 0.6616 - val_p5: 0.1179 - val_p10: 0.0662 - lr: 9.2674e-05 - 88s/epoch - 273ms/step
Epoch 75/1000
323/323 - 88s - loss: 3.5768 - r1: 0.3388 - r5: 0.5429 - r10: 0.6252 - p5: 0.1086 - p10: 0.0625 - val_loss: 3.5261 - val_r1: 0.3940 - val_r5: 0.5875 - val_r10: 0.6603 - val_p5: 0.1175 - val_p10: 0.0660 - lr: 9.2575e-05 - 88s/epoch - 273ms/step
Epoch 76/1000
323/323 - 88s - loss: 3.5682 - r1: 0.3405 - r5: 0.5447 - r10: 0.6268 - p5: 0.1089 - p10: 0.0627 - val_loss: 3.5245 - val_r1: 0.3942 - val_r5: 0.5875 - val_r10: 0.6602 - val_p5: 0.1175 - val_p10: 0.0660 - lr: 9.2476e-05 - 88s/epoch - 273ms/step
Epoch 77/1000
323/323 - 88s - loss: 3.5668 - r1: 0.3400 - r5: 0.5440 - r10: 0.6264 - p5: 0.1088 - p10: 0.0626 - val_loss: 3.5246 - val_r1: 0.3939 - val_r5: 0.5861 - val_r10: 0.6599 - val_p5: 0.1172 - val_p10: 0.0660 - lr: 9.2377e-05 - 88s/epoch - 273ms/step
Epoch 78/1000
323/323 - 88s - loss: 3.5644 - r1: 0.3406 - r5: 0.5453 - r10: 0.6271 - p5: 0.1091 - p10: 0.0627 - val_loss: 3.4904 - val_r1: 0.3997 - val_r5: 0.5917 - val_r10: 0.6651 - val_p5: 0.1183 - val_p10: 0.0665 - lr: 9.2278e-05 - 88s/epoch - 273ms/step
Epoch 79/1000
323/323 - 88s - loss: 3.5596 - r1: 0.3413 - r5: 0.5459 - r10: 0.6282 - p5: 0.1092 - p10: 0.0628 - val_loss: 3.4972 - val_r1: 0.3976 - val_r5: 0.5903 - val_r10: 0.6640 - val_p5: 0.1180 - val_p10: 0.0664 - lr: 9.2179e-05 - 88s/epoch - 273ms/step
Epoch 80/1000
323/323 - 88s - loss: 3.5510 - r1: 0.3425 - r5: 0.5467 - r10: 0.6294 - p5: 0.1093 - p10: 0.0629 - val_loss: 3.4776 - val_r1: 0.4005 - val_r5: 0.5934 - val_r10: 0.6662 - val_p5: 0.1187 - val_p10: 0.0666 - lr: 9.2080e-05 - 88s/epoch - 273ms/step
Epoch 81/1000
323/323 - 88s - loss: 3.5468 - r1: 0.3427 - r5: 0.5473 - r10: 0.6295 - p5: 0.1095 - p10: 0.0629 - val_loss: 3.4780 - val_r1: 0.4010 - val_r5: 0.5936 - val_r10: 0.6665 - val_p5: 0.1187 - val_p10: 0.0666 - lr: 9.1981e-05 - 88s/epoch - 273ms/step
Epoch 82/1000
323/323 - 88s - loss: 3.5428 - r1: 0.3433 - r5: 0.5480 - r10: 0.6297 - p5: 0.1096 - p10: 0.0630 - val_loss: 3.4804 - val_r1: 0.3998 - val_r5: 0.5921 - val_r10: 0.6643 - val_p5: 0.1184 - val_p10: 0.0664 - lr: 9.1882e-05 - 88s/epoch - 273ms/step
Epoch 83/1000
323/323 - 88s - loss: 3.5393 - r1: 0.3445 - r5: 0.5489 - r10: 0.6309 - p5: 0.1098 - p10: 0.0631 - val_loss: 3.4776 - val_r1: 0.4010 - val_r5: 0.5935 - val_r10: 0.6657 - val_p5: 0.1187 - val_p10: 0.0666 - lr: 9.1783e-05 - 88s/epoch - 273ms/step
Epoch 84/1000
323/323 - 88s - loss: 3.5358 - r1: 0.3446 - r5: 0.5493 - r10: 0.6309 - p5: 0.1099 - p10: 0.0631 - val_loss: 3.4801 - val_r1: 0.4007 - val_r5: 0.5932 - val_r10: 0.6656 - val_p5: 0.1186 - val_p10: 0.0666 - lr: 9.1684e-05 - 88s/epoch - 273ms/step
Epoch 85/1000
323/323 - 88s - loss: 3.5278 - r1: 0.3449 - r5: 0.5507 - r10: 0.6328 - p5: 0.1101 - p10: 0.0633 - val_loss: 3.5065 - val_r1: 0.3958 - val_r5: 0.5881 - val_r10: 0.6620 - val_p5: 0.1176 - val_p10: 0.0662 - lr: 9.1585e-05 - 88s/epoch - 273ms/step
Epoch 86/1000
323/323 - 88s - loss: 3.5282 - r1: 0.3454 - r5: 0.5501 - r10: 0.6322 - p5: 0.1100 - p10: 0.0632 - val_loss: 3.4641 - val_r1: 0.4035 - val_r5: 0.5944 - val_r10: 0.6669 - val_p5: 0.1189 - val_p10: 0.0667 - lr: 9.1486e-05 - 88s/epoch - 273ms/step
Epoch 87/1000
323/323 - 88s - loss: 3.5194 - r1: 0.3460 - r5: 0.5517 - r10: 0.6337 - p5: 0.1103 - p10: 0.0634 - val_loss: 3.4744 - val_r1: 0.4001 - val_r5: 0.5934 - val_r10: 0.6657 - val_p5: 0.1187 - val_p10: 0.0666 - lr: 9.1387e-05 - 88s/epoch - 273ms/step
Epoch 88/1000
323/323 - 88s - loss: 3.5150 - r1: 0.3473 - r5: 0.5525 - r10: 0.6341 - p5: 0.1105 - p10: 0.0634 - val_loss: 3.4910 - val_r1: 0.3990 - val_r5: 0.5903 - val_r10: 0.6632 - val_p5: 0.1180 - val_p10: 0.0663 - lr: 9.1288e-05 - 88s/epoch - 273ms/step
Epoch 89/1000
323/323 - 88s - loss: 3.5125 - r1: 0.3472 - r5: 0.5529 - r10: 0.6349 - p5: 0.1106 - p10: 0.0635 - val_loss: 3.4770 - val_r1: 0.4002 - val_r5: 0.5923 - val_r10: 0.6655 - val_p5: 0.1185 - val_p10: 0.0665 - lr: 9.1189e-05 - 88s/epoch - 272ms/step
Epoch 90/1000
323/323 - 88s - loss: 3.5087 - r1: 0.3485 - r5: 0.5535 - r10: 0.6352 - p5: 0.1107 - p10: 0.0635 - val_loss: 3.4498 - val_r1: 0.4033 - val_r5: 0.5961 - val_r10: 0.6688 - val_p5: 0.1192 - val_p10: 0.0669 - lr: 9.1090e-05 - 88s/epoch - 273ms/step
Epoch 91/1000
323/323 - 88s - loss: 3.5054 - r1: 0.3484 - r5: 0.5536 - r10: 0.6361 - p5: 0.1107 - p10: 0.0636 - val_loss: 3.4859 - val_r1: 0.3984 - val_r5: 0.5900 - val_r10: 0.6639 - val_p5: 0.1180 - val_p10: 0.0664 - lr: 9.0991e-05 - 88s/epoch - 272ms/step
Epoch 92/1000
323/323 - 88s - loss: 3.5012 - r1: 0.3487 - r5: 0.5540 - r10: 0.6361 - p5: 0.1108 - p10: 0.0636 - val_loss: 3.4827 - val_r1: 0.3984 - val_r5: 0.5909 - val_r10: 0.6640 - val_p5: 0.1182 - val_p10: 0.0664 - lr: 9.0892e-05 - 88s/epoch - 273ms/step
Epoch 93/1000
323/323 - 88s - loss: 3.4969 - r1: 0.3495 - r5: 0.5552 - r10: 0.6369 - p5: 0.1110 - p10: 0.0637 - val_loss: 3.4723 - val_r1: 0.3997 - val_r5: 0.5922 - val_r10: 0.6661 - val_p5: 0.1184 - val_p10: 0.0666 - lr: 9.0793e-05 - 88s/epoch - 273ms/step
Epoch 94/1000
323/323 - 88s - loss: 3.4919 - r1: 0.3503 - r5: 0.5558 - r10: 0.6372 - p5: 0.1112 - p10: 0.0637 - val_loss: 3.4705 - val_r1: 0.3994 - val_r5: 0.5917 - val_r10: 0.6658 - val_p5: 0.1184 - val_p10: 0.0666 - lr: 9.0694e-05 - 88s/epoch - 273ms/step
Epoch 95/1000
323/323 - 88s - loss: 3.4913 - r1: 0.3496 - r5: 0.5560 - r10: 0.6379 - p5: 0.1112 - p10: 0.0638 - val_loss: 3.4649 - val_r1: 0.4010 - val_r5: 0.5927 - val_r10: 0.6666 - val_p5: 0.1185 - val_p10: 0.0667 - lr: 9.0595e-05 - 88s/epoch - 273ms/step
Epoch 96/1000
323/323 - 88s - loss: 3.4863 - r1: 0.3507 - r5: 0.5569 - r10: 0.6387 - p5: 0.1114 - p10: 0.0639 - val_loss: 3.4667 - val_r1: 0.4011 - val_r5: 0.5922 - val_r10: 0.6664 - val_p5: 0.1184 - val_p10: 0.0666 - lr: 9.0496e-05 - 88s/epoch - 273ms/step
Epoch 97/1000
323/323 - 88s - loss: 3.4805 - r1: 0.3517 - r5: 0.5583 - r10: 0.6396 - p5: 0.1117 - p10: 0.0640 - val_loss: 3.4757 - val_r1: 0.3983 - val_r5: 0.5907 - val_r10: 0.6645 - val_p5: 0.1181 - val_p10: 0.0665 - lr: 9.0397e-05 - 88s/epoch - 273ms/step
Epoch 98/1000
323/323 - 88s - loss: 3.4802 - r1: 0.3515 - r5: 0.5578 - r10: 0.6392 - p5: 0.1116 - p10: 0.0639 - val_loss: 3.4513 - val_r1: 0.4026 - val_r5: 0.5945 - val_r10: 0.6679 - val_p5: 0.1189 - val_p10: 0.0668 - lr: 9.0298e-05 - 88s/epoch - 272ms/step
Epoch 99/1000
323/323 - 88s - loss: 3.4753 - r1: 0.3520 - r5: 0.5587 - r10: 0.6408 - p5: 0.1117 - p10: 0.0641 - val_loss: 3.4626 - val_r1: 0.4008 - val_r5: 0.5926 - val_r10: 0.6666 - val_p5: 0.1185 - val_p10: 0.0667 - lr: 9.0199e-05 - 88s/epoch - 273ms/step
Epoch 100/1000
323/323 - 88s - loss: 3.4706 - r1: 0.3530 - r5: 0.5587 - r10: 0.6403 - p5: 0.1117 - p10: 0.0640 - val_loss: 3.4637 - val_r1: 0.4010 - val_r5: 0.5919 - val_r10: 0.6658 - val_p5: 0.1184 - val_p10: 0.0666 - lr: 9.0100e-05 - 88s/epoch - 272ms/step
Epoch 101/1000
323/323 - 88s - loss: 3.4690 - r1: 0.3530 - r5: 0.5594 - r10: 0.6408 - p5: 0.1119 - p10: 0.0641 - val_loss: 3.4606 - val_r1: 0.4003 - val_r5: 0.5921 - val_r10: 0.6652 - val_p5: 0.1184 - val_p10: 0.0665 - lr: 9.0001e-05 - 88s/epoch - 273ms/step
Epoch 102/1000
323/323 - 88s - loss: 3.4675 - r1: 0.3535 - r5: 0.5596 - r10: 0.6412 - p5: 0.1119 - p10: 0.0641 - val_loss: 3.4532 - val_r1: 0.4020 - val_r5: 0.5934 - val_r10: 0.6672 - val_p5: 0.1187 - val_p10: 0.0667 - lr: 8.9902e-05 - 88s/epoch - 273ms/step
Epoch 103/1000
323/323 - 88s - loss: 3.4595 - r1: 0.3544 - r5: 0.5605 - r10: 0.6428 - p5: 0.1121 - p10: 0.0643 - val_loss: 3.4668 - val_r1: 0.3991 - val_r5: 0.5916 - val_r10: 0.6642 - val_p5: 0.1183 - val_p10: 0.0664 - lr: 8.9803e-05 - 88s/epoch - 273ms/step
Epoch 104/1000
323/323 - 88s - loss: 3.4576 - r1: 0.3546 - r5: 0.5614 - r10: 0.6429 - p5: 0.1123 - p10: 0.0643 - val_loss: 3.4580 - val_r1: 0.4008 - val_r5: 0.5938 - val_r10: 0.6662 - val_p5: 0.1188 - val_p10: 0.0666 - lr: 8.9704e-05 - 88s/epoch - 273ms/step
Epoch 105/1000
323/323 - 88s - loss: 3.4563 - r1: 0.3548 - r5: 0.5619 - r10: 0.6426 - p5: 0.1124 - p10: 0.0643 - val_loss: 3.4509 - val_r1: 0.4009 - val_r5: 0.5949 - val_r10: 0.6676 - val_p5: 0.1190 - val_p10: 0.0668 - lr: 8.9605e-05 - 88s/epoch - 273ms/step
Epoch 106/1000
323/323 - 88s - loss: 3.4505 - r1: 0.3554 - r5: 0.5625 - r10: 0.6435 - p5: 0.1125 - p10: 0.0644 - val_loss: 3.4496 - val_r1: 0.4015 - val_r5: 0.5944 - val_r10: 0.6681 - val_p5: 0.1189 - val_p10: 0.0668 - lr: 8.9506e-05 - 88s/epoch - 273ms/step
Epoch 107/1000
323/323 - 88s - loss: 3.4461 - r1: 0.3559 - r5: 0.5628 - r10: 0.6437 - p5: 0.1126 - p10: 0.0644 - val_loss: 3.4496 - val_r1: 0.4001 - val_r5: 0.5936 - val_r10: 0.6668 - val_p5: 0.1187 - val_p10: 0.0667 - lr: 8.9407e-05 - 88s/epoch - 272ms/step
Epoch 108/1000
323/323 - 88s - loss: 3.4452 - r1: 0.3557 - r5: 0.5628 - r10: 0.6441 - p5: 0.1126 - p10: 0.0644 - val_loss: 3.4441 - val_r1: 0.4022 - val_r5: 0.5948 - val_r10: 0.6676 - val_p5: 0.1190 - val_p10: 0.0668 - lr: 8.9308e-05 - 88s/epoch - 273ms/step
Epoch 109/1000
323/323 - 88s - loss: 3.4422 - r1: 0.3571 - r5: 0.5637 - r10: 0.6450 - p5: 0.1128 - p10: 0.0645 - val_loss: 3.4405 - val_r1: 0.4029 - val_r5: 0.5957 - val_r10: 0.6677 - val_p5: 0.1191 - val_p10: 0.0668 - lr: 8.9209e-05 - 88s/epoch - 272ms/step
Epoch 110/1000
323/323 - 88s - loss: 3.4380 - r1: 0.3571 - r5: 0.5648 - r10: 0.6455 - p5: 0.1130 - p10: 0.0646 - val_loss: 3.4358 - val_r1: 0.4033 - val_r5: 0.5946 - val_r10: 0.6687 - val_p5: 0.1189 - val_p10: 0.0669 - lr: 8.9110e-05 - 88s/epoch - 272ms/step
Epoch 111/1000
323/323 - 88s - loss: 3.4337 - r1: 0.3585 - r5: 0.5647 - r10: 0.6462 - p5: 0.1129 - p10: 0.0646 - val_loss: 3.4294 - val_r1: 0.4055 - val_r5: 0.5973 - val_r10: 0.6700 - val_p5: 0.1195 - val_p10: 0.0670 - lr: 8.9011e-05 - 88s/epoch - 273ms/step
Epoch 112/1000
323/323 - 88s - loss: 3.4319 - r1: 0.3583 - r5: 0.5652 - r10: 0.6457 - p5: 0.1130 - p10: 0.0646 - val_loss: 3.4360 - val_r1: 0.4036 - val_r5: 0.5952 - val_r10: 0.6677 - val_p5: 0.1190 - val_p10: 0.0668 - lr: 8.8912e-05 - 88s/epoch - 273ms/step
Epoch 113/1000
323/323 - 88s - loss: 3.4313 - r1: 0.3581 - r5: 0.5652 - r10: 0.6465 - p5: 0.1130 - p10: 0.0646 - val_loss: 3.4252 - val_r1: 0.4047 - val_r5: 0.5965 - val_r10: 0.6695 - val_p5: 0.1193 - val_p10: 0.0669 - lr: 8.8813e-05 - 88s/epoch - 272ms/step
Epoch 114/1000
323/323 - 88s - loss: 3.4255 - r1: 0.3585 - r5: 0.5657 - r10: 0.6465 - p5: 0.1131 - p10: 0.0647 - val_loss: 3.4274 - val_r1: 0.4045 - val_r5: 0.5955 - val_r10: 0.6694 - val_p5: 0.1191 - val_p10: 0.0669 - lr: 8.8714e-05 - 88s/epoch - 272ms/step
Epoch 115/1000
323/323 - 88s - loss: 3.4203 - r1: 0.3596 - r5: 0.5664 - r10: 0.6472 - p5: 0.1133 - p10: 0.0647 - val_loss: 3.4434 - val_r1: 0.4024 - val_r5: 0.5934 - val_r10: 0.6678 - val_p5: 0.1187 - val_p10: 0.0668 - lr: 8.8615e-05 - 88s/epoch - 272ms/step
Epoch 116/1000
323/323 - 88s - loss: 3.4177 - r1: 0.3603 - r5: 0.5678 - r10: 0.6486 - p5: 0.1136 - p10: 0.0649 - val_loss: 3.4118 - val_r1: 0.4072 - val_r5: 0.5983 - val_r10: 0.6718 - val_p5: 0.1197 - val_p10: 0.0672 - lr: 8.8516e-05 - 88s/epoch - 272ms/step
Epoch 117/1000
323/323 - 88s - loss: 3.4142 - r1: 0.3603 - r5: 0.5679 - r10: 0.6488 - p5: 0.1136 - p10: 0.0649 - val_loss: 3.4352 - val_r1: 0.4027 - val_r5: 0.5943 - val_r10: 0.6670 - val_p5: 0.1189 - val_p10: 0.0667 - lr: 8.8417e-05 - 88s/epoch - 272ms/step
Epoch 118/1000
323/323 - 88s - loss: 3.4111 - r1: 0.3609 - r5: 0.5685 - r10: 0.6492 - p5: 0.1137 - p10: 0.0649 - val_loss: 3.4432 - val_r1: 0.4005 - val_r5: 0.5925 - val_r10: 0.6663 - val_p5: 0.1185 - val_p10: 0.0666 - lr: 8.8318e-05 - 88s/epoch - 272ms/step
Epoch 118: early stopping
[92m[INFO] Loading best model...[0m
[93m[WARNING] Model folder already exists...[0m
Model: "ATT2ITM_0"
__________________________________________________________________________________________________
 Layer (type)                   Output Shape         Param #     Connected to                     
==================================================================================================
 input_1 (InputLayer)           [(None, 200)]        0           []                               
                                                                                                  
 input_2 (InputLayer)           [(None, 1985)]       0           []                               
                                                                                                  
 embedding (Embedding)          (None, 200, 384)     4634112     ['input_1[0][0]']                
                                                                                                  
 in_rsts (Embedding)            (None, 1985, 384)    762240      ['input_2[0][0]']                
                                                                                                  
 dense (Dense)                  (None, 200, 256)     98560       ['embedding[0][0]']              
                                                                                                  
 dense_2 (Dense)                (None, 1985, 256)    98560       ['in_rsts[0][0]']                
                                                                                                  
 tf.math.not_equal (TFOpLambda)  (None, 200)         0           ['input_1[0][0]']                
                                                                                                  
 dense_1 (Dense)                (None, 200, 128)     32896       ['dense[0][0]']                  
                                                                                                  
 dense_3 (Dense)                (None, 1985, 128)    32896       ['dense_2[0][0]']                
                                                                                                  
 tf.cast (TFOpLambda)           (None, 200)          0           ['tf.math.not_equal[0][0]']      
                                                                                                  
 word_emb (Lambda)              (None, 200, 128)     0           ['dense_1[0][0]']                
                                                                                                  
 rest_emb (Lambda)              (None, 1985, 128)    0           ['dense_3[0][0]']                
                                                                                                  
 tf.expand_dims (TFOpLambda)    (None, 200, 1)       0           ['tf.cast[0][0]']                
                                                                                                  
 lambda (Lambda)                (None, 200, 1985)    0           ['word_emb[0][0]',               
                                                                  'rest_emb[0][0]']               
                                                                                                  
 tf.tile (TFOpLambda)           (None, 200, 1985)    0           ['tf.expand_dims[0][0]']         
                                                                                                  
 lambda_1 (Lambda)              (None, 200, 1985)    0           ['lambda[0][0]',                 
                                                                  'tf.tile[0][0]']                
                                                                                                  
 dotprod (Activation)           (None, 200, 1985)    0           ['lambda_1[0][0]']               
                                                                                                  
 dropout (Dropout)              (None, 200, 1985)    0           ['dotprod[0][0]']                
                                                                                                  
 sum (Lambda)                   (None, 1985)         0           ['dropout[0][0]']                
                                                                                                  
 out (Activation)               (None, 1985)         0           ['sum[0][0]']                    
                                                                                                  
==================================================================================================
Total params: 5,659,264
Trainable params: 5,659,264
Non-trainable params: 0
__________________________________________________________________________________________________
None
[92m[INFO] Model already trained. Loading weights...[0m
