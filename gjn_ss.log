2023-06-29 18:13:25.140184: I tensorflow/core/platform/cpu_feature_guard.cc:193] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
/media/nas/pperez/miniconda3/envs/TAVtext/lib/python3.8/site-packages/tensorflow_addons/utils/tfa_eol_msg.py:23: UserWarning: 

TensorFlow Addons (TFA) has ended development and introduction of new features.
TFA has entered a minimal maintenance and release mode until a planned end of life in May 2024.
Please modify downstream libraries to take dependencies from other repositories in our TensorFlow community (e.g. Keras, Keras-CV, and Keras-NLP). 

For more information see: https://github.com/tensorflow/addons/issues/2807 

  warnings.warn(
[93m[WARNING] Model folder already exists...[0m
INFO:tensorflow:Mixed precision compatibility check (mixed_float16): OK
Your GPU will likely run quickly with dtype policy mixed_float16 as it has compute capability of at least 7.0. Your GPU: NVIDIA GeForce RTX 3090, compute capability 8.6
All model checkpoint layers were used when initializing TFBertModel.

All the layers of TFBertModel were initialized from the model checkpoint at sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2.
If your task is similar to the task the model of the checkpoint was trained on, you can already use TFBertModel for predictions without further training.
Model: "SSATT2ITM_0"
__________________________________________________________________________________________________
 Layer (type)                   Output Shape         Param #     Connected to                     
==================================================================================================
 input_1 (InputLayer)           [(None, 162)]        0           []                               
                                                                                                  
 tf.math.not_equal (TFOpLambda)  (None, 162)         0           ['input_1[0][0]']                
                                                                                                  
 tf.cast (TFOpLambda)           (None, 162)          0           ['tf.math.not_equal[0][0]']      
                                                                                                  
 input_2 (InputLayer)           [(None, 149)]        0           []                               
                                                                                                  
 tf_bert_model (TFBertModel)    TFBaseModelOutputWi  117653760   ['input_1[0][0]',                
                                thPoolingAndCrossAt               'tf.cast[0][0]']                
                                tentions(last_hidde                                               
                                n_state=(None, 162,                                               
                                 384),                                                            
                                 pooler_output=(Non                                               
                                e, 384),                                                          
                                 past_key_values=No                                               
                                ne, hidden_states=N                                               
                                one, attentions=Non                                               
                                e, cross_attentions                                               
                                =None)                                                            
                                                                                                  
 in_rsts (Embedding)            (None, 149, 384)     57216       ['input_2[0][0]']                
                                                                                                  
 word_emb (Lambda)              (None, 162, 384)     0           ['tf_bert_model[0][0]']          
                                                                                                  
 rest_emb (Lambda)              (None, 149, 384)     0           ['in_rsts[0][0]']                
                                                                                                  
 tf.expand_dims (TFOpLambda)    (None, 162, 1)       0           ['tf.cast[0][0]']                
                                                                                                  
 lambda (Lambda)                (None, 162, 149)     0           ['word_emb[0][0]',               
                                                                  'rest_emb[0][0]']               
                                                                                                  
 tf.tile (TFOpLambda)           (None, 162, 149)     0           ['tf.expand_dims[0][0]']         
                                                                                                  
 lambda_1 (Lambda)              (None, 162, 149)     0           ['lambda[0][0]',                 
                                                                  'tf.tile[0][0]']                
                                                                                                  
 dotprod (Activation)           (None, 162, 149)     0           ['lambda_1[0][0]']               
                                                                                                  
 dropout_37 (Dropout)           (None, 162, 149)     0           ['dotprod[0][0]']                
                                                                                                  
 sum (Lambda)                   (None, 149)          0           ['dropout_37[0][0]']             
                                                                                                  
 out (Activation)               (None, 149)          0           ['sum[0][0]']                    
                                                                                                  
==================================================================================================
Total params: 117,710,976
Trainable params: 57,216
Non-trainable params: 117,653,760
__________________________________________________________________________________________________
None
[92m[INFO] Not saving the model...[0m
Epoch 1/1000
252/252 - 39s - loss: 9.1065 - NDCG@10: 0.0578 - r1: 0.0178 - r5: 0.0663 - r10: 0.1171 - p5: 0.0133 - p10: 0.0117 - val_loss: 6.5404 - val_NDCG@10: 0.0794 - val_r1: 0.0257 - val_r5: 0.0912 - val_r10: 0.1568 - val_p5: 0.0183 - val_p10: 0.0156 - lr: 9.9901e-05 - 39s/epoch - 153ms/step
Epoch 2/1000
252/252 - 29s - loss: 6.4611 - NDCG@10: 0.0794 - r1: 0.0267 - r5: 0.0917 - r10: 0.1539 - p5: 0.0184 - p10: 0.0154 - val_loss: 5.9933 - val_NDCG@10: 0.0982 - val_r1: 0.0338 - val_r5: 0.1207 - val_r10: 0.1863 - val_p5: 0.0241 - val_p10: 0.0186 - lr: 9.9802e-05 - 29s/epoch - 116ms/step
Epoch 3/1000
252/252 - 29s - loss: 5.9670 - NDCG@10: 0.0937 - r1: 0.0319 - r5: 0.1105 - r10: 0.1806 - p5: 0.0221 - p10: 0.0181 - val_loss: 5.7114 - val_NDCG@10: 0.1128 - val_r1: 0.0424 - val_r5: 0.1355 - val_r10: 0.2076 - val_p5: 0.0271 - val_p10: 0.0208 - lr: 9.9703e-05 - 29s/epoch - 117ms/step
Epoch 4/1000
252/252 - 29s - loss: 5.7405 - NDCG@10: 0.1043 - r1: 0.0390 - r5: 0.1226 - r10: 0.1951 - p5: 0.0245 - p10: 0.0195 - val_loss: 5.6177 - val_NDCG@10: 0.1171 - val_r1: 0.0424 - val_r5: 0.1393 - val_r10: 0.2173 - val_p5: 0.0278 - val_p10: 0.0217 - lr: 9.9604e-05 - 29s/epoch - 117ms/step
Epoch 5/1000
252/252 - 29s - loss: 5.5743 - NDCG@10: 0.1139 - r1: 0.0449 - r5: 0.1347 - r10: 0.2091 - p5: 0.0269 - p10: 0.0209 - val_loss: 5.4341 - val_NDCG@10: 0.1308 - val_r1: 0.0511 - val_r5: 0.1553 - val_r10: 0.2396 - val_p5: 0.0311 - val_p10: 0.0240 - lr: 9.9505e-05 - 29s/epoch - 117ms/step
Epoch 6/1000
252/252 - 30s - loss: 5.4542 - NDCG@10: 0.1192 - r1: 0.0456 - r5: 0.1424 - r10: 0.2195 - p5: 0.0285 - p10: 0.0220 - val_loss: 5.3992 - val_NDCG@10: 0.1292 - val_r1: 0.0485 - val_r5: 0.1550 - val_r10: 0.2381 - val_p5: 0.0311 - val_p10: 0.0238 - lr: 9.9406e-05 - 30s/epoch - 117ms/step
Epoch 7/1000
252/252 - 29s - loss: 5.3698 - NDCG@10: 0.1244 - r1: 0.0487 - r5: 0.1473 - r10: 0.2277 - p5: 0.0295 - p10: 0.0228 - val_loss: 5.3480 - val_NDCG@10: 0.1339 - val_r1: 0.0501 - val_r5: 0.1629 - val_r10: 0.2455 - val_p5: 0.0326 - val_p10: 0.0245 - lr: 9.9307e-05 - 29s/epoch - 117ms/step
Epoch 8/1000
252/252 - 29s - loss: 5.2769 - NDCG@10: 0.1335 - r1: 0.0555 - r5: 0.1597 - r10: 0.2390 - p5: 0.0319 - p10: 0.0239 - val_loss: 5.2593 - val_NDCG@10: 0.1386 - val_r1: 0.0529 - val_r5: 0.1677 - val_r10: 0.2521 - val_p5: 0.0335 - val_p10: 0.0252 - lr: 9.9208e-05 - 29s/epoch - 117ms/step
Epoch 9/1000
252/252 - 30s - loss: 5.2146 - NDCG@10: 0.1381 - r1: 0.0569 - r5: 0.1665 - r10: 0.2468 - p5: 0.0333 - p10: 0.0247 - val_loss: 5.1899 - val_NDCG@10: 0.1446 - val_r1: 0.0562 - val_r5: 0.1733 - val_r10: 0.2625 - val_p5: 0.0347 - val_p10: 0.0263 - lr: 9.9109e-05 - 30s/epoch - 117ms/step
Epoch 10/1000
252/252 - 29s - loss: 5.1615 - NDCG@10: 0.1418 - r1: 0.0580 - r5: 0.1707 - r10: 0.2542 - p5: 0.0341 - p10: 0.0254 - val_loss: 5.1432 - val_NDCG@10: 0.1455 - val_r1: 0.0557 - val_r5: 0.1759 - val_r10: 0.2651 - val_p5: 0.0352 - val_p10: 0.0265 - lr: 9.9010e-05 - 29s/epoch - 117ms/step
Epoch 11/1000
252/252 - 29s - loss: 5.0982 - NDCG@10: 0.1468 - r1: 0.0598 - r5: 0.1765 - r10: 0.2621 - p5: 0.0353 - p10: 0.0262 - val_loss: 5.1042 - val_NDCG@10: 0.1521 - val_r1: 0.0640 - val_r5: 0.1814 - val_r10: 0.2696 - val_p5: 0.0362 - val_p10: 0.0270 - lr: 9.8911e-05 - 29s/epoch - 117ms/step
Epoch 12/1000
252/252 - 29s - loss: 5.0576 - NDCG@10: 0.1510 - r1: 0.0624 - r5: 0.1826 - r10: 0.2681 - p5: 0.0365 - p10: 0.0268 - val_loss: 5.0593 - val_NDCG@10: 0.1580 - val_r1: 0.0643 - val_r5: 0.1919 - val_r10: 0.2816 - val_p5: 0.0384 - val_p10: 0.0282 - lr: 9.8812e-05 - 29s/epoch - 117ms/step
Epoch 13/1000
252/252 - 29s - loss: 5.0039 - NDCG@10: 0.1539 - r1: 0.0640 - r5: 0.1829 - r10: 0.2741 - p5: 0.0366 - p10: 0.0274 - val_loss: 5.0163 - val_NDCG@10: 0.1635 - val_r1: 0.0681 - val_r5: 0.2005 - val_r10: 0.2879 - val_p5: 0.0401 - val_p10: 0.0288 - lr: 9.8713e-05 - 29s/epoch - 117ms/step
Epoch 14/1000
252/252 - 29s - loss: 4.9743 - NDCG@10: 0.1575 - r1: 0.0648 - r5: 0.1903 - r10: 0.2798 - p5: 0.0381 - p10: 0.0280 - val_loss: 4.9407 - val_NDCG@10: 0.1750 - val_r1: 0.0770 - val_r5: 0.2099 - val_r10: 0.3029 - val_p5: 0.0420 - val_p10: 0.0303 - lr: 9.8614e-05 - 29s/epoch - 117ms/step
Epoch 15/1000
252/252 - 30s - loss: 4.9267 - NDCG@10: 0.1607 - r1: 0.0653 - r5: 0.1951 - r10: 0.2859 - p5: 0.0390 - p10: 0.0286 - val_loss: 4.9667 - val_NDCG@10: 0.1690 - val_r1: 0.0747 - val_r5: 0.1997 - val_r10: 0.2930 - val_p5: 0.0399 - val_p10: 0.0293 - lr: 9.8515e-05 - 30s/epoch - 117ms/step
Epoch 16/1000
252/252 - 29s - loss: 4.9079 - NDCG@10: 0.1638 - r1: 0.0682 - r5: 0.1976 - r10: 0.2900 - p5: 0.0395 - p10: 0.0290 - val_loss: 4.9376 - val_NDCG@10: 0.1715 - val_r1: 0.0760 - val_r5: 0.2036 - val_r10: 0.2986 - val_p5: 0.0407 - val_p10: 0.0299 - lr: 9.8416e-05 - 29s/epoch - 117ms/step
Epoch 17/1000
252/252 - 29s - loss: 4.8811 - NDCG@10: 0.1677 - r1: 0.0709 - r5: 0.2019 - r10: 0.2953 - p5: 0.0404 - p10: 0.0295 - val_loss: 4.8984 - val_NDCG@10: 0.1780 - val_r1: 0.0808 - val_r5: 0.2109 - val_r10: 0.3060 - val_p5: 0.0422 - val_p10: 0.0306 - lr: 9.8317e-05 - 29s/epoch - 117ms/step
Epoch 18/1000
252/252 - 29s - loss: 4.8538 - NDCG@10: 0.1685 - r1: 0.0702 - r5: 0.2027 - r10: 0.2981 - p5: 0.0405 - p10: 0.0298 - val_loss: 4.8863 - val_NDCG@10: 0.1766 - val_r1: 0.0793 - val_r5: 0.2122 - val_r10: 0.3027 - val_p5: 0.0424 - val_p10: 0.0303 - lr: 9.8218e-05 - 29s/epoch - 117ms/step
Epoch 19/1000
252/252 - 29s - loss: 4.8214 - NDCG@10: 0.1719 - r1: 0.0722 - r5: 0.2063 - r10: 0.3032 - p5: 0.0413 - p10: 0.0303 - val_loss: 4.8432 - val_NDCG@10: 0.1800 - val_r1: 0.0798 - val_r5: 0.2145 - val_r10: 0.3103 - val_p5: 0.0429 - val_p10: 0.0310 - lr: 9.8119e-05 - 29s/epoch - 117ms/step
Epoch 20/1000
252/252 - 29s - loss: 4.8048 - NDCG@10: 0.1752 - r1: 0.0733 - r5: 0.2124 - r10: 0.3082 - p5: 0.0425 - p10: 0.0308 - val_loss: 4.8401 - val_NDCG@10: 0.1818 - val_r1: 0.0846 - val_r5: 0.2180 - val_r10: 0.3070 - val_p5: 0.0436 - val_p10: 0.0307 - lr: 9.8020e-05 - 29s/epoch - 117ms/step
Epoch 21/1000
252/252 - 30s - loss: 4.7827 - NDCG@10: 0.1770 - r1: 0.0770 - r5: 0.2133 - r10: 0.3080 - p5: 0.0427 - p10: 0.0308 - val_loss: 4.8326 - val_NDCG@10: 0.1845 - val_r1: 0.0849 - val_r5: 0.2175 - val_r10: 0.3144 - val_p5: 0.0435 - val_p10: 0.0314 - lr: 9.7921e-05 - 30s/epoch - 117ms/step
Epoch 22/1000
252/252 - 29s - loss: 4.7635 - NDCG@10: 0.1809 - r1: 0.0801 - r5: 0.2168 - r10: 0.3127 - p5: 0.0434 - p10: 0.0313 - val_loss: 4.7998 - val_NDCG@10: 0.1881 - val_r1: 0.0846 - val_r5: 0.2224 - val_r10: 0.3217 - val_p5: 0.0445 - val_p10: 0.0322 - lr: 9.7822e-05 - 29s/epoch - 117ms/step
Epoch 23/1000
252/252 - 29s - loss: 4.7419 - NDCG@10: 0.1819 - r1: 0.0789 - r5: 0.2186 - r10: 0.3176 - p5: 0.0437 - p10: 0.0318 - val_loss: 4.7727 - val_NDCG@10: 0.1925 - val_r1: 0.0900 - val_r5: 0.2287 - val_r10: 0.3248 - val_p5: 0.0457 - val_p10: 0.0325 - lr: 9.7723e-05 - 29s/epoch - 117ms/step
Epoch 24/1000
252/252 - 29s - loss: 4.7286 - NDCG@10: 0.1842 - r1: 0.0799 - r5: 0.2225 - r10: 0.3201 - p5: 0.0445 - p10: 0.0320 - val_loss: 4.7491 - val_NDCG@10: 0.1928 - val_r1: 0.0905 - val_r5: 0.2325 - val_r10: 0.3271 - val_p5: 0.0465 - val_p10: 0.0327 - lr: 9.7624e-05 - 29s/epoch - 117ms/step
Epoch 25/1000
252/252 - 29s - loss: 4.7128 - NDCG@10: 0.1849 - r1: 0.0799 - r5: 0.2255 - r10: 0.3207 - p5: 0.0451 - p10: 0.0321 - val_loss: 4.7657 - val_NDCG@10: 0.1931 - val_r1: 0.0902 - val_r5: 0.2300 - val_r10: 0.3283 - val_p5: 0.0460 - val_p10: 0.0329 - lr: 9.7525e-05 - 29s/epoch - 117ms/step
Epoch 26/1000
252/252 - 29s - loss: 4.6885 - NDCG@10: 0.1875 - r1: 0.0809 - r5: 0.2289 - r10: 0.3253 - p5: 0.0458 - p10: 0.0325 - val_loss: 4.7254 - val_NDCG@10: 0.2008 - val_r1: 0.0945 - val_r5: 0.2414 - val_r10: 0.3395 - val_p5: 0.0483 - val_p10: 0.0340 - lr: 9.7426e-05 - 29s/epoch - 117ms/step
Epoch 27/1000
252/252 - 29s - loss: 4.6760 - NDCG@10: 0.1900 - r1: 0.0838 - r5: 0.2286 - r10: 0.3283 - p5: 0.0457 - p10: 0.0328 - val_loss: 4.7418 - val_NDCG@10: 0.1953 - val_r1: 0.0928 - val_r5: 0.2300 - val_r10: 0.3299 - val_p5: 0.0460 - val_p10: 0.0330 - lr: 9.7327e-05 - 29s/epoch - 117ms/step
Epoch 28/1000
252/252 - 29s - loss: 4.6641 - NDCG@10: 0.1914 - r1: 0.0839 - r5: 0.2310 - r10: 0.3327 - p5: 0.0462 - p10: 0.0333 - val_loss: 4.7327 - val_NDCG@10: 0.1974 - val_r1: 0.0945 - val_r5: 0.2318 - val_r10: 0.3327 - val_p5: 0.0464 - val_p10: 0.0333 - lr: 9.7228e-05 - 29s/epoch - 117ms/step
Epoch 29/1000
252/252 - 29s - loss: 4.6533 - NDCG@10: 0.1928 - r1: 0.0855 - r5: 0.2356 - r10: 0.3320 - p5: 0.0471 - p10: 0.0332 - val_loss: 4.7166 - val_NDCG@10: 0.1993 - val_r1: 0.0945 - val_r5: 0.2323 - val_r10: 0.3393 - val_p5: 0.0465 - val_p10: 0.0339 - lr: 9.7129e-05 - 29s/epoch - 117ms/step
Epoch 30/1000
252/252 - 29s - loss: 4.6325 - NDCG@10: 0.1944 - r1: 0.0849 - r5: 0.2365 - r10: 0.3362 - p5: 0.0473 - p10: 0.0336 - val_loss: 4.6452 - val_NDCG@10: 0.2134 - val_r1: 0.1027 - val_r5: 0.2526 - val_r10: 0.3565 - val_p5: 0.0505 - val_p10: 0.0357 - lr: 9.7030e-05 - 29s/epoch - 117ms/step
Epoch 31/1000
252/252 - 29s - loss: 4.6150 - NDCG@10: 0.1987 - r1: 0.0896 - r5: 0.2385 - r10: 0.3401 - p5: 0.0477 - p10: 0.0340 - val_loss: 4.7008 - val_NDCG@10: 0.2050 - val_r1: 0.0996 - val_r5: 0.2419 - val_r10: 0.3436 - val_p5: 0.0484 - val_p10: 0.0344 - lr: 9.6931e-05 - 29s/epoch - 117ms/step
Epoch 32/1000
252/252 - 29s - loss: 4.6152 - NDCG@10: 0.1984 - r1: 0.0878 - r5: 0.2393 - r10: 0.3417 - p5: 0.0479 - p10: 0.0342 - val_loss: 4.6665 - val_NDCG@10: 0.2105 - val_r1: 0.1009 - val_r5: 0.2503 - val_r10: 0.3532 - val_p5: 0.0501 - val_p10: 0.0353 - lr: 9.6832e-05 - 29s/epoch - 117ms/step
Epoch 33/1000
252/252 - 29s - loss: 4.6071 - NDCG@10: 0.1982 - r1: 0.0888 - r5: 0.2394 - r10: 0.3405 - p5: 0.0479 - p10: 0.0340 - val_loss: 4.6805 - val_NDCG@10: 0.2069 - val_r1: 0.1004 - val_r5: 0.2427 - val_r10: 0.3476 - val_p5: 0.0485 - val_p10: 0.0348 - lr: 9.6733e-05 - 29s/epoch - 117ms/step
Epoch 34/1000
252/252 - 29s - loss: 4.5973 - NDCG@10: 0.1989 - r1: 0.0889 - r5: 0.2412 - r10: 0.3412 - p5: 0.0482 - p10: 0.0341 - val_loss: 4.5920 - val_NDCG@10: 0.2228 - val_r1: 0.1121 - val_r5: 0.2653 - val_r10: 0.3665 - val_p5: 0.0531 - val_p10: 0.0366 - lr: 9.6634e-05 - 29s/epoch - 117ms/step
Epoch 35/1000
252/252 - 29s - loss: 4.5790 - NDCG@10: 0.2011 - r1: 0.0889 - r5: 0.2465 - r10: 0.3456 - p5: 0.0493 - p10: 0.0346 - val_loss: 4.6491 - val_NDCG@10: 0.2121 - val_r1: 0.1039 - val_r5: 0.2506 - val_r10: 0.3537 - val_p5: 0.0501 - val_p10: 0.0354 - lr: 9.6535e-05 - 29s/epoch - 117ms/step
Epoch 36/1000
252/252 - 29s - loss: 4.5767 - NDCG@10: 0.2046 - r1: 0.0942 - r5: 0.2475 - r10: 0.3458 - p5: 0.0495 - p10: 0.0346 - val_loss: 4.6501 - val_NDCG@10: 0.2101 - val_r1: 0.1004 - val_r5: 0.2503 - val_r10: 0.3532 - val_p5: 0.0501 - val_p10: 0.0353 - lr: 9.6436e-05 - 29s/epoch - 117ms/step
Epoch 37/1000
252/252 - 29s - loss: 4.5630 - NDCG@10: 0.2028 - r1: 0.0924 - r5: 0.2453 - r10: 0.3454 - p5: 0.0491 - p10: 0.0345 - val_loss: 4.6430 - val_NDCG@10: 0.2116 - val_r1: 0.1029 - val_r5: 0.2452 - val_r10: 0.3550 - val_p5: 0.0491 - val_p10: 0.0355 - lr: 9.6337e-05 - 29s/epoch - 117ms/step
Epoch 38/1000
252/252 - 29s - loss: 4.5575 - NDCG@10: 0.2058 - r1: 0.0929 - r5: 0.2501 - r10: 0.3503 - p5: 0.0500 - p10: 0.0350 - val_loss: 4.6286 - val_NDCG@10: 0.2138 - val_r1: 0.1047 - val_r5: 0.2526 - val_r10: 0.3558 - val_p5: 0.0505 - val_p10: 0.0356 - lr: 9.6238e-05 - 29s/epoch - 117ms/step
Epoch 39/1000
252/252 - 29s - loss: 4.5467 - NDCG@10: 0.2084 - r1: 0.0953 - r5: 0.2523 - r10: 0.3553 - p5: 0.0505 - p10: 0.0355 - val_loss: 4.6347 - val_NDCG@10: 0.2156 - val_r1: 0.1070 - val_r5: 0.2549 - val_r10: 0.3583 - val_p5: 0.0510 - val_p10: 0.0358 - lr: 9.6139e-05 - 29s/epoch - 117ms/step
Epoch 40/1000
252/252 - 29s - loss: 4.5437 - NDCG@10: 0.2077 - r1: 0.0940 - r5: 0.2522 - r10: 0.3532 - p5: 0.0505 - p10: 0.0353 - val_loss: 4.6088 - val_NDCG@10: 0.2150 - val_r1: 0.1047 - val_r5: 0.2513 - val_r10: 0.3606 - val_p5: 0.0503 - val_p10: 0.0360 - lr: 9.6040e-05 - 29s/epoch - 117ms/step
Epoch 41/1000
252/252 - 29s - loss: 4.5260 - NDCG@10: 0.2089 - r1: 0.0943 - r5: 0.2547 - r10: 0.3553 - p5: 0.0509 - p10: 0.0355 - val_loss: 4.6306 - val_NDCG@10: 0.2150 - val_r1: 0.1052 - val_r5: 0.2478 - val_r10: 0.3596 - val_p5: 0.0496 - val_p10: 0.0360 - lr: 9.5941e-05 - 29s/epoch - 117ms/step
Epoch 42/1000
252/252 - 29s - loss: 4.5216 - NDCG@10: 0.2105 - r1: 0.0964 - r5: 0.2531 - r10: 0.3580 - p5: 0.0506 - p10: 0.0358 - val_loss: 4.6231 - val_NDCG@10: 0.2164 - val_r1: 0.1083 - val_r5: 0.2493 - val_r10: 0.3593 - val_p5: 0.0499 - val_p10: 0.0359 - lr: 9.5842e-05 - 29s/epoch - 117ms/step
Epoch 43/1000
252/252 - 29s - loss: 4.5091 - NDCG@10: 0.2116 - r1: 0.0966 - r5: 0.2566 - r10: 0.3581 - p5: 0.0513 - p10: 0.0358 - val_loss: 4.5932 - val_NDCG@10: 0.2211 - val_r1: 0.1108 - val_r5: 0.2610 - val_r10: 0.3662 - val_p5: 0.0522 - val_p10: 0.0366 - lr: 9.5743e-05 - 29s/epoch - 117ms/step
Epoch 44/1000
252/252 - 29s - loss: 4.5106 - NDCG@10: 0.2131 - r1: 0.0973 - r5: 0.2590 - r10: 0.3615 - p5: 0.0518 - p10: 0.0361 - val_loss: 4.5882 - val_NDCG@10: 0.2201 - val_r1: 0.1111 - val_r5: 0.2569 - val_r10: 0.3637 - val_p5: 0.0514 - val_p10: 0.0364 - lr: 9.5644e-05 - 29s/epoch - 117ms/step
Epoch 45/1000
252/252 - 29s - loss: 4.5020 - NDCG@10: 0.2132 - r1: 0.0977 - r5: 0.2582 - r10: 0.3611 - p5: 0.0517 - p10: 0.0361 - val_loss: 4.5310 - val_NDCG@10: 0.2313 - val_r1: 0.1177 - val_r5: 0.2691 - val_r10: 0.3789 - val_p5: 0.0539 - val_p10: 0.0379 - lr: 9.5545e-05 - 29s/epoch - 117ms/step
Epoch 46/1000
252/252 - 29s - loss: 4.4885 - NDCG@10: 0.2144 - r1: 0.0986 - r5: 0.2580 - r10: 0.3638 - p5: 0.0516 - p10: 0.0364 - val_loss: 4.5744 - val_NDCG@10: 0.2252 - val_r1: 0.1169 - val_r5: 0.2625 - val_r10: 0.3682 - val_p5: 0.0526 - val_p10: 0.0368 - lr: 9.5446e-05 - 29s/epoch - 117ms/step
Epoch 47/1000
252/252 - 29s - loss: 4.4792 - NDCG@10: 0.2158 - r1: 0.0997 - r5: 0.2620 - r10: 0.3659 - p5: 0.0524 - p10: 0.0366 - val_loss: 4.5657 - val_NDCG@10: 0.2248 - val_r1: 0.1128 - val_r5: 0.2610 - val_r10: 0.3718 - val_p5: 0.0522 - val_p10: 0.0372 - lr: 9.5347e-05 - 29s/epoch - 117ms/step
Epoch 48/1000
252/252 - 29s - loss: 4.4779 - NDCG@10: 0.2163 - r1: 0.0988 - r5: 0.2639 - r10: 0.3674 - p5: 0.0528 - p10: 0.0367 - val_loss: 4.5889 - val_NDCG@10: 0.2194 - val_r1: 0.1047 - val_r5: 0.2587 - val_r10: 0.3685 - val_p5: 0.0517 - val_p10: 0.0368 - lr: 9.5248e-05 - 29s/epoch - 117ms/step
Epoch 49/1000
252/252 - 29s - loss: 4.4662 - NDCG@10: 0.2186 - r1: 0.0994 - r5: 0.2644 - r10: 0.3715 - p5: 0.0529 - p10: 0.0371 - val_loss: 4.5561 - val_NDCG@10: 0.2282 - val_r1: 0.1166 - val_r5: 0.2653 - val_r10: 0.3731 - val_p5: 0.0531 - val_p10: 0.0373 - lr: 9.5149e-05 - 29s/epoch - 117ms/step
Epoch 50/1000
252/252 - 29s - loss: 4.4609 - NDCG@10: 0.2203 - r1: 0.1009 - r5: 0.2663 - r10: 0.3733 - p5: 0.0532 - p10: 0.0373 - val_loss: 4.5602 - val_NDCG@10: 0.2246 - val_r1: 0.1111 - val_r5: 0.2612 - val_r10: 0.3718 - val_p5: 0.0522 - val_p10: 0.0372 - lr: 9.5050e-05 - 29s/epoch - 117ms/step
Epoch 51/1000
252/252 - 29s - loss: 4.4598 - NDCG@10: 0.2194 - r1: 0.1006 - r5: 0.2665 - r10: 0.3726 - p5: 0.0533 - p10: 0.0373 - val_loss: 4.5556 - val_NDCG@10: 0.2278 - val_r1: 0.1154 - val_r5: 0.2640 - val_r10: 0.3751 - val_p5: 0.0528 - val_p10: 0.0375 - lr: 9.4951e-05 - 29s/epoch - 117ms/step
Epoch 52/1000
252/252 - 29s - loss: 4.4543 - NDCG@10: 0.2209 - r1: 0.1014 - r5: 0.2673 - r10: 0.3739 - p5: 0.0535 - p10: 0.0374 - val_loss: 4.5599 - val_NDCG@10: 0.2272 - val_r1: 0.1136 - val_r5: 0.2668 - val_r10: 0.3753 - val_p5: 0.0534 - val_p10: 0.0376 - lr: 9.4852e-05 - 29s/epoch - 117ms/step
Epoch 53/1000
252/252 - 29s - loss: 4.4471 - NDCG@10: 0.2219 - r1: 0.1027 - r5: 0.2684 - r10: 0.3736 - p5: 0.0537 - p10: 0.0374 - val_loss: 4.5002 - val_NDCG@10: 0.2375 - val_r1: 0.1210 - val_r5: 0.2841 - val_r10: 0.3888 - val_p5: 0.0568 - val_p10: 0.0389 - lr: 9.4753e-05 - 29s/epoch - 117ms/step
Epoch 54/1000
252/252 - 29s - loss: 4.4438 - NDCG@10: 0.2210 - r1: 0.1009 - r5: 0.2711 - r10: 0.3735 - p5: 0.0542 - p10: 0.0374 - val_loss: 4.5522 - val_NDCG@10: 0.2290 - val_r1: 0.1136 - val_r5: 0.2673 - val_r10: 0.3797 - val_p5: 0.0535 - val_p10: 0.0380 - lr: 9.4654e-05 - 29s/epoch - 117ms/step
Epoch 55/1000
252/252 - 29s - loss: 4.4352 - NDCG@10: 0.2235 - r1: 0.1033 - r5: 0.2697 - r10: 0.3779 - p5: 0.0539 - p10: 0.0378 - val_loss: 4.5581 - val_NDCG@10: 0.2262 - val_r1: 0.1128 - val_r5: 0.2661 - val_r10: 0.3741 - val_p5: 0.0532 - val_p10: 0.0374 - lr: 9.4555e-05 - 29s/epoch - 117ms/step
Epoch 56/1000
252/252 - 29s - loss: 4.4290 - NDCG@10: 0.2223 - r1: 0.1029 - r5: 0.2704 - r10: 0.3745 - p5: 0.0541 - p10: 0.0374 - val_loss: 4.5330 - val_NDCG@10: 0.2284 - val_r1: 0.1136 - val_r5: 0.2696 - val_r10: 0.3784 - val_p5: 0.0539 - val_p10: 0.0378 - lr: 9.4456e-05 - 29s/epoch - 117ms/step
Epoch 57/1000
252/252 - 29s - loss: 4.4235 - NDCG@10: 0.2242 - r1: 0.1033 - r5: 0.2725 - r10: 0.3786 - p5: 0.0545 - p10: 0.0378 - val_loss: 4.5365 - val_NDCG@10: 0.2277 - val_r1: 0.1126 - val_r5: 0.2696 - val_r10: 0.3764 - val_p5: 0.0539 - val_p10: 0.0376 - lr: 9.4357e-05 - 29s/epoch - 117ms/step
Epoch 58/1000
252/252 - 29s - loss: 4.4340 - NDCG@10: 0.2238 - r1: 0.1046 - r5: 0.2725 - r10: 0.3754 - p5: 0.0545 - p10: 0.0375 - val_loss: 4.5359 - val_NDCG@10: 0.2314 - val_r1: 0.1161 - val_r5: 0.2734 - val_r10: 0.3787 - val_p5: 0.0547 - val_p10: 0.0379 - lr: 9.4258e-05 - 29s/epoch - 117ms/step
Epoch 59/1000
252/252 - 29s - loss: 4.4141 - NDCG@10: 0.2249 - r1: 0.1049 - r5: 0.2729 - r10: 0.3791 - p5: 0.0546 - p10: 0.0379 - val_loss: 4.5533 - val_NDCG@10: 0.2297 - val_r1: 0.1164 - val_r5: 0.2706 - val_r10: 0.3771 - val_p5: 0.0541 - val_p10: 0.0377 - lr: 9.4159e-05 - 29s/epoch - 117ms/step
Epoch 60/1000
252/252 - 29s - loss: 4.4133 - NDCG@10: 0.2257 - r1: 0.1057 - r5: 0.2743 - r10: 0.3792 - p5: 0.0549 - p10: 0.0379 - val_loss: 4.5287 - val_NDCG@10: 0.2301 - val_r1: 0.1174 - val_r5: 0.2727 - val_r10: 0.3751 - val_p5: 0.0545 - val_p10: 0.0375 - lr: 9.4060e-05 - 29s/epoch - 117ms/step
Epoch 61/1000
252/252 - 30s - loss: 4.4112 - NDCG@10: 0.2271 - r1: 0.1070 - r5: 0.2722 - r10: 0.3807 - p5: 0.0544 - p10: 0.0381 - val_loss: 4.5226 - val_NDCG@10: 0.2344 - val_r1: 0.1179 - val_r5: 0.2732 - val_r10: 0.3842 - val_p5: 0.0546 - val_p10: 0.0384 - lr: 9.3961e-05 - 30s/epoch - 117ms/step
Epoch 62/1000
252/252 - 29s - loss: 4.4058 - NDCG@10: 0.2266 - r1: 0.1045 - r5: 0.2750 - r10: 0.3831 - p5: 0.0550 - p10: 0.0383 - val_loss: 4.4519 - val_NDCG@10: 0.2435 - val_r1: 0.1276 - val_r5: 0.2892 - val_r10: 0.3936 - val_p5: 0.0578 - val_p10: 0.0393 - lr: 9.3862e-05 - 29s/epoch - 117ms/step
Epoch 63/1000
252/252 - 29s - loss: 4.4037 - NDCG@10: 0.2257 - r1: 0.1041 - r5: 0.2729 - r10: 0.3814 - p5: 0.0546 - p10: 0.0381 - val_loss: 4.5187 - val_NDCG@10: 0.2334 - val_r1: 0.1205 - val_r5: 0.2762 - val_r10: 0.3781 - val_p5: 0.0552 - val_p10: 0.0378 - lr: 9.3763e-05 - 29s/epoch - 117ms/step
Epoch 64/1000
252/252 - 29s - loss: 4.4039 - NDCG@10: 0.2254 - r1: 0.1058 - r5: 0.2734 - r10: 0.3776 - p5: 0.0547 - p10: 0.0378 - val_loss: 4.5058 - val_NDCG@10: 0.2361 - val_r1: 0.1177 - val_r5: 0.2760 - val_r10: 0.3875 - val_p5: 0.0552 - val_p10: 0.0388 - lr: 9.3664e-05 - 29s/epoch - 117ms/step
Epoch 65/1000
252/252 - 29s - loss: 4.4017 - NDCG@10: 0.2288 - r1: 0.1070 - r5: 0.2763 - r10: 0.3846 - p5: 0.0553 - p10: 0.0385 - val_loss: 4.5065 - val_NDCG@10: 0.2357 - val_r1: 0.1233 - val_r5: 0.2752 - val_r10: 0.3830 - val_p5: 0.0550 - val_p10: 0.0383 - lr: 9.3565e-05 - 29s/epoch - 117ms/step
Epoch 66/1000
252/252 - 29s - loss: 4.3824 - NDCG@10: 0.2297 - r1: 0.1055 - r5: 0.2776 - r10: 0.3885 - p5: 0.0555 - p10: 0.0388 - val_loss: 4.5028 - val_NDCG@10: 0.2333 - val_r1: 0.1169 - val_r5: 0.2788 - val_r10: 0.3837 - val_p5: 0.0558 - val_p10: 0.0384 - lr: 9.3466e-05 - 29s/epoch - 117ms/step
Epoch 67/1000
252/252 - 29s - loss: 4.3767 - NDCG@10: 0.2307 - r1: 0.1073 - r5: 0.2801 - r10: 0.3877 - p5: 0.0560 - p10: 0.0388 - val_loss: 4.5139 - val_NDCG@10: 0.2351 - val_r1: 0.1215 - val_r5: 0.2798 - val_r10: 0.3820 - val_p5: 0.0560 - val_p10: 0.0382 - lr: 9.3367e-05 - 29s/epoch - 117ms/step
Epoch 68/1000
252/252 - 29s - loss: 4.3836 - NDCG@10: 0.2299 - r1: 0.1077 - r5: 0.2807 - r10: 0.3855 - p5: 0.0562 - p10: 0.0385 - val_loss: 4.4752 - val_NDCG@10: 0.2405 - val_r1: 0.1243 - val_r5: 0.2836 - val_r10: 0.3926 - val_p5: 0.0567 - val_p10: 0.0393 - lr: 9.3268e-05 - 29s/epoch - 117ms/step
Epoch 69/1000
252/252 - 29s - loss: 4.3762 - NDCG@10: 0.2299 - r1: 0.1069 - r5: 0.2785 - r10: 0.3863 - p5: 0.0557 - p10: 0.0386 - val_loss: 4.5071 - val_NDCG@10: 0.2350 - val_r1: 0.1205 - val_r5: 0.2795 - val_r10: 0.3837 - val_p5: 0.0559 - val_p10: 0.0384 - lr: 9.3169e-05 - 29s/epoch - 117ms/step
Epoch 70/1000
252/252 - 29s - loss: 4.3757 - NDCG@10: 0.2300 - r1: 0.1077 - r5: 0.2771 - r10: 0.3865 - p5: 0.0554 - p10: 0.0387 - val_loss: 4.5036 - val_NDCG@10: 0.2368 - val_r1: 0.1222 - val_r5: 0.2828 - val_r10: 0.3848 - val_p5: 0.0565 - val_p10: 0.0385 - lr: 9.3070e-05 - 29s/epoch - 117ms/step
Epoch 71/1000
252/252 - 29s - loss: 4.3607 - NDCG@10: 0.2347 - r1: 0.1096 - r5: 0.2835 - r10: 0.3931 - p5: 0.0567 - p10: 0.0393 - val_loss: 4.4753 - val_NDCG@10: 0.2401 - val_r1: 0.1225 - val_r5: 0.2864 - val_r10: 0.3916 - val_p5: 0.0573 - val_p10: 0.0392 - lr: 9.2971e-05 - 29s/epoch - 117ms/step
Epoch 72/1000
252/252 - 29s - loss: 4.3652 - NDCG@10: 0.2335 - r1: 0.1092 - r5: 0.2831 - r10: 0.3923 - p5: 0.0566 - p10: 0.0392 - val_loss: 4.4820 - val_NDCG@10: 0.2393 - val_r1: 0.1233 - val_r5: 0.2813 - val_r10: 0.3886 - val_p5: 0.0563 - val_p10: 0.0389 - lr: 9.2872e-05 - 29s/epoch - 117ms/step
Epoch 72: early stopping
WARNING:tensorflow:Model was constructed with shape (None, 162) for input KerasTensor(type_spec=TensorSpec(shape=(None, 162), dtype=tf.int32, name='input_1'), name='input_1', description="created by layer 'input_1'"), but it was called on an input with incompatible shape (None, 1).
/media/nas/pperez/miniconda3/envs/TAVtext/lib/python3.8/site-packages/sklearn/manifold/_t_sne.py:991: FutureWarning: The PCA initialization in TSNE will change to have the standard deviation of PC1 equal to 1e-4 in 1.2. This will ensure better convergence.
  warnings.warn(
/media/nas/pperez/miniconda3/envs/TAVtext/lib/python3.8/site-packages/sklearn/manifold/_t_sne.py:991: FutureWarning: The PCA initialization in TSNE will change to have the standard deviation of PC1 equal to 1e-4 in 1.2. This will ensure better convergence.
  warnings.warn(
(149, 2)
