2023-06-01 23:34:08.284053: I tensorflow/core/platform/cpu_feature_guard.cc:193] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
/media/nas/pperez/miniconda3/envs/TAVtext/lib/python3.8/site-packages/tensorflow_addons/utils/tfa_eol_msg.py:23: UserWarning: 

TensorFlow Addons (TFA) has ended development and introduction of new features.
TFA has entered a minimal maintenance and release mode until a planned end of life in May 2024.
Please modify downstream libraries to take dependencies from other repositories in our TensorFlow community (e.g. Keras, Keras-CV, and Keras-NLP). 

For more information see: https://github.com/tensorflow/addons/issues/2807 

  warnings.warn(
[93m[WARNING] Model folder already exists...[0m
INFO:tensorflow:Mixed precision compatibility check (mixed_float16): OK
Your GPU will likely run quickly with dtype policy mixed_float16 as it has compute capability of at least 7.0. Your GPU: NVIDIA GeForce RTX 3090, compute capability 8.6
Some layers from the model checkpoint at distilbert-base-uncased were not used when initializing TFDistilBertModel: ['vocab_transform', 'activation_13', 'vocab_projector', 'vocab_layer_norm']
- This IS expected if you are initializing TFDistilBertModel from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing TFDistilBertModel from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
All the layers of TFDistilBertModel were initialized from the model checkpoint at distilbert-base-uncased.
If your task is similar to the task the model of the checkpoint was trained on, you can already use TFDistilBertModel for predictions without further training.
Model: "BERTATT2ITM_0"
__________________________________________________________________________________________________
 Layer (type)                   Output Shape         Param #     Connected to                     
==================================================================================================
 input_1 (InputLayer)           [(None, 162)]        0           []                               
                                                                                                  
 input_2 (InputLayer)           [(None, 149)]        0           []                               
                                                                                                  
 in_rsts (Embedding)            (None, 149, 768)     114432      ['input_2[0][0]']                
                                                                                                  
 tf.math.not_equal (TFOpLambda)  (None, 162)         0           ['input_1[0][0]']                
                                                                                                  
 tf_distil_bert_model (TFDistil  TFBaseModelOutput(l  66362880   ['input_1[0][0]']                
 BertModel)                     ast_hidden_state=(N                                               
                                one, 162, 768),                                                   
                                 hidden_states=None                                               
                                , attentions=None)                                                
                                                                                                  
 dropout_19 (Dropout)           (None, 149, 768)     0           ['in_rsts[0][0]']                
                                                                                                  
 tf.cast (TFOpLambda)           (None, 162)          0           ['tf.math.not_equal[0][0]']      
                                                                                                  
 word_emb (Lambda)              (None, 162, 768)     0           ['tf_distil_bert_model[0][0]']   
                                                                                                  
 rest_emb (Lambda)              (None, 149, 768)     0           ['dropout_19[0][0]']             
                                                                                                  
 tf.expand_dims (TFOpLambda)    (None, 162, 1)       0           ['tf.cast[0][0]']                
                                                                                                  
 lambda (Lambda)                (None, 162, 149)     0           ['word_emb[0][0]',               
                                                                  'rest_emb[0][0]']               
                                                                                                  
 tf.tile (TFOpLambda)           (None, 162, 149)     0           ['tf.expand_dims[0][0]']         
                                                                                                  
 lambda_1 (Lambda)              (None, 162, 149)     0           ['lambda[0][0]',                 
                                                                  'tf.tile[0][0]']                
                                                                                                  
 dotprod (Activation)           (None, 162, 149)     0           ['lambda_1[0][0]']               
                                                                                                  
 dropout_20 (Dropout)           (None, 162, 149)     0           ['dotprod[0][0]']                
                                                                                                  
 sum (Lambda)                   (None, 149)          0           ['dropout_20[0][0]']             
                                                                                                  
 out (Activation)               (None, 149)          0           ['sum[0][0]']                    
                                                                                                  
==================================================================================================
Total params: 66,477,312
Trainable params: 114,432
Non-trainable params: 66,362,880
__________________________________________________________________________________________________
None
[92m[INFO] Not saving the model...[0m
Epoch 1/1000
126/126 - 33s - loss: 24.0144 - NDCG@10: 0.0414 - r1: 0.0099 - r5: 0.0472 - r10: 0.0891 - p5: 0.0093 - p10: 0.0087 - val_loss: 10.7367 - val_NDCG@10: 0.0666 - val_r1: 0.0231 - val_r5: 0.0826 - val_r10: 0.1382 - val_p5: 0.0165 - val_p10: 0.0140 - lr: 9.9901e-05 - 33s/epoch - 265ms/step
Epoch 2/1000
126/126 - 28s - loss: 18.5455 - NDCG@10: 0.0437 - r1: 0.0108 - r5: 0.0487 - r10: 0.0937 - p5: 0.0099 - p10: 0.0093 - val_loss: 9.4782 - val_NDCG@10: 0.0694 - val_r1: 0.0264 - val_r5: 0.0856 - val_r10: 0.1319 - val_p5: 0.0162 - val_p10: 0.0134 - lr: 9.9802e-05 - 28s/epoch - 220ms/step
Epoch 3/1000
126/126 - 28s - loss: 17.4109 - NDCG@10: 0.0450 - r1: 0.0113 - r5: 0.0499 - r10: 0.0950 - p5: 0.0099 - p10: 0.0096 - val_loss: 8.9026 - val_NDCG@10: 0.0703 - val_r1: 0.0208 - val_r5: 0.0775 - val_r10: 0.1398 - val_p5: 0.0163 - val_p10: 0.0136 - lr: 9.9703e-05 - 28s/epoch - 221ms/step
Epoch 4/1000
126/126 - 28s - loss: 16.3919 - NDCG@10: 0.0435 - r1: 0.0102 - r5: 0.0507 - r10: 0.0930 - p5: 0.0101 - p10: 0.0096 - val_loss: 8.0525 - val_NDCG@10: 0.0642 - val_r1: 0.0241 - val_r5: 0.0823 - val_r10: 0.1337 - val_p5: 0.0156 - val_p10: 0.0130 - lr: 9.9604e-05 - 28s/epoch - 221ms/step
Epoch 5/1000
126/126 - 28s - loss: 15.8678 - NDCG@10: 0.0450 - r1: 0.0110 - r5: 0.0507 - r10: 0.0977 - p5: 0.0101 - p10: 0.0096 - val_loss: 7.6859 - val_NDCG@10: 0.0645 - val_r1: 0.0219 - val_r5: 0.0732 - val_r10: 0.1334 - val_p5: 0.0155 - val_p10: 0.0125 - lr: 9.9505e-05 - 28s/epoch - 221ms/step
Epoch 6/1000
126/126 - 28s - loss: 15.3723 - NDCG@10: 0.0455 - r1: 0.0106 - r5: 0.0528 - r10: 0.0951 - p5: 0.0101 - p10: 0.0096 - val_loss: 7.4759 - val_NDCG@10: 0.0714 - val_r1: 0.0224 - val_r5: 0.0826 - val_r10: 0.1375 - val_p5: 0.0157 - val_p10: 0.0129 - lr: 9.9406e-05 - 28s/epoch - 221ms/step
Epoch 7/1000
126/126 - 28s - loss: 14.8790 - NDCG@10: 0.0470 - r1: 0.0127 - r5: 0.0549 - r10: 0.0989 - p5: 0.0106 - p10: 0.0100 - val_loss: 7.3237 - val_NDCG@10: 0.0707 - val_r1: 0.0267 - val_r5: 0.0849 - val_r10: 0.1339 - val_p5: 0.0180 - val_p10: 0.0132 - lr: 9.9307e-05 - 28s/epoch - 221ms/step
Epoch 8/1000
126/126 - 28s - loss: 14.5952 - NDCG@10: 0.0483 - r1: 0.0130 - r5: 0.0560 - r10: 0.1012 - p5: 0.0112 - p10: 0.0103 - val_loss: 7.1079 - val_NDCG@10: 0.0733 - val_r1: 0.0254 - val_r5: 0.0844 - val_r10: 0.1421 - val_p5: 0.0165 - val_p10: 0.0150 - lr: 9.9208e-05 - 28s/epoch - 221ms/step
Epoch 9/1000
126/126 - 28s - loss: 14.2354 - NDCG@10: 0.0504 - r1: 0.0135 - r5: 0.0576 - r10: 0.1076 - p5: 0.0114 - p10: 0.0107 - val_loss: 7.0393 - val_NDCG@10: 0.0828 - val_r1: 0.0305 - val_r5: 0.0968 - val_r10: 0.1548 - val_p5: 0.0189 - val_p10: 0.0155 - lr: 9.9109e-05 - 28s/epoch - 221ms/step
Epoch 10/1000
126/126 - 28s - loss: 13.9377 - NDCG@10: 0.0538 - r1: 0.0145 - r5: 0.0601 - r10: 0.1113 - p5: 0.0122 - p10: 0.0111 - val_loss: 6.7219 - val_NDCG@10: 0.0874 - val_r1: 0.0320 - val_r5: 0.1027 - val_r10: 0.1583 - val_p5: 0.0200 - val_p10: 0.0157 - lr: 9.9010e-05 - 28s/epoch - 221ms/step
Epoch 11/1000
126/126 - 28s - loss: 13.6229 - NDCG@10: 0.0557 - r1: 0.0151 - r5: 0.0646 - r10: 0.1151 - p5: 0.0127 - p10: 0.0116 - val_loss: 6.6126 - val_NDCG@10: 0.0955 - val_r1: 0.0356 - val_r5: 0.1075 - val_r10: 0.1743 - val_p5: 0.0214 - val_p10: 0.0167 - lr: 9.8911e-05 - 28s/epoch - 221ms/step
Epoch 12/1000
126/126 - 28s - loss: 13.4173 - NDCG@10: 0.0576 - r1: 0.0165 - r5: 0.0672 - r10: 0.1219 - p5: 0.0135 - p10: 0.0121 - val_loss: 6.5203 - val_NDCG@10: 0.1020 - val_r1: 0.0361 - val_r5: 0.1182 - val_r10: 0.1797 - val_p5: 0.0241 - val_p10: 0.0177 - lr: 9.8812e-05 - 28s/epoch - 221ms/step
Epoch 13/1000
126/126 - 28s - loss: 13.0795 - NDCG@10: 0.0632 - r1: 0.0184 - r5: 0.0691 - r10: 0.1261 - p5: 0.0145 - p10: 0.0127 - val_loss: 6.4425 - val_NDCG@10: 0.1079 - val_r1: 0.0460 - val_r5: 0.1253 - val_r10: 0.1891 - val_p5: 0.0245 - val_p10: 0.0191 - lr: 9.8713e-05 - 28s/epoch - 221ms/step
Epoch 14/1000
126/126 - 28s - loss: 12.8211 - NDCG@10: 0.0658 - r1: 0.0195 - r5: 0.0749 - r10: 0.1359 - p5: 0.0150 - p10: 0.0136 - val_loss: 6.3556 - val_NDCG@10: 0.1146 - val_r1: 0.0450 - val_r5: 0.1375 - val_r10: 0.1980 - val_p5: 0.0280 - val_p10: 0.0209 - lr: 9.8614e-05 - 28s/epoch - 222ms/step
Epoch 15/1000
126/126 - 28s - loss: 12.6437 - NDCG@10: 0.0704 - r1: 0.0209 - r5: 0.0814 - r10: 0.1410 - p5: 0.0161 - p10: 0.0141 - val_loss: 6.2201 - val_NDCG@10: 0.1239 - val_r1: 0.0534 - val_r5: 0.1443 - val_r10: 0.2168 - val_p5: 0.0286 - val_p10: 0.0208 - lr: 9.8515e-05 - 28s/epoch - 222ms/step
Epoch 16/1000
126/126 - 28s - loss: 12.3548 - NDCG@10: 0.0750 - r1: 0.0237 - r5: 0.0864 - r10: 0.1464 - p5: 0.0177 - p10: 0.0148 - val_loss: 6.2068 - val_NDCG@10: 0.1301 - val_r1: 0.0605 - val_r5: 0.1550 - val_r10: 0.2226 - val_p5: 0.0305 - val_p10: 0.0223 - lr: 9.8416e-05 - 28s/epoch - 221ms/step
Epoch 17/1000
126/126 - 28s - loss: 12.1611 - NDCG@10: 0.0791 - r1: 0.0252 - r5: 0.0925 - r10: 0.1555 - p5: 0.0186 - p10: 0.0158 - val_loss: 6.3140 - val_NDCG@10: 0.1365 - val_r1: 0.0666 - val_r5: 0.1601 - val_r10: 0.2412 - val_p5: 0.0328 - val_p10: 0.0240 - lr: 9.8317e-05 - 28s/epoch - 222ms/step
Epoch 18/1000
126/126 - 28s - loss: 11.8712 - NDCG@10: 0.0855 - r1: 0.0275 - r5: 0.1003 - r10: 0.1672 - p5: 0.0202 - p10: 0.0165 - val_loss: 6.0167 - val_NDCG@10: 0.1476 - val_r1: 0.0696 - val_r5: 0.1726 - val_r10: 0.2493 - val_p5: 0.0345 - val_p10: 0.0255 - lr: 9.8218e-05 - 28s/epoch - 221ms/step
Epoch 19/1000
126/126 - 28s - loss: 11.7159 - NDCG@10: 0.0899 - r1: 0.0302 - r5: 0.1039 - r10: 0.1710 - p5: 0.0207 - p10: 0.0172 - val_loss: 6.2120 - val_NDCG@10: 0.1553 - val_r1: 0.0765 - val_r5: 0.1830 - val_r10: 0.2595 - val_p5: 0.0361 - val_p10: 0.0257 - lr: 9.8119e-05 - 28s/epoch - 221ms/step
Epoch 20/1000
126/126 - 28s - loss: 11.4633 - NDCG@10: 0.0928 - r1: 0.0324 - r5: 0.1111 - r10: 0.1793 - p5: 0.0220 - p10: 0.0179 - val_loss: 6.1503 - val_NDCG@10: 0.1606 - val_r1: 0.0821 - val_r5: 0.1893 - val_r10: 0.2663 - val_p5: 0.0382 - val_p10: 0.0268 - lr: 9.8020e-05 - 28s/epoch - 221ms/step
Epoch 21/1000
126/126 - 28s - loss: 11.2887 - NDCG@10: 0.0984 - r1: 0.0344 - r5: 0.1162 - r10: 0.1890 - p5: 0.0232 - p10: 0.0189 - val_loss: 5.9780 - val_NDCG@10: 0.1691 - val_r1: 0.0869 - val_r5: 0.2048 - val_r10: 0.2757 - val_p5: 0.0404 - val_p10: 0.0279 - lr: 9.7921e-05 - 28s/epoch - 221ms/step
Epoch 22/1000
126/126 - 28s - loss: 11.0869 - NDCG@10: 0.1057 - r1: 0.0396 - r5: 0.1248 - r10: 0.1986 - p5: 0.0247 - p10: 0.0196 - val_loss: 6.0612 - val_NDCG@10: 0.1723 - val_r1: 0.0895 - val_r5: 0.2064 - val_r10: 0.2897 - val_p5: 0.0419 - val_p10: 0.0295 - lr: 9.7822e-05 - 28s/epoch - 221ms/step
Epoch 23/1000
126/126 - 28s - loss: 10.9021 - NDCG@10: 0.1067 - r1: 0.0400 - r5: 0.1261 - r10: 0.2020 - p5: 0.0252 - p10: 0.0202 - val_loss: 5.9597 - val_NDCG@10: 0.1834 - val_r1: 0.0922 - val_r5: 0.2117 - val_r10: 0.2978 - val_p5: 0.0436 - val_p10: 0.0297 - lr: 9.7723e-05 - 28s/epoch - 222ms/step
Epoch 24/1000
126/126 - 28s - loss: 10.6784 - NDCG@10: 0.1107 - r1: 0.0406 - r5: 0.1327 - r10: 0.2090 - p5: 0.0265 - p10: 0.0209 - val_loss: 5.9221 - val_NDCG@10: 0.1851 - val_r1: 0.0971 - val_r5: 0.2186 - val_r10: 0.3047 - val_p5: 0.0435 - val_p10: 0.0301 - lr: 9.7624e-05 - 28s/epoch - 221ms/step
Epoch 25/1000
126/126 - 28s - loss: 10.5045 - NDCG@10: 0.1169 - r1: 0.0439 - r5: 0.1402 - r10: 0.2185 - p5: 0.0278 - p10: 0.0220 - val_loss: 5.8465 - val_NDCG@10: 0.1892 - val_r1: 0.0966 - val_r5: 0.2234 - val_r10: 0.3093 - val_p5: 0.0444 - val_p10: 0.0308 - lr: 9.7525e-05 - 28s/epoch - 221ms/step
Epoch 26/1000
126/126 - 28s - loss: 10.3279 - NDCG@10: 0.1201 - r1: 0.0461 - r5: 0.1415 - r10: 0.2204 - p5: 0.0283 - p10: 0.0222 - val_loss: 5.9068 - val_NDCG@10: 0.1921 - val_r1: 0.0986 - val_r5: 0.2269 - val_r10: 0.3197 - val_p5: 0.0460 - val_p10: 0.0324 - lr: 9.7426e-05 - 28s/epoch - 221ms/step
Epoch 27/1000
126/126 - 28s - loss: 10.2011 - NDCG@10: 0.1235 - r1: 0.0476 - r5: 0.1452 - r10: 0.2260 - p5: 0.0291 - p10: 0.0226 - val_loss: 5.8741 - val_NDCG@10: 0.2026 - val_r1: 0.1075 - val_r5: 0.2391 - val_r10: 0.3324 - val_p5: 0.0481 - val_p10: 0.0333 - lr: 9.7327e-05 - 28s/epoch - 221ms/step
Epoch 28/1000
126/126 - 28s - loss: 9.9884 - NDCG@10: 0.1284 - r1: 0.0493 - r5: 0.1515 - r10: 0.2378 - p5: 0.0304 - p10: 0.0237 - val_loss: 5.8189 - val_NDCG@10: 0.2078 - val_r1: 0.1090 - val_r5: 0.2442 - val_r10: 0.3398 - val_p5: 0.0488 - val_p10: 0.0336 - lr: 9.7228e-05 - 28s/epoch - 221ms/step
Epoch 29/1000
126/126 - 28s - loss: 9.8036 - NDCG@10: 0.1317 - r1: 0.0520 - r5: 0.1573 - r10: 0.2410 - p5: 0.0312 - p10: 0.0240 - val_loss: 5.7488 - val_NDCG@10: 0.2135 - val_r1: 0.1151 - val_r5: 0.2506 - val_r10: 0.3413 - val_p5: 0.0502 - val_p10: 0.0338 - lr: 9.7129e-05 - 28s/epoch - 221ms/step
Epoch 30/1000
126/126 - 28s - loss: 9.6731 - NDCG@10: 0.1362 - r1: 0.0547 - r5: 0.1629 - r10: 0.2466 - p5: 0.0324 - p10: 0.0247 - val_loss: 5.7289 - val_NDCG@10: 0.2188 - val_r1: 0.1174 - val_r5: 0.2531 - val_r10: 0.3464 - val_p5: 0.0507 - val_p10: 0.0347 - lr: 9.7030e-05 - 28s/epoch - 221ms/step
Epoch 31/1000
126/126 - 28s - loss: 9.5483 - NDCG@10: 0.1384 - r1: 0.0573 - r5: 0.1665 - r10: 0.2492 - p5: 0.0333 - p10: 0.0248 - val_loss: 5.6992 - val_NDCG@10: 0.2217 - val_r1: 0.1166 - val_r5: 0.2625 - val_r10: 0.3525 - val_p5: 0.0519 - val_p10: 0.0355 - lr: 9.6931e-05 - 28s/epoch - 221ms/step
Epoch 32/1000
126/126 - 28s - loss: 9.3147 - NDCG@10: 0.1427 - r1: 0.0589 - r5: 0.1704 - r10: 0.2581 - p5: 0.0340 - p10: 0.0257 - val_loss: 5.5785 - val_NDCG@10: 0.2245 - val_r1: 0.1202 - val_r5: 0.2645 - val_r10: 0.3576 - val_p5: 0.0538 - val_p10: 0.0357 - lr: 9.6832e-05 - 28s/epoch - 220ms/step
Epoch 33/1000
126/126 - 28s - loss: 9.2706 - NDCG@10: 0.1453 - r1: 0.0597 - r5: 0.1737 - r10: 0.2632 - p5: 0.0348 - p10: 0.0263 - val_loss: 5.6712 - val_NDCG@10: 0.2290 - val_r1: 0.1263 - val_r5: 0.2762 - val_r10: 0.3675 - val_p5: 0.0542 - val_p10: 0.0365 - lr: 9.6733e-05 - 28s/epoch - 221ms/step
Epoch 34/1000
126/126 - 28s - loss: 9.0611 - NDCG@10: 0.1508 - r1: 0.0618 - r5: 0.1799 - r10: 0.2700 - p5: 0.0361 - p10: 0.0270 - val_loss: 5.7498 - val_NDCG@10: 0.2358 - val_r1: 0.1245 - val_r5: 0.2813 - val_r10: 0.3700 - val_p5: 0.0558 - val_p10: 0.0369 - lr: 9.6634e-05 - 28s/epoch - 221ms/step
Epoch 35/1000
126/126 - 28s - loss: 8.9358 - NDCG@10: 0.1530 - r1: 0.0638 - r5: 0.1804 - r10: 0.2738 - p5: 0.0361 - p10: 0.0274 - val_loss: 5.6129 - val_NDCG@10: 0.2344 - val_r1: 0.1299 - val_r5: 0.2747 - val_r10: 0.3746 - val_p5: 0.0545 - val_p10: 0.0369 - lr: 9.6535e-05 - 28s/epoch - 221ms/step
Epoch 36/1000
126/126 - 28s - loss: 8.8412 - NDCG@10: 0.1581 - r1: 0.0663 - r5: 0.1867 - r10: 0.2833 - p5: 0.0376 - p10: 0.0283 - val_loss: 5.5299 - val_NDCG@10: 0.2432 - val_r1: 0.1304 - val_r5: 0.2877 - val_r10: 0.3858 - val_p5: 0.0583 - val_p10: 0.0379 - lr: 9.6436e-05 - 28s/epoch - 221ms/step
Epoch 37/1000
126/126 - 28s - loss: 8.7004 - NDCG@10: 0.1589 - r1: 0.0655 - r5: 0.1910 - r10: 0.2861 - p5: 0.0383 - p10: 0.0285 - val_loss: 5.4425 - val_NDCG@10: 0.2453 - val_r1: 0.1357 - val_r5: 0.2902 - val_r10: 0.3837 - val_p5: 0.0575 - val_p10: 0.0386 - lr: 9.6337e-05 - 28s/epoch - 222ms/step
Epoch 38/1000
126/126 - 28s - loss: 8.5806 - NDCG@10: 0.1656 - r1: 0.0697 - r5: 0.1978 - r10: 0.2943 - p5: 0.0393 - p10: 0.0294 - val_loss: 5.4307 - val_NDCG@10: 0.2502 - val_r1: 0.1337 - val_r5: 0.2961 - val_r10: 0.3970 - val_p5: 0.0591 - val_p10: 0.0394 - lr: 9.6238e-05 - 28s/epoch - 221ms/step
Epoch 39/1000
126/126 - 28s - loss: 8.4191 - NDCG@10: 0.1715 - r1: 0.0731 - r5: 0.2050 - r10: 0.3028 - p5: 0.0410 - p10: 0.0302 - val_loss: 5.4391 - val_NDCG@10: 0.2573 - val_r1: 0.1388 - val_r5: 0.2989 - val_r10: 0.4018 - val_p5: 0.0599 - val_p10: 0.0402 - lr: 9.6139e-05 - 28s/epoch - 222ms/step
Epoch 40/1000
126/126 - 28s - loss: 8.3041 - NDCG@10: 0.1745 - r1: 0.0741 - r5: 0.2069 - r10: 0.3114 - p5: 0.0417 - p10: 0.0311 - val_loss: 5.3604 - val_NDCG@10: 0.2585 - val_r1: 0.1398 - val_r5: 0.3027 - val_r10: 0.4086 - val_p5: 0.0606 - val_p10: 0.0410 - lr: 9.6040e-05 - 28s/epoch - 221ms/step
Epoch 41/1000
126/126 - 28s - loss: 8.2131 - NDCG@10: 0.1776 - r1: 0.0750 - r5: 0.2106 - r10: 0.3138 - p5: 0.0423 - p10: 0.0313 - val_loss: 5.3926 - val_NDCG@10: 0.2637 - val_r1: 0.1400 - val_r5: 0.3136 - val_r10: 0.4127 - val_p5: 0.0631 - val_p10: 0.0413 - lr: 9.5941e-05 - 28s/epoch - 221ms/step
Epoch 42/1000
126/126 - 28s - loss: 8.0942 - NDCG@10: 0.1811 - r1: 0.0739 - r5: 0.2166 - r10: 0.3235 - p5: 0.0429 - p10: 0.0324 - val_loss: 5.3627 - val_NDCG@10: 0.2717 - val_r1: 0.1433 - val_r5: 0.3222 - val_r10: 0.4285 - val_p5: 0.0641 - val_p10: 0.0433 - lr: 9.5842e-05 - 28s/epoch - 221ms/step
Epoch 43/1000
126/126 - 28s - loss: 7.8996 - NDCG@10: 0.1882 - r1: 0.0810 - r5: 0.2253 - r10: 0.3333 - p5: 0.0449 - p10: 0.0333 - val_loss: 5.3627 - val_NDCG@10: 0.2733 - val_r1: 0.1446 - val_r5: 0.3240 - val_r10: 0.4363 - val_p5: 0.0647 - val_p10: 0.0436 - lr: 9.5743e-05 - 28s/epoch - 221ms/step
Epoch 44/1000
126/126 - 28s - loss: 7.9031 - NDCG@10: 0.1905 - r1: 0.0803 - r5: 0.2297 - r10: 0.3394 - p5: 0.0459 - p10: 0.0337 - val_loss: 5.2047 - val_NDCG@10: 0.2871 - val_r1: 0.1530 - val_r5: 0.3362 - val_r10: 0.4534 - val_p5: 0.0674 - val_p10: 0.0457 - lr: 9.5644e-05 - 28s/epoch - 222ms/step
Epoch 45/1000
126/126 - 28s - loss: 7.7425 - NDCG@10: 0.1967 - r1: 0.0834 - r5: 0.2378 - r10: 0.3470 - p5: 0.0474 - p10: 0.0346 - val_loss: 5.2467 - val_NDCG@10: 0.2907 - val_r1: 0.1563 - val_r5: 0.3497 - val_r10: 0.4635 - val_p5: 0.0691 - val_p10: 0.0462 - lr: 9.5545e-05 - 28s/epoch - 221ms/step
Epoch 46/1000
126/126 - 28s - loss: 7.6325 - NDCG@10: 0.2009 - r1: 0.0869 - r5: 0.2407 - r10: 0.3507 - p5: 0.0481 - p10: 0.0350 - val_loss: 5.2300 - val_NDCG@10: 0.2948 - val_r1: 0.1604 - val_r5: 0.3522 - val_r10: 0.4623 - val_p5: 0.0713 - val_p10: 0.0461 - lr: 9.5446e-05 - 28s/epoch - 221ms/step
Epoch 47/1000
126/126 - 28s - loss: 7.5467 - NDCG@10: 0.2031 - r1: 0.0861 - r5: 0.2454 - r10: 0.3606 - p5: 0.0492 - p10: 0.0361 - val_loss: 5.2353 - val_NDCG@10: 0.2965 - val_r1: 0.1609 - val_r5: 0.3553 - val_r10: 0.4630 - val_p5: 0.0706 - val_p10: 0.0464 - lr: 9.5347e-05 - 28s/epoch - 221ms/step
Epoch 48/1000
126/126 - 28s - loss: 7.4288 - NDCG@10: 0.2122 - r1: 0.0945 - r5: 0.2568 - r10: 0.3678 - p5: 0.0513 - p10: 0.0367 - val_loss: 5.2606 - val_NDCG@10: 0.2977 - val_r1: 0.1637 - val_r5: 0.3558 - val_r10: 0.4635 - val_p5: 0.0714 - val_p10: 0.0463 - lr: 9.5248e-05 - 28s/epoch - 221ms/step
Epoch 49/1000
126/126 - 28s - loss: 7.3217 - NDCG@10: 0.2141 - r1: 0.0956 - r5: 0.2580 - r10: 0.3679 - p5: 0.0516 - p10: 0.0368 - val_loss: 5.2462 - val_NDCG@10: 0.3023 - val_r1: 0.1728 - val_r5: 0.3601 - val_r10: 0.4610 - val_p5: 0.0720 - val_p10: 0.0461 - lr: 9.5149e-05 - 28s/epoch - 221ms/step
Epoch 50/1000
126/126 - 28s - loss: 7.1966 - NDCG@10: 0.2172 - r1: 0.0948 - r5: 0.2622 - r10: 0.3754 - p5: 0.0524 - p10: 0.0375 - val_loss: 5.1701 - val_NDCG@10: 0.3049 - val_r1: 0.1708 - val_r5: 0.3665 - val_r10: 0.4681 - val_p5: 0.0733 - val_p10: 0.0468 - lr: 9.5050e-05 - 28s/epoch - 221ms/step
Epoch 51/1000
126/126 - 28s - loss: 7.1484 - NDCG@10: 0.2184 - r1: 0.0984 - r5: 0.2633 - r10: 0.3732 - p5: 0.0526 - p10: 0.0373 - val_loss: 5.1283 - val_NDCG@10: 0.3093 - val_r1: 0.1784 - val_r5: 0.3654 - val_r10: 0.4673 - val_p5: 0.0730 - val_p10: 0.0467 - lr: 9.4951e-05 - 28s/epoch - 221ms/step
Epoch 52/1000
126/126 - 28s - loss: 7.0361 - NDCG@10: 0.2199 - r1: 0.0974 - r5: 0.2657 - r10: 0.3786 - p5: 0.0532 - p10: 0.0378 - val_loss: 5.1523 - val_NDCG@10: 0.3050 - val_r1: 0.1736 - val_r5: 0.3578 - val_r10: 0.4679 - val_p5: 0.0716 - val_p10: 0.0468 - lr: 9.4852e-05 - 28s/epoch - 221ms/step
Epoch 53/1000
126/126 - 28s - loss: 6.9296 - NDCG@10: 0.2263 - r1: 0.1042 - r5: 0.2724 - r10: 0.3843 - p5: 0.0545 - p10: 0.0384 - val_loss: 5.0166 - val_NDCG@10: 0.3106 - val_r1: 0.1809 - val_r5: 0.3649 - val_r10: 0.4706 - val_p5: 0.0730 - val_p10: 0.0471 - lr: 9.4753e-05 - 28s/epoch - 223ms/step
Epoch 54/1000
126/126 - 28s - loss: 6.8658 - NDCG@10: 0.2285 - r1: 0.1056 - r5: 0.2757 - r10: 0.3872 - p5: 0.0551 - p10: 0.0387 - val_loss: 5.0683 - val_NDCG@10: 0.3084 - val_r1: 0.1789 - val_r5: 0.3639 - val_r10: 0.4666 - val_p5: 0.0728 - val_p10: 0.0467 - lr: 9.4654e-05 - 28s/epoch - 221ms/step
Epoch 55/1000
126/126 - 28s - loss: 6.7968 - NDCG@10: 0.2287 - r1: 0.1086 - r5: 0.2728 - r10: 0.3843 - p5: 0.0546 - p10: 0.0384 - val_loss: 5.0045 - val_NDCG@10: 0.3098 - val_r1: 0.1809 - val_r5: 0.3657 - val_r10: 0.4686 - val_p5: 0.0732 - val_p10: 0.0468 - lr: 9.4555e-05 - 28s/epoch - 220ms/step
Epoch 56/1000
126/126 - 28s - loss: 6.6997 - NDCG@10: 0.2315 - r1: 0.1066 - r5: 0.2790 - r10: 0.3921 - p5: 0.0558 - p10: 0.0392 - val_loss: 5.0133 - val_NDCG@10: 0.3115 - val_r1: 0.1820 - val_r5: 0.3649 - val_r10: 0.4704 - val_p5: 0.0730 - val_p10: 0.0470 - lr: 9.4456e-05 - 28s/epoch - 221ms/step
Epoch 57/1000
126/126 - 28s - loss: 6.6127 - NDCG@10: 0.2345 - r1: 0.1108 - r5: 0.2830 - r10: 0.3939 - p5: 0.0566 - p10: 0.0394 - val_loss: 4.9843 - val_NDCG@10: 0.3089 - val_r1: 0.1814 - val_r5: 0.3637 - val_r10: 0.4638 - val_p5: 0.0727 - val_p10: 0.0464 - lr: 9.4357e-05 - 28s/epoch - 221ms/step
Epoch 58/1000
126/126 - 28s - loss: 6.5503 - NDCG@10: 0.2331 - r1: 0.1112 - r5: 0.2795 - r10: 0.3916 - p5: 0.0559 - p10: 0.0392 - val_loss: 4.9435 - val_NDCG@10: 0.3093 - val_r1: 0.1853 - val_r5: 0.3642 - val_r10: 0.4602 - val_p5: 0.0729 - val_p10: 0.0460 - lr: 9.4258e-05 - 28s/epoch - 221ms/step
Epoch 59/1000
126/126 - 28s - loss: 6.4613 - NDCG@10: 0.2336 - r1: 0.1112 - r5: 0.2820 - r10: 0.3910 - p5: 0.0564 - p10: 0.0391 - val_loss: 4.8825 - val_NDCG@10: 0.3145 - val_r1: 0.1842 - val_r5: 0.3700 - val_r10: 0.4709 - val_p5: 0.0740 - val_p10: 0.0471 - lr: 9.4159e-05 - 28s/epoch - 221ms/step
Epoch 60/1000
126/126 - 28s - loss: 6.4085 - NDCG@10: 0.2363 - r1: 0.1116 - r5: 0.2847 - r10: 0.3970 - p5: 0.0569 - p10: 0.0397 - val_loss: 5.0095 - val_NDCG@10: 0.3071 - val_r1: 0.1776 - val_r5: 0.3591 - val_r10: 0.4676 - val_p5: 0.0718 - val_p10: 0.0468 - lr: 9.4060e-05 - 28s/epoch - 221ms/step
Epoch 61/1000
126/126 - 28s - loss: 6.3371 - NDCG@10: 0.2388 - r1: 0.1136 - r5: 0.2877 - r10: 0.3995 - p5: 0.0575 - p10: 0.0400 - val_loss: 4.8665 - val_NDCG@10: 0.3120 - val_r1: 0.1835 - val_r5: 0.3675 - val_r10: 0.4722 - val_p5: 0.0735 - val_p10: 0.0472 - lr: 9.3961e-05 - 28s/epoch - 221ms/step
Epoch 62/1000
126/126 - 28s - loss: 6.2052 - NDCG@10: 0.2433 - r1: 0.1178 - r5: 0.2928 - r10: 0.4044 - p5: 0.0586 - p10: 0.0404 - val_loss: 4.8716 - val_NDCG@10: 0.3137 - val_r1: 0.1855 - val_r5: 0.3680 - val_r10: 0.4712 - val_p5: 0.0736 - val_p10: 0.0471 - lr: 9.3862e-05 - 28s/epoch - 224ms/step
Epoch 63/1000
126/126 - 28s - loss: 6.1884 - NDCG@10: 0.2432 - r1: 0.1173 - r5: 0.2934 - r10: 0.4043 - p5: 0.0587 - p10: 0.0404 - val_loss: 4.8732 - val_NDCG@10: 0.3107 - val_r1: 0.1797 - val_r5: 0.3700 - val_r10: 0.4673 - val_p5: 0.0740 - val_p10: 0.0467 - lr: 9.3763e-05 - 28s/epoch - 222ms/step
Epoch 64/1000
126/126 - 28s - loss: 6.1045 - NDCG@10: 0.2462 - r1: 0.1193 - r5: 0.2971 - r10: 0.4082 - p5: 0.0594 - p10: 0.0408 - val_loss: 4.8321 - val_NDCG@10: 0.3132 - val_r1: 0.1853 - val_r5: 0.3675 - val_r10: 0.4714 - val_p5: 0.0735 - val_p10: 0.0471 - lr: 9.3664e-05 - 28s/epoch - 221ms/step
Epoch 65/1000
126/126 - 28s - loss: 6.0685 - NDCG@10: 0.2460 - r1: 0.1188 - r5: 0.2974 - r10: 0.4094 - p5: 0.0595 - p10: 0.0409 - val_loss: 4.8883 - val_NDCG@10: 0.3122 - val_r1: 0.1840 - val_r5: 0.3682 - val_r10: 0.4694 - val_p5: 0.0736 - val_p10: 0.0469 - lr: 9.3565e-05 - 28s/epoch - 221ms/step
Epoch 66/1000
126/126 - 28s - loss: 5.9776 - NDCG@10: 0.2484 - r1: 0.1200 - r5: 0.2991 - r10: 0.4131 - p5: 0.0598 - p10: 0.0413 - val_loss: 4.7523 - val_NDCG@10: 0.3158 - val_r1: 0.1827 - val_r5: 0.3718 - val_r10: 0.4778 - val_p5: 0.0744 - val_p10: 0.0478 - lr: 9.3466e-05 - 28s/epoch - 221ms/step
Epoch 67/1000
126/126 - 28s - loss: 5.9274 - NDCG@10: 0.2495 - r1: 0.1205 - r5: 0.3019 - r10: 0.4130 - p5: 0.0604 - p10: 0.0413 - val_loss: 4.7721 - val_NDCG@10: 0.3158 - val_r1: 0.1873 - val_r5: 0.3733 - val_r10: 0.4740 - val_p5: 0.0747 - val_p10: 0.0474 - lr: 9.3367e-05 - 28s/epoch - 221ms/step
Epoch 68/1000
126/126 - 28s - loss: 5.8834 - NDCG@10: 0.2517 - r1: 0.1204 - r5: 0.3057 - r10: 0.4182 - p5: 0.0612 - p10: 0.0418 - val_loss: 4.8025 - val_NDCG@10: 0.3130 - val_r1: 0.1832 - val_r5: 0.3659 - val_r10: 0.4724 - val_p5: 0.0732 - val_p10: 0.0472 - lr: 9.3268e-05 - 28s/epoch - 220ms/step
Epoch 69/1000
126/126 - 28s - loss: 5.8584 - NDCG@10: 0.2512 - r1: 0.1224 - r5: 0.3025 - r10: 0.4151 - p5: 0.0605 - p10: 0.0415 - val_loss: 4.7816 - val_NDCG@10: 0.3166 - val_r1: 0.1901 - val_r5: 0.3680 - val_r10: 0.4737 - val_p5: 0.0736 - val_p10: 0.0474 - lr: 9.3169e-05 - 28s/epoch - 221ms/step
Epoch 70/1000
126/126 - 28s - loss: 5.7783 - NDCG@10: 0.2523 - r1: 0.1222 - r5: 0.3036 - r10: 0.4181 - p5: 0.0607 - p10: 0.0418 - val_loss: 4.7168 - val_NDCG@10: 0.3158 - val_r1: 0.1868 - val_r5: 0.3677 - val_r10: 0.4762 - val_p5: 0.0735 - val_p10: 0.0476 - lr: 9.3070e-05 - 28s/epoch - 221ms/step
Epoch 71/1000
126/126 - 28s - loss: 5.6854 - NDCG@10: 0.2575 - r1: 0.1242 - r5: 0.3117 - r10: 0.4271 - p5: 0.0623 - p10: 0.0427 - val_loss: 4.6686 - val_NDCG@10: 0.3179 - val_r1: 0.1883 - val_r5: 0.3728 - val_r10: 0.4767 - val_p5: 0.0746 - val_p10: 0.0477 - lr: 9.2971e-05 - 28s/epoch - 221ms/step
Epoch 72/1000
126/126 - 28s - loss: 5.6193 - NDCG@10: 0.2586 - r1: 0.1275 - r5: 0.3097 - r10: 0.4259 - p5: 0.0620 - p10: 0.0426 - val_loss: 4.6264 - val_NDCG@10: 0.3177 - val_r1: 0.1903 - val_r5: 0.3720 - val_r10: 0.4788 - val_p5: 0.0744 - val_p10: 0.0479 - lr: 9.2872e-05 - 28s/epoch - 221ms/step
Epoch 73/1000
126/126 - 28s - loss: 5.6381 - NDCG@10: 0.2590 - r1: 0.1285 - r5: 0.3091 - r10: 0.4260 - p5: 0.0618 - p10: 0.0426 - val_loss: 4.6426 - val_NDCG@10: 0.3169 - val_r1: 0.1875 - val_r5: 0.3738 - val_r10: 0.4757 - val_p5: 0.0747 - val_p10: 0.0475 - lr: 9.2773e-05 - 28s/epoch - 221ms/step
Epoch 74/1000
126/126 - 28s - loss: 5.5611 - NDCG@10: 0.2587 - r1: 0.1263 - r5: 0.3097 - r10: 0.4278 - p5: 0.0619 - p10: 0.0428 - val_loss: 4.5987 - val_NDCG@10: 0.3185 - val_r1: 0.1870 - val_r5: 0.3728 - val_r10: 0.4808 - val_p5: 0.0746 - val_p10: 0.0481 - lr: 9.2674e-05 - 28s/epoch - 221ms/step
Epoch 75/1000
126/126 - 28s - loss: 5.5038 - NDCG@10: 0.2619 - r1: 0.1295 - r5: 0.3172 - r10: 0.4293 - p5: 0.0634 - p10: 0.0429 - val_loss: 4.6584 - val_NDCG@10: 0.3153 - val_r1: 0.1853 - val_r5: 0.3687 - val_r10: 0.4737 - val_p5: 0.0737 - val_p10: 0.0474 - lr: 9.2575e-05 - 28s/epoch - 221ms/step
Epoch 76/1000
126/126 - 28s - loss: 5.4904 - NDCG@10: 0.2623 - r1: 0.1289 - r5: 0.3161 - r10: 0.4302 - p5: 0.0632 - p10: 0.0430 - val_loss: 4.6065 - val_NDCG@10: 0.3189 - val_r1: 0.1891 - val_r5: 0.3726 - val_r10: 0.4798 - val_p5: 0.0745 - val_p10: 0.0480 - lr: 9.2476e-05 - 28s/epoch - 221ms/step
Epoch 77/1000
126/126 - 28s - loss: 5.4470 - NDCG@10: 0.2624 - r1: 0.1296 - r5: 0.3162 - r10: 0.4301 - p5: 0.0632 - p10: 0.0430 - val_loss: 4.6380 - val_NDCG@10: 0.3169 - val_r1: 0.1881 - val_r5: 0.3693 - val_r10: 0.4734 - val_p5: 0.0739 - val_p10: 0.0473 - lr: 9.2377e-05 - 28s/epoch - 220ms/step
Epoch 78/1000
126/126 - 28s - loss: 5.3946 - NDCG@10: 0.2649 - r1: 0.1323 - r5: 0.3179 - r10: 0.4338 - p5: 0.0636 - p10: 0.0434 - val_loss: 4.6044 - val_NDCG@10: 0.3157 - val_r1: 0.1853 - val_r5: 0.3700 - val_r10: 0.4780 - val_p5: 0.0740 - val_p10: 0.0478 - lr: 9.2278e-05 - 28s/epoch - 221ms/step
Epoch 79/1000
126/126 - 28s - loss: 5.3468 - NDCG@10: 0.2657 - r1: 0.1317 - r5: 0.3192 - r10: 0.4352 - p5: 0.0638 - p10: 0.0435 - val_loss: 4.5816 - val_NDCG@10: 0.3190 - val_r1: 0.1898 - val_r5: 0.3738 - val_r10: 0.4773 - val_p5: 0.0748 - val_p10: 0.0477 - lr: 9.2179e-05 - 28s/epoch - 221ms/step
Epoch 80/1000
126/126 - 28s - loss: 5.3085 - NDCG@10: 0.2679 - r1: 0.1339 - r5: 0.3210 - r10: 0.4382 - p5: 0.0642 - p10: 0.0438 - val_loss: 4.5183 - val_NDCG@10: 0.3177 - val_r1: 0.1875 - val_r5: 0.3687 - val_r10: 0.4793 - val_p5: 0.0737 - val_p10: 0.0479 - lr: 9.2080e-05 - 28s/epoch - 220ms/step
Epoch 81/1000
126/126 - 28s - loss: 5.2636 - NDCG@10: 0.2688 - r1: 0.1324 - r5: 0.3244 - r10: 0.4411 - p5: 0.0649 - p10: 0.0441 - val_loss: 4.5622 - val_NDCG@10: 0.3209 - val_r1: 0.1898 - val_r5: 0.3738 - val_r10: 0.4828 - val_p5: 0.0748 - val_p10: 0.0483 - lr: 9.1981e-05 - 28s/epoch - 220ms/step
Epoch 82/1000
126/126 - 28s - loss: 5.1963 - NDCG@10: 0.2708 - r1: 0.1360 - r5: 0.3268 - r10: 0.4404 - p5: 0.0654 - p10: 0.0440 - val_loss: 4.5568 - val_NDCG@10: 0.3165 - val_r1: 0.1875 - val_r5: 0.3662 - val_r10: 0.4793 - val_p5: 0.0732 - val_p10: 0.0479 - lr: 9.1882e-05 - 28s/epoch - 220ms/step
Epoch 83/1000
126/126 - 28s - loss: 5.2038 - NDCG@10: 0.2703 - r1: 0.1361 - r5: 0.3241 - r10: 0.4409 - p5: 0.0648 - p10: 0.0441 - val_loss: 4.4894 - val_NDCG@10: 0.3203 - val_r1: 0.1921 - val_r5: 0.3751 - val_r10: 0.4801 - val_p5: 0.0750 - val_p10: 0.0480 - lr: 9.1783e-05 - 28s/epoch - 221ms/step
Epoch 84/1000
126/126 - 28s - loss: 5.1572 - NDCG@10: 0.2723 - r1: 0.1364 - r5: 0.3261 - r10: 0.4443 - p5: 0.0652 - p10: 0.0444 - val_loss: 4.4838 - val_NDCG@10: 0.3204 - val_r1: 0.1893 - val_r5: 0.3748 - val_r10: 0.4816 - val_p5: 0.0750 - val_p10: 0.0481 - lr: 9.1684e-05 - 28s/epoch - 221ms/step
Epoch 85/1000
126/126 - 28s - loss: 5.1309 - NDCG@10: 0.2737 - r1: 0.1384 - r5: 0.3281 - r10: 0.4451 - p5: 0.0656 - p10: 0.0445 - val_loss: 4.5345 - val_NDCG@10: 0.3184 - val_r1: 0.1886 - val_r5: 0.3703 - val_r10: 0.4831 - val_p5: 0.0741 - val_p10: 0.0483 - lr: 9.1585e-05 - 28s/epoch - 221ms/step
Epoch 86/1000
126/126 - 28s - loss: 5.1017 - NDCG@10: 0.2746 - r1: 0.1380 - r5: 0.3302 - r10: 0.4475 - p5: 0.0660 - p10: 0.0447 - val_loss: 4.4639 - val_NDCG@10: 0.3177 - val_r1: 0.1881 - val_r5: 0.3731 - val_r10: 0.4798 - val_p5: 0.0746 - val_p10: 0.0480 - lr: 9.1486e-05 - 28s/epoch - 221ms/step
Epoch 87/1000
126/126 - 28s - loss: 5.0476 - NDCG@10: 0.2760 - r1: 0.1412 - r5: 0.3325 - r10: 0.4454 - p5: 0.0665 - p10: 0.0445 - val_loss: 4.4189 - val_NDCG@10: 0.3212 - val_r1: 0.1903 - val_r5: 0.3776 - val_r10: 0.4846 - val_p5: 0.0755 - val_p10: 0.0485 - lr: 9.1387e-05 - 28s/epoch - 222ms/step
Epoch 88/1000
126/126 - 28s - loss: 5.0310 - NDCG@10: 0.2756 - r1: 0.1394 - r5: 0.3310 - r10: 0.4467 - p5: 0.0662 - p10: 0.0447 - val_loss: 4.3982 - val_NDCG@10: 0.3226 - val_r1: 0.1919 - val_r5: 0.3748 - val_r10: 0.4882 - val_p5: 0.0750 - val_p10: 0.0488 - lr: 9.1288e-05 - 28s/epoch - 221ms/step
Epoch 89/1000
126/126 - 28s - loss: 4.9862 - NDCG@10: 0.2769 - r1: 0.1390 - r5: 0.3355 - r10: 0.4490 - p5: 0.0671 - p10: 0.0449 - val_loss: 4.4644 - val_NDCG@10: 0.3165 - val_r1: 0.1870 - val_r5: 0.3687 - val_r10: 0.4783 - val_p5: 0.0737 - val_p10: 0.0478 - lr: 9.1189e-05 - 28s/epoch - 221ms/step
Epoch 90/1000
126/126 - 28s - loss: 4.9727 - NDCG@10: 0.2777 - r1: 0.1394 - r5: 0.3344 - r10: 0.4524 - p5: 0.0669 - p10: 0.0452 - val_loss: 4.4309 - val_NDCG@10: 0.3174 - val_r1: 0.1868 - val_r5: 0.3781 - val_r10: 0.4808 - val_p5: 0.0756 - val_p10: 0.0481 - lr: 9.1090e-05 - 28s/epoch - 221ms/step
Epoch 91/1000
126/126 - 28s - loss: 4.9189 - NDCG@10: 0.2805 - r1: 0.1397 - r5: 0.3419 - r10: 0.4563 - p5: 0.0684 - p10: 0.0456 - val_loss: 4.4477 - val_NDCG@10: 0.3206 - val_r1: 0.1906 - val_r5: 0.3748 - val_r10: 0.4808 - val_p5: 0.0750 - val_p10: 0.0481 - lr: 9.0991e-05 - 28s/epoch - 221ms/step
Epoch 92/1000
126/126 - 28s - loss: 4.9057 - NDCG@10: 0.2820 - r1: 0.1431 - r5: 0.3403 - r10: 0.4569 - p5: 0.0681 - p10: 0.0457 - val_loss: 4.3780 - val_NDCG@10: 0.3205 - val_r1: 0.1883 - val_r5: 0.3726 - val_r10: 0.4856 - val_p5: 0.0745 - val_p10: 0.0486 - lr: 9.0892e-05 - 28s/epoch - 221ms/step
Epoch 93/1000
126/126 - 28s - loss: 4.8615 - NDCG@10: 0.2841 - r1: 0.1458 - r5: 0.3405 - r10: 0.4583 - p5: 0.0681 - p10: 0.0458 - val_loss: 4.3979 - val_NDCG@10: 0.3179 - val_r1: 0.1853 - val_r5: 0.3753 - val_r10: 0.4808 - val_p5: 0.0751 - val_p10: 0.0481 - lr: 9.0793e-05 - 28s/epoch - 221ms/step
Epoch 94/1000
126/126 - 28s - loss: 4.8276 - NDCG@10: 0.2850 - r1: 0.1472 - r5: 0.3388 - r10: 0.4590 - p5: 0.0678 - p10: 0.0459 - val_loss: 4.4236 - val_NDCG@10: 0.3142 - val_r1: 0.1858 - val_r5: 0.3644 - val_r10: 0.4757 - val_p5: 0.0729 - val_p10: 0.0476 - lr: 9.0694e-05 - 28s/epoch - 220ms/step
Epoch 95/1000
126/126 - 28s - loss: 4.8037 - NDCG@10: 0.2855 - r1: 0.1469 - r5: 0.3423 - r10: 0.4604 - p5: 0.0684 - p10: 0.0460 - val_loss: 4.4084 - val_NDCG@10: 0.3162 - val_r1: 0.1870 - val_r5: 0.3695 - val_r10: 0.4767 - val_p5: 0.0739 - val_p10: 0.0477 - lr: 9.0595e-05 - 28s/epoch - 221ms/step
Epoch 96/1000
126/126 - 28s - loss: 4.7968 - NDCG@10: 0.2847 - r1: 0.1441 - r5: 0.3431 - r10: 0.4595 - p5: 0.0686 - p10: 0.0460 - val_loss: 4.3715 - val_NDCG@10: 0.3194 - val_r1: 0.1934 - val_r5: 0.3705 - val_r10: 0.4790 - val_p5: 0.0741 - val_p10: 0.0479 - lr: 9.0496e-05 - 28s/epoch - 221ms/step
Epoch 97/1000
126/126 - 28s - loss: 4.7892 - NDCG@10: 0.2847 - r1: 0.1478 - r5: 0.3417 - r10: 0.4567 - p5: 0.0683 - p10: 0.0457 - val_loss: 4.3774 - val_NDCG@10: 0.3213 - val_r1: 0.1893 - val_r5: 0.3787 - val_r10: 0.4834 - val_p5: 0.0757 - val_p10: 0.0483 - lr: 9.0397e-05 - 28s/epoch - 222ms/step
Epoch 98/1000
126/126 - 28s - loss: 4.7473 - NDCG@10: 0.2872 - r1: 0.1487 - r5: 0.3433 - r10: 0.4622 - p5: 0.0687 - p10: 0.0462 - val_loss: 4.3460 - val_NDCG@10: 0.3195 - val_r1: 0.1901 - val_r5: 0.3728 - val_r10: 0.4821 - val_p5: 0.0746 - val_p10: 0.0482 - lr: 9.0298e-05 - 28s/epoch - 221ms/step
Epoch 99/1000
126/126 - 28s - loss: 4.7114 - NDCG@10: 0.2878 - r1: 0.1488 - r5: 0.3463 - r10: 0.4617 - p5: 0.0693 - p10: 0.0462 - val_loss: 4.3111 - val_NDCG@10: 0.3199 - val_r1: 0.1906 - val_r5: 0.3769 - val_r10: 0.4798 - val_p5: 0.0754 - val_p10: 0.0480 - lr: 9.0199e-05 - 28s/epoch - 221ms/step
Epoch 100/1000
126/126 - 28s - loss: 4.6681 - NDCG@10: 0.2886 - r1: 0.1479 - r5: 0.3457 - r10: 0.4665 - p5: 0.0691 - p10: 0.0467 - val_loss: 4.3223 - val_NDCG@10: 0.3171 - val_r1: 0.1860 - val_r5: 0.3726 - val_r10: 0.4818 - val_p5: 0.0745 - val_p10: 0.0482 - lr: 9.0100e-05 - 28s/epoch - 221ms/step
Epoch 101/1000
126/126 - 28s - loss: 4.6761 - NDCG@10: 0.2887 - r1: 0.1486 - r5: 0.3463 - r10: 0.4663 - p5: 0.0693 - p10: 0.0466 - val_loss: 4.3279 - val_NDCG@10: 0.3227 - val_r1: 0.1888 - val_r5: 0.3784 - val_r10: 0.4907 - val_p5: 0.0757 - val_p10: 0.0491 - lr: 9.0001e-05 - 28s/epoch - 221ms/step
Epoch 102/1000
126/126 - 28s - loss: 4.6556 - NDCG@10: 0.2898 - r1: 0.1497 - r5: 0.3467 - r10: 0.4649 - p5: 0.0693 - p10: 0.0465 - val_loss: 4.3169 - val_NDCG@10: 0.3161 - val_r1: 0.1875 - val_r5: 0.3731 - val_r10: 0.4765 - val_p5: 0.0746 - val_p10: 0.0477 - lr: 8.9902e-05 - 28s/epoch - 221ms/step
Epoch 103/1000
126/126 - 28s - loss: 4.6394 - NDCG@10: 0.2904 - r1: 0.1505 - r5: 0.3488 - r10: 0.4652 - p5: 0.0697 - p10: 0.0465 - val_loss: 4.3000 - val_NDCG@10: 0.3227 - val_r1: 0.1939 - val_r5: 0.3759 - val_r10: 0.4836 - val_p5: 0.0752 - val_p10: 0.0484 - lr: 8.9803e-05 - 28s/epoch - 221ms/step
Epoch 104/1000
126/126 - 28s - loss: 4.6057 - NDCG@10: 0.2937 - r1: 0.1528 - r5: 0.3541 - r10: 0.4701 - p5: 0.0708 - p10: 0.0470 - val_loss: 4.2607 - val_NDCG@10: 0.3243 - val_r1: 0.1893 - val_r5: 0.3827 - val_r10: 0.4917 - val_p5: 0.0765 - val_p10: 0.0492 - lr: 8.9704e-05 - 28s/epoch - 220ms/step
Epoch 105/1000
126/126 - 28s - loss: 4.5758 - NDCG@10: 0.2955 - r1: 0.1534 - r5: 0.3571 - r10: 0.4728 - p5: 0.0714 - p10: 0.0473 - val_loss: 4.3082 - val_NDCG@10: 0.3214 - val_r1: 0.1934 - val_r5: 0.3812 - val_r10: 0.4811 - val_p5: 0.0762 - val_p10: 0.0481 - lr: 8.9605e-05 - 28s/epoch - 221ms/step
Epoch 106/1000
126/126 - 28s - loss: 4.5836 - NDCG@10: 0.2931 - r1: 0.1516 - r5: 0.3537 - r10: 0.4700 - p5: 0.0707 - p10: 0.0470 - val_loss: 4.2943 - val_NDCG@10: 0.3194 - val_r1: 0.1914 - val_r5: 0.3731 - val_r10: 0.4788 - val_p5: 0.0746 - val_p10: 0.0479 - lr: 8.9506e-05 - 28s/epoch - 221ms/step
Epoch 107/1000
126/126 - 28s - loss: 4.5626 - NDCG@10: 0.2927 - r1: 0.1524 - r5: 0.3496 - r10: 0.4702 - p5: 0.0699 - p10: 0.0470 - val_loss: 4.2841 - val_NDCG@10: 0.3195 - val_r1: 0.1868 - val_r5: 0.3741 - val_r10: 0.4818 - val_p5: 0.0748 - val_p10: 0.0482 - lr: 8.9407e-05 - 28s/epoch - 221ms/step
Epoch 108/1000
126/126 - 28s - loss: 4.5473 - NDCG@10: 0.2964 - r1: 0.1556 - r5: 0.3551 - r10: 0.4728 - p5: 0.0710 - p10: 0.0473 - val_loss: 4.2646 - val_NDCG@10: 0.3198 - val_r1: 0.1896 - val_r5: 0.3769 - val_r10: 0.4808 - val_p5: 0.0754 - val_p10: 0.0481 - lr: 8.9308e-05 - 28s/epoch - 221ms/step
Epoch 109/1000
126/126 - 28s - loss: 4.5023 - NDCG@10: 0.2975 - r1: 0.1547 - r5: 0.3593 - r10: 0.4748 - p5: 0.0719 - p10: 0.0475 - val_loss: 4.2654 - val_NDCG@10: 0.3208 - val_r1: 0.1891 - val_r5: 0.3746 - val_r10: 0.4849 - val_p5: 0.0749 - val_p10: 0.0485 - lr: 8.9209e-05 - 28s/epoch - 221ms/step
Epoch 110/1000
126/126 - 28s - loss: 4.5050 - NDCG@10: 0.2966 - r1: 0.1548 - r5: 0.3553 - r10: 0.4752 - p5: 0.0711 - p10: 0.0475 - val_loss: 4.2509 - val_NDCG@10: 0.3199 - val_r1: 0.1911 - val_r5: 0.3741 - val_r10: 0.4831 - val_p5: 0.0748 - val_p10: 0.0483 - lr: 8.9110e-05 - 28s/epoch - 221ms/step
Epoch 111/1000
126/126 - 28s - loss: 4.4648 - NDCG@10: 0.2989 - r1: 0.1588 - r5: 0.3578 - r10: 0.4745 - p5: 0.0716 - p10: 0.0474 - val_loss: 4.2329 - val_NDCG@10: 0.3211 - val_r1: 0.1891 - val_r5: 0.3764 - val_r10: 0.4854 - val_p5: 0.0753 - val_p10: 0.0485 - lr: 8.9011e-05 - 28s/epoch - 221ms/step
Epoch 112/1000
126/126 - 28s - loss: 4.4721 - NDCG@10: 0.2972 - r1: 0.1536 - r5: 0.3596 - r10: 0.4749 - p5: 0.0719 - p10: 0.0475 - val_loss: 4.2238 - val_NDCG@10: 0.3192 - val_r1: 0.1870 - val_r5: 0.3743 - val_r10: 0.4803 - val_p5: 0.0749 - val_p10: 0.0480 - lr: 8.8912e-05 - 28s/epoch - 221ms/step
Epoch 113/1000
126/126 - 28s - loss: 4.4631 - NDCG@10: 0.2978 - r1: 0.1565 - r5: 0.3579 - r10: 0.4750 - p5: 0.0716 - p10: 0.0475 - val_loss: 4.2646 - val_NDCG@10: 0.3214 - val_r1: 0.1896 - val_r5: 0.3751 - val_r10: 0.4844 - val_p5: 0.0750 - val_p10: 0.0484 - lr: 8.8813e-05 - 28s/epoch - 221ms/step
Epoch 114/1000
126/126 - 28s - loss: 4.4216 - NDCG@10: 0.3017 - r1: 0.1589 - r5: 0.3626 - r10: 0.4804 - p5: 0.0725 - p10: 0.0480 - val_loss: 4.2257 - val_NDCG@10: 0.3164 - val_r1: 0.1822 - val_r5: 0.3731 - val_r10: 0.4834 - val_p5: 0.0746 - val_p10: 0.0483 - lr: 8.8714e-05 - 28s/epoch - 221ms/step
Epoch 115/1000
126/126 - 28s - loss: 4.4196 - NDCG@10: 0.3014 - r1: 0.1577 - r5: 0.3615 - r10: 0.4809 - p5: 0.0723 - p10: 0.0481 - val_loss: 4.2668 - val_NDCG@10: 0.3159 - val_r1: 0.1840 - val_r5: 0.3708 - val_r10: 0.4813 - val_p5: 0.0741 - val_p10: 0.0481 - lr: 8.8615e-05 - 28s/epoch - 221ms/step
Epoch 116/1000
126/126 - 28s - loss: 4.4186 - NDCG@10: 0.3000 - r1: 0.1572 - r5: 0.3591 - r10: 0.4780 - p5: 0.0718 - p10: 0.0478 - val_loss: 4.2463 - val_NDCG@10: 0.3172 - val_r1: 0.1840 - val_r5: 0.3682 - val_r10: 0.4836 - val_p5: 0.0736 - val_p10: 0.0484 - lr: 8.8516e-05 - 28s/epoch - 221ms/step
Epoch 117/1000
126/126 - 28s - loss: 4.3989 - NDCG@10: 0.3024 - r1: 0.1595 - r5: 0.3618 - r10: 0.4813 - p5: 0.0724 - p10: 0.0481 - val_loss: 4.2293 - val_NDCG@10: 0.3169 - val_r1: 0.1848 - val_r5: 0.3687 - val_r10: 0.4811 - val_p5: 0.0737 - val_p10: 0.0481 - lr: 8.8417e-05 - 28s/epoch - 221ms/step
Epoch 118/1000
126/126 - 28s - loss: 4.3852 - NDCG@10: 0.3014 - r1: 0.1575 - r5: 0.3616 - r10: 0.4818 - p5: 0.0723 - p10: 0.0482 - val_loss: 4.2113 - val_NDCG@10: 0.3195 - val_r1: 0.1903 - val_r5: 0.3713 - val_r10: 0.4808 - val_p5: 0.0743 - val_p10: 0.0481 - lr: 8.8318e-05 - 28s/epoch - 221ms/step
Epoch 119/1000
126/126 - 28s - loss: 4.3740 - NDCG@10: 0.3022 - r1: 0.1576 - r5: 0.3616 - r10: 0.4838 - p5: 0.0723 - p10: 0.0484 - val_loss: 4.2249 - val_NDCG@10: 0.3198 - val_r1: 0.1898 - val_r5: 0.3784 - val_r10: 0.4808 - val_p5: 0.0757 - val_p10: 0.0481 - lr: 8.8219e-05 - 28s/epoch - 221ms/step
Epoch 120/1000
126/126 - 28s - loss: 4.3498 - NDCG@10: 0.3030 - r1: 0.1595 - r5: 0.3636 - r10: 0.4820 - p5: 0.0727 - p10: 0.0482 - val_loss: 4.1918 - val_NDCG@10: 0.3140 - val_r1: 0.1812 - val_r5: 0.3771 - val_r10: 0.4780 - val_p5: 0.0754 - val_p10: 0.0478 - lr: 8.8120e-05 - 28s/epoch - 221ms/step
Epoch 121/1000
126/126 - 28s - loss: 4.3305 - NDCG@10: 0.3058 - r1: 0.1626 - r5: 0.3647 - r10: 0.4845 - p5: 0.0729 - p10: 0.0485 - val_loss: 4.2020 - val_NDCG@10: 0.3163 - val_r1: 0.1845 - val_r5: 0.3700 - val_r10: 0.4826 - val_p5: 0.0740 - val_p10: 0.0483 - lr: 8.8021e-05 - 28s/epoch - 221ms/step
Epoch 122/1000
126/126 - 28s - loss: 4.3507 - NDCG@10: 0.3035 - r1: 0.1599 - r5: 0.3641 - r10: 0.4832 - p5: 0.0728 - p10: 0.0483 - val_loss: 4.2322 - val_NDCG@10: 0.3170 - val_r1: 0.1853 - val_r5: 0.3713 - val_r10: 0.4816 - val_p5: 0.0743 - val_p10: 0.0482 - lr: 8.7922e-05 - 28s/epoch - 220ms/step
Epoch 123/1000
126/126 - 28s - loss: 4.3244 - NDCG@10: 0.3057 - r1: 0.1618 - r5: 0.3657 - r10: 0.4855 - p5: 0.0731 - p10: 0.0486 - val_loss: 4.2020 - val_NDCG@10: 0.3165 - val_r1: 0.1845 - val_r5: 0.3751 - val_r10: 0.4780 - val_p5: 0.0750 - val_p10: 0.0478 - lr: 8.7823e-05 - 28s/epoch - 221ms/step
Epoch 124/1000
126/126 - 28s - loss: 4.3183 - NDCG@10: 0.3058 - r1: 0.1615 - r5: 0.3659 - r10: 0.4847 - p5: 0.0732 - p10: 0.0485 - val_loss: 4.2094 - val_NDCG@10: 0.3156 - val_r1: 0.1855 - val_r5: 0.3685 - val_r10: 0.4765 - val_p5: 0.0737 - val_p10: 0.0476 - lr: 8.7724e-05 - 28s/epoch - 221ms/step
Epoch 125/1000
126/126 - 28s - loss: 4.3044 - NDCG@10: 0.3069 - r1: 0.1624 - r5: 0.3700 - r10: 0.4856 - p5: 0.0740 - p10: 0.0486 - val_loss: 4.1980 - val_NDCG@10: 0.3177 - val_r1: 0.1878 - val_r5: 0.3779 - val_r10: 0.4801 - val_p5: 0.0756 - val_p10: 0.0480 - lr: 8.7625e-05 - 28s/epoch - 221ms/step
Epoch 126/1000
126/126 - 28s - loss: 4.2868 - NDCG@10: 0.3072 - r1: 0.1621 - r5: 0.3671 - r10: 0.4874 - p5: 0.0734 - p10: 0.0487 - val_loss: 4.2152 - val_NDCG@10: 0.3139 - val_r1: 0.1835 - val_r5: 0.3675 - val_r10: 0.4770 - val_p5: 0.0735 - val_p10: 0.0477 - lr: 8.7526e-05 - 28s/epoch - 221ms/step
Epoch 127/1000
126/126 - 28s - loss: 4.2654 - NDCG@10: 0.3099 - r1: 0.1647 - r5: 0.3744 - r10: 0.4887 - p5: 0.0749 - p10: 0.0489 - val_loss: 4.2164 - val_NDCG@10: 0.3185 - val_r1: 0.1891 - val_r5: 0.3733 - val_r10: 0.4826 - val_p5: 0.0747 - val_p10: 0.0483 - lr: 8.7427e-05 - 28s/epoch - 221ms/step
Epoch 128/1000
126/126 - 28s - loss: 4.2780 - NDCG@10: 0.3085 - r1: 0.1642 - r5: 0.3689 - r10: 0.4884 - p5: 0.0738 - p10: 0.0488 - val_loss: 4.1648 - val_NDCG@10: 0.3215 - val_r1: 0.1903 - val_r5: 0.3771 - val_r10: 0.4849 - val_p5: 0.0755 - val_p10: 0.0485 - lr: 8.7328e-05 - 28s/epoch - 221ms/step
Epoch 129/1000
126/126 - 28s - loss: 4.2664 - NDCG@10: 0.3079 - r1: 0.1630 - r5: 0.3686 - r10: 0.4880 - p5: 0.0737 - p10: 0.0488 - val_loss: 4.1785 - val_NDCG@10: 0.3211 - val_r1: 0.1878 - val_r5: 0.3743 - val_r10: 0.4884 - val_p5: 0.0749 - val_p10: 0.0488 - lr: 8.7229e-05 - 28s/epoch - 221ms/step
Epoch 130/1000
126/126 - 28s - loss: 4.2354 - NDCG@10: 0.3094 - r1: 0.1653 - r5: 0.3691 - r10: 0.4903 - p5: 0.0738 - p10: 0.0490 - val_loss: 4.1654 - val_NDCG@10: 0.3208 - val_r1: 0.1881 - val_r5: 0.3776 - val_r10: 0.4846 - val_p5: 0.0755 - val_p10: 0.0485 - lr: 8.7130e-05 - 28s/epoch - 221ms/step
Epoch 131/1000
126/126 - 28s - loss: 4.2430 - NDCG@10: 0.3080 - r1: 0.1628 - r5: 0.3693 - r10: 0.4893 - p5: 0.0739 - p10: 0.0489 - val_loss: 4.1791 - val_NDCG@10: 0.3178 - val_r1: 0.1835 - val_r5: 0.3738 - val_r10: 0.4859 - val_p5: 0.0748 - val_p10: 0.0486 - lr: 8.7031e-05 - 28s/epoch - 221ms/step
Epoch 132/1000
126/126 - 28s - loss: 4.2254 - NDCG@10: 0.3103 - r1: 0.1664 - r5: 0.3693 - r10: 0.4902 - p5: 0.0739 - p10: 0.0490 - val_loss: 4.1354 - val_NDCG@10: 0.3161 - val_r1: 0.1827 - val_r5: 0.3726 - val_r10: 0.4806 - val_p5: 0.0745 - val_p10: 0.0481 - lr: 8.6932e-05 - 28s/epoch - 221ms/step
Epoch 133/1000
126/126 - 28s - loss: 4.2249 - NDCG@10: 0.3098 - r1: 0.1652 - r5: 0.3732 - r10: 0.4889 - p5: 0.0746 - p10: 0.0489 - val_loss: 4.1560 - val_NDCG@10: 0.3175 - val_r1: 0.1891 - val_r5: 0.3682 - val_r10: 0.4790 - val_p5: 0.0736 - val_p10: 0.0479 - lr: 8.6833e-05 - 28s/epoch - 221ms/step
Epoch 134/1000
126/126 - 28s - loss: 4.2302 - NDCG@10: 0.3077 - r1: 0.1624 - r5: 0.3681 - r10: 0.4898 - p5: 0.0736 - p10: 0.0490 - val_loss: 4.1882 - val_NDCG@10: 0.3175 - val_r1: 0.1893 - val_r5: 0.3710 - val_r10: 0.4788 - val_p5: 0.0742 - val_p10: 0.0479 - lr: 8.6734e-05 - 28s/epoch - 221ms/step
Epoch 135/1000
126/126 - 28s - loss: 4.1940 - NDCG@10: 0.3114 - r1: 0.1641 - r5: 0.3734 - r10: 0.4951 - p5: 0.0747 - p10: 0.0495 - val_loss: 4.1656 - val_NDCG@10: 0.3175 - val_r1: 0.1878 - val_r5: 0.3751 - val_r10: 0.4795 - val_p5: 0.0750 - val_p10: 0.0480 - lr: 8.6635e-05 - 28s/epoch - 221ms/step
Epoch 136/1000
126/126 - 28s - loss: 4.1993 - NDCG@10: 0.3135 - r1: 0.1676 - r5: 0.3754 - r10: 0.4950 - p5: 0.0751 - p10: 0.0495 - val_loss: 4.1568 - val_NDCG@10: 0.3170 - val_r1: 0.1842 - val_r5: 0.3746 - val_r10: 0.4816 - val_p5: 0.0749 - val_p10: 0.0482 - lr: 8.6536e-05 - 28s/epoch - 221ms/step
Epoch 137/1000
126/126 - 28s - loss: 4.1955 - NDCG@10: 0.3110 - r1: 0.1667 - r5: 0.3725 - r10: 0.4925 - p5: 0.0745 - p10: 0.0493 - val_loss: 4.1342 - val_NDCG@10: 0.3237 - val_r1: 0.1929 - val_r5: 0.3771 - val_r10: 0.4872 - val_p5: 0.0754 - val_p10: 0.0487 - lr: 8.6437e-05 - 28s/epoch - 221ms/step
Epoch 138/1000
126/126 - 28s - loss: 4.2068 - NDCG@10: 0.3120 - r1: 0.1664 - r5: 0.3749 - r10: 0.4940 - p5: 0.0750 - p10: 0.0494 - val_loss: 4.1903 - val_NDCG@10: 0.3144 - val_r1: 0.1832 - val_r5: 0.3705 - val_r10: 0.4780 - val_p5: 0.0741 - val_p10: 0.0478 - lr: 8.6338e-05 - 28s/epoch - 221ms/step
Epoch 139/1000
126/126 - 28s - loss: 4.1884 - NDCG@10: 0.3129 - r1: 0.1672 - r5: 0.3737 - r10: 0.4948 - p5: 0.0747 - p10: 0.0495 - val_loss: 4.1479 - val_NDCG@10: 0.3194 - val_r1: 0.1881 - val_r5: 0.3771 - val_r10: 0.4818 - val_p5: 0.0754 - val_p10: 0.0482 - lr: 8.6239e-05 - 28s/epoch - 221ms/step
Epoch 140/1000
126/126 - 28s - loss: 4.1750 - NDCG@10: 0.3127 - r1: 0.1659 - r5: 0.3768 - r10: 0.4943 - p5: 0.0754 - p10: 0.0494 - val_loss: 4.1585 - val_NDCG@10: 0.3163 - val_r1: 0.1863 - val_r5: 0.3766 - val_r10: 0.4757 - val_p5: 0.0753 - val_p10: 0.0476 - lr: 8.6140e-05 - 28s/epoch - 221ms/step
Epoch 141/1000
126/126 - 28s - loss: 4.1757 - NDCG@10: 0.3131 - r1: 0.1668 - r5: 0.3773 - r10: 0.4932 - p5: 0.0755 - p10: 0.0493 - val_loss: 4.1581 - val_NDCG@10: 0.3115 - val_r1: 0.1827 - val_r5: 0.3703 - val_r10: 0.4704 - val_p5: 0.0741 - val_p10: 0.0470 - lr: 8.6041e-05 - 28s/epoch - 222ms/step
Epoch 142/1000
126/126 - 28s - loss: 4.1571 - NDCG@10: 0.3151 - r1: 0.1684 - r5: 0.3776 - r10: 0.4971 - p5: 0.0755 - p10: 0.0497 - val_loss: 4.1465 - val_NDCG@10: 0.3168 - val_r1: 0.1837 - val_r5: 0.3736 - val_r10: 0.4798 - val_p5: 0.0747 - val_p10: 0.0480 - lr: 8.5942e-05 - 28s/epoch - 221ms/step
Epoch 143/1000
126/126 - 28s - loss: 4.1500 - NDCG@10: 0.3157 - r1: 0.1696 - r5: 0.3782 - r10: 0.4974 - p5: 0.0756 - p10: 0.0497 - val_loss: 4.1311 - val_NDCG@10: 0.3175 - val_r1: 0.1858 - val_r5: 0.3741 - val_r10: 0.4808 - val_p5: 0.0748 - val_p10: 0.0481 - lr: 8.5843e-05 - 28s/epoch - 221ms/step
Epoch 144/1000
126/126 - 28s - loss: 4.1389 - NDCG@10: 0.3147 - r1: 0.1679 - r5: 0.3775 - r10: 0.4961 - p5: 0.0755 - p10: 0.0496 - val_loss: 4.1361 - val_NDCG@10: 0.3197 - val_r1: 0.1870 - val_r5: 0.3807 - val_r10: 0.4846 - val_p5: 0.0761 - val_p10: 0.0485 - lr: 8.5744e-05 - 28s/epoch - 220ms/step
Epoch 145/1000
126/126 - 28s - loss: 4.1554 - NDCG@10: 0.3142 - r1: 0.1686 - r5: 0.3749 - r10: 0.4952 - p5: 0.0750 - p10: 0.0495 - val_loss: 4.0628 - val_NDCG@10: 0.3301 - val_r1: 0.1962 - val_r5: 0.3860 - val_r10: 0.4966 - val_p5: 0.0772 - val_p10: 0.0497 - lr: 8.5645e-05 - 28s/epoch - 221ms/step
Epoch 146/1000
126/126 - 28s - loss: 4.1071 - NDCG@10: 0.3192 - r1: 0.1712 - r5: 0.3812 - r10: 0.5034 - p5: 0.0762 - p10: 0.0503 - val_loss: 4.1341 - val_NDCG@10: 0.3185 - val_r1: 0.1853 - val_r5: 0.3731 - val_r10: 0.4856 - val_p5: 0.0747 - val_p10: 0.0486 - lr: 8.5546e-05 - 28s/epoch - 221ms/step
Epoch 147/1000
126/126 - 28s - loss: 4.1119 - NDCG@10: 0.3175 - r1: 0.1712 - r5: 0.3796 - r10: 0.5008 - p5: 0.0759 - p10: 0.0501 - val_loss: 4.1244 - val_NDCG@10: 0.3165 - val_r1: 0.1870 - val_r5: 0.3733 - val_r10: 0.4801 - val_p5: 0.0747 - val_p10: 0.0480 - lr: 8.5447e-05 - 28s/epoch - 220ms/step
Epoch 148/1000
126/126 - 28s - loss: 4.1321 - NDCG@10: 0.3171 - r1: 0.1695 - r5: 0.3802 - r10: 0.5001 - p5: 0.0760 - p10: 0.0500 - val_loss: 4.1160 - val_NDCG@10: 0.3198 - val_r1: 0.1886 - val_r5: 0.3753 - val_r10: 0.4831 - val_p5: 0.0751 - val_p10: 0.0483 - lr: 8.5348e-05 - 28s/epoch - 220ms/step
Epoch 149/1000
126/126 - 28s - loss: 4.1101 - NDCG@10: 0.3180 - r1: 0.1712 - r5: 0.3796 - r10: 0.5005 - p5: 0.0759 - p10: 0.0501 - val_loss: 4.1467 - val_NDCG@10: 0.3153 - val_r1: 0.1822 - val_r5: 0.3743 - val_r10: 0.4773 - val_p5: 0.0749 - val_p10: 0.0478 - lr: 8.5249e-05 - 28s/epoch - 221ms/step
Epoch 150/1000
126/126 - 28s - loss: 4.1037 - NDCG@10: 0.3160 - r1: 0.1699 - r5: 0.3789 - r10: 0.4973 - p5: 0.0758 - p10: 0.0497 - val_loss: 4.1182 - val_NDCG@10: 0.3180 - val_r1: 0.1858 - val_r5: 0.3776 - val_r10: 0.4801 - val_p5: 0.0755 - val_p10: 0.0480 - lr: 8.5150e-05 - 28s/epoch - 220ms/step
Epoch 151/1000
126/126 - 28s - loss: 4.1111 - NDCG@10: 0.3158 - r1: 0.1677 - r5: 0.3803 - r10: 0.4995 - p5: 0.0761 - p10: 0.0500 - val_loss: 4.1222 - val_NDCG@10: 0.3158 - val_r1: 0.1827 - val_r5: 0.3728 - val_r10: 0.4828 - val_p5: 0.0746 - val_p10: 0.0483 - lr: 8.5051e-05 - 28s/epoch - 221ms/step
Epoch 152/1000
126/126 - 28s - loss: 4.0978 - NDCG@10: 0.3160 - r1: 0.1696 - r5: 0.3778 - r10: 0.4977 - p5: 0.0756 - p10: 0.0498 - val_loss: 4.1346 - val_NDCG@10: 0.3161 - val_r1: 0.1848 - val_r5: 0.3708 - val_r10: 0.4795 - val_p5: 0.0741 - val_p10: 0.0479 - lr: 8.4953e-05 - 28s/epoch - 220ms/step
Epoch 153/1000
126/126 - 28s - loss: 4.0893 - NDCG@10: 0.3199 - r1: 0.1726 - r5: 0.3822 - r10: 0.5033 - p5: 0.0764 - p10: 0.0503 - val_loss: 4.1226 - val_NDCG@10: 0.3143 - val_r1: 0.1807 - val_r5: 0.3687 - val_r10: 0.4798 - val_p5: 0.0737 - val_p10: 0.0480 - lr: 8.4854e-05 - 28s/epoch - 221ms/step
Epoch 154/1000
126/126 - 28s - loss: 4.1039 - NDCG@10: 0.3178 - r1: 0.1706 - r5: 0.3801 - r10: 0.5011 - p5: 0.0760 - p10: 0.0501 - val_loss: 4.1326 - val_NDCG@10: 0.3151 - val_r1: 0.1817 - val_r5: 0.3700 - val_r10: 0.4818 - val_p5: 0.0740 - val_p10: 0.0482 - lr: 8.4755e-05 - 28s/epoch - 222ms/step
Epoch 155/1000
126/126 - 28s - loss: 4.0965 - NDCG@10: 0.3175 - r1: 0.1711 - r5: 0.3793 - r10: 0.5010 - p5: 0.0759 - p10: 0.0501 - val_loss: 4.1293 - val_NDCG@10: 0.3172 - val_r1: 0.1886 - val_r5: 0.3753 - val_r10: 0.4767 - val_p5: 0.0751 - val_p10: 0.0477 - lr: 8.4656e-05 - 28s/epoch - 221ms/step
Epoch 155: early stopping
WARNING:tensorflow:Model was constructed with shape (None, 162) for input KerasTensor(type_spec=TensorSpec(shape=(None, 162), dtype=tf.int32, name='input_1'), name='input_1', description="created by layer 'input_1'"), but it was called on an input with incompatible shape (None,).
/media/nas/pperez/miniconda3/envs/TAVtext/lib/python3.8/site-packages/sklearn/manifold/_t_sne.py:991: FutureWarning: The PCA initialization in TSNE will change to have the standard deviation of PC1 equal to 1e-4 in 1.2. This will ensure better convergence.
  warnings.warn(
/media/nas/pperez/miniconda3/envs/TAVtext/lib/python3.8/site-packages/sklearn/manifold/_t_sne.py:991: FutureWarning: The PCA initialization in TSNE will change to have the standard deviation of PC1 equal to 1e-4 in 1.2. This will ensure better convergence.
  warnings.warn(
(149, 2)
[92m[QUERY] 'quiero comer un arroz con bogavante y con buenas vistas'[0m
[PREPR]         [querer comer uno arroz con bogavante y con buena vista]
[TXT2ID]        [159, 28, 5, 94, 10, 523, 3, 10, 154, 298]
[WORD FREQ]     [2151, 12773, 81609, 3663, 38885, 508, 115391, 38885, 2238, 1054]
WARNING:tensorflow:Model was constructed with shape (None, 162) for input KerasTensor(type_spec=TensorSpec(shape=(None, 162), dtype=tf.int32, name='input_1'), name='input_1', description="created by layer 'input_1'"), but it was called on an input with incompatible shape (None,).
[91m[ERROR] Reparar y unificar la parte de selección de palabras relevantes[0m
WARNING:tensorflow:Model was constructed with shape (None, 162) for input KerasTensor(type_spec=TensorSpec(shape=(None, 162), dtype=tf.int32, name='input_1'), name='input_1', description="created by layer 'input_1'"), but it was called on an input with incompatible shape (None,).
	[0.81] Pizzeria La Pergola               {'canelon': 0.3037, 'tien': 0.2883, 'colocar': 0.229, 'porcion': 0.224, 'ajillo': 0.2144, 'madre': 0.2114, 'ocurrir': 0.2051, 'decepcionir': 0.2028, 'tarto': 0.2028, 'escandalo': 0.1874}
	[0.76] D Aldo                            {'tremendo': 0.2969, 'mañana': 0.29, 'directamente': 0.2883, 'conjunto': 0.2856, 'verdadero': 0.285, 'corriente': 0.2812, 'marchar': 0.269, 'decente': 0.2512, 'color': 0.2192, 'curioso': 0.2107}
	[0.74] Padrino - Comida Sobre Masa       {'corte': 0.2708, 'respuesta': 0.2705, 'tremendo': 0.2695, 'directamente': 0.268, 'esmerado': 0.2646, 'mañana': 0.2612, 'verdadero': 0.2595, 'corriente': 0.2559, 'conjunto': 0.2554, 'marchar': 0.2456}
	[0.73] Restaurante Sidreria La Galana    {'mejorable': 0.1251, 'puerto': 0.1247, 'prisa': 0.12396, 'parte': 0.1238, 'alguien': 0.1237, 'finalizar': 0.1235, 'propio': 0.1234, 'menudo': 0.1232, 'pid': 0.12317, 'sabiar': 0.12317}
	[0.73] Restaurante Pizzería Las Candelas {'amante': 0.2795, 'tinto': 0.2778, 'cortado': 0.2742, 'l': 0.273, 'exquisita': 0.2676, 'exquisitir': 0.2664, 'gustariar': 0.2617, 'ribeiro': 0.26, 'curioso': 0.2576, 'humano': 0.255}
	[0.72] El Mirador de la Playa            {'marinero': 0.2493, 'acostumbrado': 0.2446, 'precisamente': 0.2115, 'magnifica': 0.2009, 'muro': 0.1996, 'repetimo': 0.1986, 'podiamos': 0.1959, 'grasa': 0.1954, 'iluminacion': 0.1938, 'referente': 0.1912}
[92m[QUERY] 'a el la yo en un con y'[0m
[PREPR]         [a el el yo en uno con y]
[TXT2ID]        [9, 1, 1, 11, 8, 5, 10, 3]
[WORD FREQ]     [46609, 258931, 258931, 38154, 51583, 81609, 38885, 115391]
WARNING:tensorflow:Model was constructed with shape (None, 162) for input KerasTensor(type_spec=TensorSpec(shape=(None, 162), dtype=tf.int32, name='input_1'), name='input_1', description="created by layer 'input_1'"), but it was called on an input with incompatible shape (None,).
[91m[ERROR] Reparar y unificar la parte de selección de palabras relevantes[0m
WARNING:tensorflow:Model was constructed with shape (None, 162) for input KerasTensor(type_spec=TensorSpec(shape=(None, 162), dtype=tf.int32, name='input_1'), name='input_1', description="created by layer 'input_1'"), but it was called on an input with incompatible shape (None,).
	[0.76] Pizzeria La Pergola               {'canelon': 0.3037, 'tien': 0.2883, 'colocar': 0.229, 'porcion': 0.224, 'ajillo': 0.2144, 'madre': 0.2114, 'ocurrir': 0.2051, 'decepcionir': 0.2028, 'tarto': 0.2028, 'escandalo': 0.1874}
	[0.71] D Aldo                            {'tremendo': 0.2969, 'mañana': 0.29, 'directamente': 0.2883, 'conjunto': 0.2856, 'verdadero': 0.285, 'corriente': 0.2812, 'marchar': 0.269, 'decente': 0.2512, 'color': 0.2192, 'curioso': 0.2107}
	[0.70] Padrino - Comida Sobre Masa       {'corte': 0.2708, 'respuesta': 0.2705, 'tremendo': 0.2695, 'directamente': 0.268, 'esmerado': 0.2646, 'mañana': 0.2612, 'verdadero': 0.2595, 'corriente': 0.2559, 'conjunto': 0.2554, 'marchar': 0.2456}
	[0.69] Restaurante Sidreria La Galana    {'mejorable': 0.1251, 'puerto': 0.1247, 'prisa': 0.12396, 'parte': 0.1238, 'alguien': 0.1237, 'finalizar': 0.1235, 'propio': 0.1234, 'menudo': 0.1232, 'pid': 0.12317, 'sabiar': 0.12317}
	[0.69] Restaurante Pizzería Las Candelas {'amante': 0.2795, 'tinto': 0.2778, 'cortado': 0.2742, 'l': 0.273, 'exquisita': 0.2676, 'exquisitir': 0.2664, 'gustariar': 0.2617, 'ribeiro': 0.26, 'curioso': 0.2576, 'humano': 0.255}
	[0.68] El Mirador de la Playa            {'marinero': 0.2493, 'acostumbrado': 0.2446, 'precisamente': 0.2115, 'magnifica': 0.2009, 'muro': 0.1996, 'repetimo': 0.1986, 'podiamos': 0.1959, 'grasa': 0.1954, 'iluminacion': 0.1938, 'referente': 0.1912}
